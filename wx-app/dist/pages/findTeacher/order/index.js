!function(t){function e(s){if(a[s])return a[s].exports;var n=a[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var a={};e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){t.exports=a(8)},,,,,function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=null;s="https://m.genshuixue.com";var n={CAPTCHA_LENGTH:4,SERVER_HOST:s,TYPE:"signin",PATHS:{PV0:"https://pb0.genshuixue.com/pv0.gif",SMS_CODE:"/sms/send",ADD_RECORD:"/recommend/add_record",CAPTCHA:"/captcha",CAPTCHA_START:"/captcha/start",CAPTCHA_VALIDATE:"/captcha/validate",GET_PUBLISH_LIST:"/hall-student/list?type=",GET_SUBJECT_LIST:"/cms-liudan/get-subject-list",GET_ORDER_INDEX:"/cms-liudan/index",ORDER_SUBMIT:"/cms-liudan/submit",CHECK_MOBILE:"/auth/check_mobile_ajax",HABO:"https://click.genshuixue.com/gs.gif"}};e.default=n},,,function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}var n=a(5),i=s(n),o=a(9),d=s(o),c=i.default.PATHS,u=getApp();Page({data:{saveDataParams:{user_name:"",course_name:"",mobile:"",from:"xiaochengxu"},sendSMSParams:{type:i.default.TYPE,captcha:"",is_voice:0,captcha_name:i.default.TYPE,captcha_uniq_id:""},type:"k12",subject1Index:-1,subject2Index:-1,subject1List:[],subject2List:[],tpl_info:{},share_info:{},toView:"",sendSMSCodeTip:"获取验证码",isHiddenBottom:!0,isShowSMSCode:!1,isShowVideo:!1,autoplay:!1},onLoad:function(t){var e=this;e.setData({type:t.type||"k12"}),wx.request({url:i.default.SERVER_HOST+c.GET_ORDER_INDEX,method:"GET",data:{type:e.data.type},success:function(t){var a=t.data.data,s=a.tpl_info;e.setData({tpl_info:s}),e.setData({share_info:a.share_info});for(var n,i=0;n=s[i++];)if("form"===n.type){e.setData({subject1List:n.subjects});break}wx.setNavigationBarTitle({title:a.title})},fail:function(t){wx.showModal({title:"提示",content:t})}}),wx.setNavigationBarTitle({title:"找好老师，上跟谁学"}),u.getUserInfo(function(t){e.setData({"saveDataParams.user_name":t.nickName}),wx.request({url:c.PV0,method:"GET",data:{page_str:"/xiaochengxu/liudan@nickName="+t.nickName+"@province="+t.province+"@city="+t.city}}),console.log(t)}),wx.getSystemInfo({success:function(t){e.setData({pixelRatio:t.pixelRatio}),e.setData({screenHeight:2*t.screenHeight,contentHeight:2*t.screenHeight+100,isIOS:t.system.toUpperCase().indexOf("IOS")>-1})}})},onShareAppMessage:function(){return{title:this.data.share_info.title,path:"/pages/findTeacher/order/index?type=k12"}},onPlay:function(){this.setData({isShowVideo:!0,autoplay:!0})},bindSMSCodeTap:function(t){this.sendSMSCode(t)},sendSMSCodeValidator:function(){var t=this;if(!t.data.isGetSMSCode){var e=+t.data.saveDataParams.mobile;return e?!!/\d{11}/.test(e)||void wx.showModal({title:"提示",content:"请输入11位数字的手机号",showCancel:!1}):void wx.showModal({title:"提示",content:"手机号不能为空",showCancel:!1})}},bindCaptchaKeyInput:function(t){var e=this,a=d.default.toSBC(t.detail.value);if(4===a.length&&!/^[a-zA-Z0-9]{4}$/.test(a))return void wx.showModal({title:"提示",content:"只能输入字母和字符，当前输入为:"+a,showCancel:!1});this.setData({"sendSMSParams.captcha":a,"sendSMSParams.captcha_name":this.data.sendSMSParams.type}),a.length===i.default.CAPTCHA_LENGTH&&e.sendSMSCode()},showPicCaptcha:function(){this.setData({isPicCaptchaValidate:!1,isShowPicCaptcha:!0,captchaUrl:""+i.default.SERVER_HOST+c.CAPTCHA+"?captcha_name="+i.default.TYPE+"&captcha_uniq_id="+this.data.sendSMSParams.captcha_uniq_id+"&"+(new Date).getTime()})},sendSMSCode:function(){var t=this;if(t.sendSMSCodeValidator()){var e=59;t.setData({isGetSMSCode:!0});var a=setInterval(function(){e<=0?(t.setData({isGetSMSCode:!1,sendSMSCodeTip:"重新发送"}),clearInterval(a)):t.setData({sendSMSCodeTip:"重新发送("+e--+"s)"})},1e3);t.setData({"sendSMSParams.mobile":this.data.saveDataParams.mobile}),wx.request({url:i.default.SERVER_HOST+c.SMS_CODE,data:this.data.sendSMSParams,method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:function(e){var s=e.data;0!==s.code&&(wx.showModal({title:"提示",content:s.msg,showCancel:!1}),t.setData({isGetSMSCode:!1,sendSMSCodeTip:"获取验证码"}),1000111===s.code&&t.getCaptchaUniqId(t.getNewCaptcha.bind(t,a)),110056===s.code&&t.getNewCaptcha(a))}})}},getNewCaptcha:function(t){this.showPicCaptcha(),clearInterval(t)},getCaptchaUniqId:function(t){var e=this;wx.request({url:i.default.SERVER_HOST+c.CAPTCHA_START,dataType:"json",header:{"content-type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:function(a){var s=a.data;0===s.code&&(e.setData({"sendSMSParams.captcha_uniq_id":s.data.captcha_uniq_id}),t())}})},bindSubject1Change:function(t){var e=this,a=(e.data,+t.detail.value);e.setData({subject1Index:a,subject2Index:-1,"saveDataParams.course_name":""}),wx.request({url:i.default.SERVER_HOST+c.GET_SUBJECT_LIST,method:"GET",data:{subject_id:e.data.subject1List[a].id},success:function(t){var a=t.data.data.subject_list;e.setData({subject2List:a})},fail:function(t){wx.showModal({title:"提示",content:t})}})},bindSubject2Change:function(t){var e=+t.detail.value,a=this.data;this.setData({subject2Index:e}),this.setData({"saveDataParams.course_name":a.subject1List[a.subject1Index].name+a.subject2List[a.subject2Index].name})},bindNameInput:function(t){this.setSaveDataParams("user_name",t)},bindSMSCodeInput:function(t){this.setData({"saveDataParams.sms_code":d.default.toSBC(t.detail.value)})},bindMobileInput:function(t){var e=d.default.toSBC(t.detail.value),a=this;a.setData({isShowSMSCode:!1,isShowPicCaptcha:!1,sendSMSCodeTip:"获取验证码"}),/\d{11}/.test(e)?wx.request({url:i.default.SERVER_HOST+c.CHECK_MOBILE,data:{mobile:e},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:function(t){var e=t.data;0===e.code?a.setData({isShowSMSCode:!e.data.exist}):wx.showModal({title:"提示",content:e.msg,showCancel:!1})}}):11===e.length&&wx.showModal({title:"提示",content:"手机号输入错误",showCancel:!1}),this.setData({"saveDataParams.mobile":e})},setSaveDataParams:function(t,e){var a={};a["saveDataParams."+t]=e.detail.value,this.setData(a)},validator:function(){var t=this,e=!0,a=+t.data.saveDataParams.mobile;return a&&/\d{11}/.test(a)||(wx.showModal({title:"提示",content:"请输入11位数字的手机号",showCancel:!1}),e=!1,t.setData({"saveDataParams.mobile":""})),e},bindWechatTap:function(){d.default.sendHabo({type:"x_clueC",stype:"message"})},bindGSXCallTap:function(){d.default.sendHabo({type:"x_clueC",stype:"phone"}),wx.makePhoneCall({phoneNumber:"4000910910"})},bindOrderTap:function(){this.setData({toView:"order-form"})},bindScroll:function(t){t.detail.scrollTop>654?this.setData({isHiddenBottom:!1,contentHeight:this.data.screenHeight}):this.setData({isHiddenBottom:!0,contentHeight:this.data.screenHeight+100})},bindSaveTap:function(){var t=this;t.validator()&&(t.setData({"saveDataParams.tpl_type":t.data.type}),wx.request({url:i.default.SERVER_HOST+c.ORDER_SUBMIT,data:t.data.saveDataParams,method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:function(t){var e=t.data;0===e.code?wx.showModal({title:"发布成功",content:"课程顾问老师近期会与您联系",showCancel:!1,confirmText:"知道了"}):wx.showModal({title:"提示",content:e.msg,showCancel:!1})}}))}})},function(t,e,a){"use strict";function s(t){return t=t.toString(),t[1]?t:"0"+t}Object.defineProperty(e,"__esModule",{value:!0});var n=a(5),i=function(t){return t&&t.__esModule?t:{default:t}}(n),o={formatTime:function(t){var e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate(),i=t.getHours(),o=t.getMinutes(),d=t.getSeconds();return[e,a,n].map(s).join("/")+" "+[i,o,d].map(s).join(":")},sendHabo:function(t){wx.request({url:i.default.PATHS.HABO,method:"GET",data:t,fail:function(t){wx.showModal({title:"提示",content:t})}})},toSBC:function(t){for(var e="",a=t.length,s=0;s<a;s++){var n=t.charCodeAt(s);n=n>=65281&&n<=65374?n-65248:n,e+=String.fromCharCode(n)}return e}};e.default=o}]);