!function(a){function t(s){if(e[s])return e[s].exports;var n=e[s]={exports:{},id:s,loaded:!1};return a[s].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var e={};t.m=a,t.c=e,t.p="",t(0)}([function(a,t,e){a.exports=e(4)},,,,function(a,t,e){"use strict";var s=e(5),n=function(a){return a&&a.__esModule?a:{default:a}}(s),i=n.default.PATHS,o=getApp();Page({data:{saveDataParams:{user_name:"",mobile:"",info:"",sms_code:"",exp_price:"",detail_info:"",support_online:1,page_type:"index-index",detail_url:"http://m.genshuixue.com/bj/",source:"xiaochengxu"},expPrice:["¥100以内","¥100-¥200","¥200-¥300","¥300-¥500","¥500以上","双方协商"],sendSMSParams:{type:n.default.TYPE,captcha:"",is_voice:0,captcha_name:n.default.TYPE,captcha_uniq_id:""},isValidate:!0,isPicCaptchaValidate:!0,priceIndex:-1,sendSMSCodeTip:"获取验证码",isGetSMSCode:!1,suggOpt:{className:""},subjectId:""},bindPageTap:function(){this.setData({"suggOpt.source":[]})},subjectHandler:function(a){var t=this,e=a.target.dataset;this.data.saveDataParams.info=e.title,setTimeout(function(){t.setData({"saveDataParams.info":e.title,subjectId:e.id,"suggOpt.source":[]})},100)},onShareAppMessage:function(){return{title:"发布找老师需求",path:"/pages/findTeacher/edit/index"}},onLoad:function(){var a=this;wx.setNavigationBarTitle({title:"发布找老师需求"}),o.getUserInfo(function(t){a.setData({"saveDataParams.user_name":t.nickName}),console.log(t)})},bindTapTextareaView:function(){this.setData({isShowTextarea:!0})},bindSubjectInput:function(a){var t=this,e=a.detail.value;t.setData({isShowTextarea:!1}),wx.request({url:"https://suggestion.genshuixue.com/s",method:"GET",data:{key:e,type:1},success:function(a){var e=a.data.result.r.map(function(a){return{id:a.sub_id,title:a.title}});t.setData({"suggOpt.source":e})},fail:function(a){wx.showModal({title:"提示",content:a})}})},bindDetailKeyInput:function(a){this.setSaveDataParams("detail_info",a)},bindNameKeyInput:function(a){this.setSaveDataParams("user_name",a)},bindPriceChange:function(a){var t=+a.detail.value;this.setData({priceIndex:t,"saveDataParams.exp_price":this.data.expPrice[t]})},bindOnlineChange:function(a){this.setSaveDataParams("support_online",a)},bindNameChange:function(a){this.setSaveDataParams("user_name",a)},bindPhoneKeyInput:function(a){this.setSaveDataParams("mobile",a)},bindSMSCodeKeyInput:function(a){this.setSaveDataParams("sms_code",a)},bindCaptchaKeyInput:function(a){var t=this,e=a.detail.value;this.setData({"sendSMSParams.captcha":e,"sendSMSParams.captcha_name":this.data.sendSMSParams.type}),e.length===n.default.CAPTCHA_LENGTH&&t.sendSMSCode()},showPicCaptcha:function(){this.setData({isPicCaptchaValidate:!1,isShowPicCaptcha:!0,captchaUrl:""+n.default.SERVER_HOST+i.CAPTCHA+"?captcha_name="+n.default.TYPE+"&captcha_uniq_id="+this.data.sendSMSParams.captcha_uniq_id+"&"+(new Date).getTime()})},sendSMSCodeValidator:function(){var a=this;if(!a.data.isGetSMSCode){var t=+a.data.saveDataParams.mobile;return t?/\d{5,}/.test(t)?!(a.isShowPicCaptcha&&!a.data.sendSMSParams.captcha)||void wx.showModal({title:"提示",content:"请输入图片验证码",showCancel:!1}):void wx.showModal({title:"提示",content:"请输入正确的手机号",showCancel:!1}):void wx.showModal({title:"提示",content:"手机号不能为空",showCancel:!1})}},sendSMSCode:function(){var a=this;if(a.sendSMSCodeValidator()){var t=59;a.setData({isGetSMSCode:!0});var e=setInterval(function(){t<=0?(a.setData({isGetSMSCode:!1,sendSMSCodeTip:"重新发送"}),clearInterval(e)):a.setData({sendSMSCodeTip:"重新发送("+t--+"s)"})},1e3);a.setData({"sendSMSParams.mobile":this.data.saveDataParams.mobile}),wx.request({url:n.default.SERVER_HOST+i.SMS_CODE,data:this.data.sendSMSParams,method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:function(t){var s=t.data;0!==s.code&&(wx.showModal({title:"提示",content:s.msg,showCancel:!1}),1000111===s.code&&a.getCaptchaUniqId(a.getNewCaptcha.bind(a,e)),110056===s.code&&a.getNewCaptcha(e))}})}},bindSMSCodeTap:function(a){this.sendSMSCode(a)},getNewCaptcha:function(a){var t=this;t.showPicCaptcha(),clearInterval(a),t.setData({isGetSMSCode:!1,sendSMSCodeTip:"获取验证码"})},getCaptchaUniqId:function(a){var t=this;wx.request({url:n.default.SERVER_HOST+i.CAPTCHA_START,dataType:"json",header:{"content-type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:function(e){var s=e.data;0===s.code&&(t.setData({"sendSMSParams.captcha_uniq_id":s.data.captcha_uniq_id}),a())}})},setSaveDataParams:function(a,t){var e={};e["saveDataParams."+a]=t.detail.value,this.setData(e)},validator:function(){var a=this,t=!0;return/\d{5,}/.test(+a.data.saveDataParams.mobile)||(wx.showModal({title:"提示",content:"请输入正确的手机号",showCancel:!1}),t=!1,a.setData({"saveDataParams.mobile":""})),t},bindSaveTap:function(){var a=this;a.validator()&&wx.request({url:n.default.SERVER_HOST+i.ADD_RECORD,data:a.data.saveDataParams,method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:function(a){var t=a.data;0===t.code?wx.navigateTo({url:"./result/index"}):wx.showModal({title:"提示",content:t.msg,showCancel:!1})}})},bindGSXCallTap:function(){wx.makePhoneCall({phoneNumber:"4000910910"})}})},function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=null;s="https://m.genshuixue.com";var n={CAPTCHA_LENGTH:4,SERVER_HOST:s,TYPE:"signin",PATHS:{PV0:"https://pb0.genshuixue.com/pv0.gif",SMS_CODE:"/sms/send",ADD_RECORD:"/recommend/add_record",CAPTCHA:"/captcha",CAPTCHA_START:"/captcha/start",CAPTCHA_VALIDATE:"/captcha/validate",GET_PUBLISH_LIST:"/hall-student/list?type=",GET_SUBJECT_LIST:"/cms-liudan/get-subject-list",GET_ORDER_INDEX:"/cms-liudan/index",ORDER_SUBMIT:"/cms-liudan/submit",CHECK_MOBILE:"/auth/check_mobile_ajax",HABO:"https://click.genshuixue.com/gs.gif"}};t.default=n}]);