define("cobble/function/jquerify",["require","exports","module"],function(){"use strict";function e(e){return e.faker||e.element}var t=$.prototype,i={on:function(){return t.on.apply(e(this),arguments),this},off:function(){return t.off.apply(e(this),arguments),this},emit:function(i,n){var a=this,o=e(a);if(o){if(!i[$.expando])i="string"===$.type(i)?$.Event(i):$.Event(null,i);i.cobble=a;var r=[i];if(n)r.push(n);var p=a[$.camelCase("on-"+i.type)];if($.isFunction(p)&&p.apply(a,r)===!1)i.preventDefault();if(!i.isPropagationStopped())t.trigger.apply(o,r);return i}},before:function(t){e(this).before(t)},after:function(t){e(this).after(t)},appendTo:function(t){e(this).appendTo(t)},prependTo:function(t){e(this).prependTo(t)}};return function(e){$.each(i,function(t,i){if(null==e[t])e[t]=i})}}),define("cobble/function/lifeCycle",["require","exports"],function(require,exports){"use strict";exports.init=function(e,t){var i=e.constructor,n="__cobble__"+i.prototype.type,a=t.element;if(a&&a.data(n))e=a.data(n);else if($.extend(e,i.defaultOptions,t),e.init(),a)a.data(n,e);return e},exports.dispose=function(e){var t="__cobble__"+e.constructor.prototype.type,i=e.element;if(i)i.removeData(t)}}),define("cobble/helper/AjaxUploader",["require","exports","module","../function/jquerify","../function/lifeCycle"],function(require){"use strict";function e(e){return s.init(this,e)}function t(e,t){var i=new FormData;$.each(e.data,function(e,t){i.append(e,t)}),i.append(e.fileName,t.nativeFile),t.xhr.send(i)}function i(t,i){var n=i.nativeFile,a=i.file.size,o=i.chunk;if(!o)o=i.chunk={index:0,uploaded:0};var r=o.index,p=t.chunkSize,l=p*r,s=p*(r+1);if(s>a)s=a;if(o.uploading=s-l,o.uploading<=0)return void setTimeout(function(){t.emit("uploadError",{fileItem:i,errorCode:e.ERROR_CHUNK_SIZE})});var u="bytes "+(l+1)+"-"+s+"/"+a,c=i.xhr;c.setRequestHeader("Content-Type",""),c.setRequestHeader("X_FILENAME",encodeURIComponent(n.name)),c.setRequestHeader("Content-Range",u),c.send(n.slice(l,s))}function n(t,i){var n=i.xhr;if(n)$.each(f,function(e,t){n["on"+t.type]=null}),$.each(d,function(e,t){n.upload["on"+t.type]=null}),delete i.xhr;if(t.emit("uploadComplete",{fileItem:i}),i.status===e.STATUS_UPLOAD_SUCCESS||i.status===e.STATUS_UPLOAD_ERROR&&t.ignoreError){var o=i.index+1;if(o<t.fileQueue.files.length)t.fileQueue.index=o,t.upload();else a(t,[])}}function a(t,i){var n=t.fileQueue;n.index=0,n.files=$.map(i,function(t,i){return{index:i,file:p(t),nativeFile:t,status:e.STATUS_WAITING}})}function o(e){var t=e.fileQueue,i=t.index;if(t.files&&"number"===$.type(i))return t.files[i];else return void 0}function r(e){var t=[];return $.each(e,function(e,i){if(c[i])t.push(c[i])}),$.unique(t).join(",")}function p(e){var t=e.name,i=t.split("."),n=i.length>0?i.pop().toLowerCase():"";return{name:t,type:n,size:e.size}}var l=require("../function/jquerify"),s=require("../function/lifeCycle");e.prototype={constructor:e,type:"AjaxUploader",init:function(){var e=this;e.fileQueue={};var t=e.element;if(!t.is(":file"))throw new Error('AjaxUploader element must be <input type="file" />');var i=e.faker=$("<form></form>");t.replaceWith(i),i.append(t);var n={};if(e.accept)n.accept=r(e.accept);if(e.multiple)n.multiple=!0;t.prop(n),t.on("change"+u,function(){a(e,t.prop("files")),e.emit("fileChange")}),e.emit("ready")},getFiles:function(){return this.fileQueue.files||[]},setAction:function(e){this.action=e},setData:function(e){$.extend(this.data,e)},reset:function(){this.faker[0].reset()},upload:function(n){var a=this,r=a.useChunk?e.STATUS_UPLOADING:e.STATUS_WAITING;if(n=n||o(a),n&&!(n.status>r)){var p=new XMLHttpRequest;if(a.xhrProps)$.extend(p,a.xhrProps);n.xhr=p,$.each(f,function(e,t){p["on"+t.type]=function(e){t.handler(a,e)}}),$.each(d,function(e,t){p.upload["on"+t.type]=function(e){t.handler(a,e)}}),p.open("post",a.action,!0);var l=a.useChunk?i:t;l(a,n)}},stop:function(){var t=this,i=o(t);if(i&&i.status===e.STATUS_UPLOADING)i.xhr.abort();t.reset()},enable:function(){this.element.prop("disabled",!1)},disable:function(){this.element.prop("disabled",!0)},dispose:function(){var e=this;s.dispose(e),e.stop(),e.element.off(u),e.faker=e.element=e.fileQueue=null}},l(e.prototype),e.defaultOptions={data:{},multiple:!1,fileName:"Filedata",ignoreError:!1},e.supportChunk="undefined"!=typeof FileReader,e.STATUS_WAITING=0,e.STATUS_UPLOADING=1,e.STATUS_UPLOAD_SUCCESS=2,e.STATUS_UPLOAD_ERROR=3,e.ERROR_CANCEL=0,e.ERROR_CHUNK_SIZE=-1;var u=".cobble_helper_ajaxuploader",c={html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",css:"text/css",js:"application/x-javascript",json:"application/json",atom:"application/atom+xml",rss:"application/rss+xml",mml:"text/mathml",txt:"text/plain",jad:"text/vnd.sun.j2me.app-descriptor",wml:"text/vnd.wap.wml",htc:"text/x-component",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",tif:"image/tiff",tiff:"image/tiff",wbmp:"image/vnd.wap.wbmp",ico:"image/x-icon",jng:"image/x-jng",bmp:"image/x-ms-bmp",svg:"image/svg+xml",svgz:"image/svg+xml",webp:"image/webp",mp3:"audio/mpeg",wma:"audio/x-ms-wma",wav:"audio/x-wav",mid:"audio/midi",midd:"audio/midi",kar:"audio/midi",ogg:"audio/ogg",m4a:"audio/x-m4a",ra:"audio/x-realaudio",ram:"audio/x-pn-realaudio",mod:"audio/mod","3gp":"video/3gpp","3gpp":"video/3gpp",mp4:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",mov:"video/quicktime",webm:"video/webm",flv:"video/x-flv",m4v:"video/x-m4v",mng:"video/x-mng",asx:"video/x-ms-asf",asf:"video/x-ms-asf",wmv:"video/x-ms-wmv",avi:"video/x-msvideo",rm:"video/vnd.rn-realvideo",rmvb:"video/vnd.rn-realvideo",ts:"video/MP2T",dv:"video/x-dv",mkv:"video/x-matroska",jar:"application/java-archive",war:"application/java-archive",ear:"application/java-archive",hqx:"application/mac-binhex40",pdf:"application/pdf",ps:"application/postscript",eps:"application/postscript",ai:"application/postscript",rtf:"application/rtf",wmlc:"application/vnd.wap.wmlc",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz","7z":"application/x-7z-compressed",cco:"application/x-cocoa",jardiff:"application/x-java-archive-diff",jnlp:"application/x-java-jnlp-file",run:"application/x-makeself",pl:"application/x-perl",pm:"application/x-perl",prc:"application/x-pilot",pdb:"application/x-pilot",rar:"application/x-rar-compressed",rpm:"application/x-redhat-package-manager",sea:"application/x-sea",swf:"application/x-shockwave-flash",sit:"application/x-stuffit",tcl:"application/x-tcl",tk:"application/x-tcl",der:"application/x-x509-ca-cert",pem:"application/x-x509-ca-cert",crt:"application/x-x509-ca-cert",xpi:"application/x-xpinstall",xhtml:"application/xhtml+xml",zip:"application/zip",bin:"application/octet-stream",exe:"application/octet-stream",dll:"application/octet-stream",deb:"application/octet-stream",dmg:"application/octet-stream",eot:"application/octet-stream",iso:"application/octet-stream",img:"application/octet-stream",msi:"application/octet-stream",msp:"application/octet-stream",msm:"application/octet-stream",doc:"application/msword",xls:"application/vnd.ms-excel",ppt:"application/vnd.ms-powerpoint",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation"},f={uploadStart:{type:"loadstart",handler:function(t){var i=o(t);i.status=e.STATUS_UPLOADING,t.emit("uploadStart",{fileItem:i})}},uploadSuccess:{type:"load",handler:function(t,i){var a=o(t),r={fileItem:a,responseText:a.xhr.responseText},p=a.chunk;if(p){var l=p.uploaded;if(l<a.file.size){var i=t.emit("chunkUploadSuccess",r);if(!i.isDefaultPrevented())if(p.index++,p.uploaded=l+p.uploading,p.uploaded<a.file.size)t.upload();else return a.status=e.STATUS_UPLOAD_SUCCESS,t.emit("uploadSuccess",r),void n(t,a);return}}a.status=e.STATUS_UPLOAD_SUCCESS,t.emit("uploadSuccess",r),n(t,a)}},uploadError:{type:"error",handler:function(t,i,a){var r=o(t);r.status=e.STATUS_UPLOAD_ERROR,t.emit("uploadError",{fileItem:r,errorCode:a}),n(t,r)}},uploadStop:{type:"abort",handler:function(t,i){f.uploadError.handler(t,i,e.ERROR_CANCEL)}}},d={uploadProgress:{type:"progress",handler:function(e,t){var i=o(e),n=i.file.size,a=t.loaded,r=i.chunk;if(r)a+=r.uploaded;var p=a/(n||1);if(p>=0&&1>=p);else if(0>p)p=0;else if(p>1)p=1;p=parseInt(100*p,10)+"%",e.emit("uploadProgress",{fileItem:i,uploaded:a,total:n,percent:p})}}};return e}),define("cobble/helper/FlashUploader",["require","exports","module","../util/supload/supload","../function/jquerify","../function/lifeCycle"],function(require){"use strict";function e(e){return n.init(this,e)}require("../util/supload/supload");var t=window.Supload,i=require("../function/jquerify"),n=require("../function/lifeCycle");e.prototype={constructor:e,type:"FlashUploader",init:function(){var e=this,i={flashUrl:e.flashUrl,element:e.element[0],action:e.action,accept:e.accept,multiple:e.multiple,data:e.data,fileName:e.fileName,ignoreError:e.ignoreError,customSettings:{uploader:e}};$.each(a,function(e,t){e=$.camelCase("on-"+e),i[e]=t}),e.supload=new t(i)},getFiles:function(){return this.supload.getFiles()},setAction:function(e){this.supload.setAction(e)},setData:function(e){this.supload.setData(e)},reset:function(){this.supload.reset()},upload:function(){this.supload.upload()},stop:function(){this.supload.cancel()},enable:function(){this.supload.enable()},disable:function(){this.supload.disable()},dispose:function(){var e=this;n.dispose(e),e.supload.dispose(),e.supload=e.element=null}},i(e.prototype),e.defaultOptions={multiple:!1,fileName:"Filedata",ignoreError:!1,flashUrl:require.toUrl("../util/supload/supload.swf")},e.STATUS_WAITING=t.STATUS_WAITING,e.STATUS_UPLOADING=t.STATUS_UPLOADING,e.STATUS_UPLOAD_SUCCESS=t.STATUS_UPLOAD_SUCCESS,e.STATUS_UPLOAD_ERROR=t.STATUS_UPLOAD_ERROR,e.ERROR_CANCEL=t.ERROR_CANCEL,e.ERROR_SECURITY=t.ERROR_SECURITY,e.ERROR_IO=t.ERROR_IO;var a={ready:function(){var e=this.customSettings.uploader;e.emit("ready")},fileChange:function(){var e=this.customSettings.uploader;e.emit("fileChange")},uploadStart:function(e){var t=this.customSettings.uploader;t.emit("uploadStart",e)},uploadProgress:function(e){var t=this.customSettings.uploader,i=e.uploaded/(e.total||1);if(i>=0&&1>=i);else i=0;e.percent=parseInt(100*i,10)+"%",t.emit("uploadProgress",e)},uploadSuccess:function(e){var t=this.customSettings.uploader;t.emit("uploadSuccess",e)},uploadError:function(e){var t=this.customSettings.uploader;t.emit("uploadError",e)},uploadComplete:function(e){var t=this.customSettings.uploader;t.emit("uploadComplete",e)}};return e}),define("cobble/ui/Uploader",["require","exports","module","../helper/AjaxUploader","../helper/FlashUploader"],function(require){"use strict";function e(){return"files"in $('<input type="file" />')[0]}function t(){if(!XMLHttpRequest)return!1;var e=new XMLHttpRequest;return"upload"in e&&"onprogress"in e.upload}return e()&&t()?require("../helper/AjaxUploader"):require("../helper/FlashUploader")}),define("cobble/util/cookie",["require","exports","module"],function(require,exports){"use strict";function e(e){if(0===e.indexOf('"'))e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\");var t={};try{e=decodeURIComponent(e.replace(/\+/g," ")),$.each(e.split(";"),function(e,i){var n=i.split("="),a=$.trim(n[0]),o=$.trim(n[1]);if(a)t[a]=o})}catch(i){}return t}function t(e,t,n){var a=n.expires;if($.isNumeric(a)){var o=a;a=new Date,a.setTime(a.getTime()+o*i)}document.cookie=[encodeURIComponent(e),"=",encodeURIComponent(t),a?";expires="+a.toUTCString():"",n.path?";path="+n.path:"",n.domain?";domain="+n.domain:"",n.secure?";secure":""].join("")}var i=36e5;exports.get=function(t){var i=e(document.cookie);return"string"===$.type(t)?i[t]:i},exports.set=function(e,i,n){if($.isPlainObject(e))n=i,i=null;if(n=$.extend({},exports.defaultOptions,n),null===i)$.each(e,function(e,i){t(e,i,n)});else t(e,i,n)},exports.remove=function(e,i){if(null!=e)i=i||{},i.expires=-1,t(e,"",$.extend({},exports.defaultOptions,i))},exports.defaultOptions={path:"/"}}),define("cobble/util/json",["require","exports","module"],function(require,exports,module){if("object"!=typeof JSON)JSON={};return function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,a,o,r,p=gap,l=t[e];if(l&&"object"==typeof l&&"function"==typeof l.toJSON)l=l.toJSON(e);if("function"==typeof rep)l=rep.call(t,e,l);switch(typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,r=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,i=0;o>i;i+=1)r[i]=str(i,l)||"null";return a=0===r.length?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+p+"]":"["+r.join(",")+"]",gap=p,a}if(rep&&"object"==typeof rep){for(o=rep.length,i=0;o>i;i+=1)if("string"==typeof rep[i])if(n=rep[i],a=str(n,l))r.push(quote(n)+(gap?": ":":")+a)}else for(n in l)if(Object.prototype.hasOwnProperty.call(l,n))if(a=str(n,l))r.push(quote(n)+(gap?": ":":")+a);return a=0===r.length?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+p+"}":"{"+r.join(",")+"}",gap=p,a}}if("function"!=typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var cx,escapable,gap,indent,meta,rep;if("function"!=typeof JSON.stringify)escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else if("string"==typeof i)indent=i;if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})};if("function"!=typeof JSON.parse)cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var i,n,a=e[t];if(a&&"object"==typeof a)for(i in a)if(Object.prototype.hasOwnProperty.call(a,i))if(n=walk(a,i),void 0!==n)a[i]=n;else delete a[i];return reviver.call(e,t,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text))text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}(),JSON}),define("cobble/util/supload/supload",["require","exports","module","../cookie","../json"],function(require){function e(e){$.extend(this,e),this.init()}function t(){return"_Supload_"+a++}if(window.Supload===e)return window.Supload;var i=require("../cookie"),n=require("../json");e.prototype={constructor:e,init:function(){var n=t();this.movieName=n;var a=this.element;if("string"===$.type(a))a=document.getElementById(a);var o=this.data||(this.data={});$.each(i.get(),function(e,t){if("undefined"===$.type(o[e]))o[e]=t});var r=e.createSWF(n,this.flashUrl,this.getFlashVars());a.parentNode.replaceChild(r,a),this.element=r,this.onLog=function(e){console.log(e)},e.instances[n]=this},getFlashVars:function(){var t=this,i=[];return $.each(["movieName","action","accept","multiple","fileName","data","ignoreError"],function(e,a){var o=t[a];if(null!=o){if($.isPlainObject(o))o=n.stringify(o);else if($.isArray(o))o=o.join(",");i.push(a+"="+encodeURIComponent(o))}}),i.push("projectName="+e.projectName),i.join("&amp;")},getFiles:function(){return this.element.getFiles&&this.element.getFiles()||[]},setAction:function(e){this.element.setAction&&this.element.setAction(e)},setData:function(e){this.element.setData&&this.element.setData(e)},reset:function(){this.element.reset&&this.element.reset()},upload:function(){this.element.upload&&this.element.upload()},cancel:function(){this.element.cancel&&this.element.cancel()},enable:function(){this.element.enable&&this.element.enable()},disable:function(){this.element.disable&&this.element.disable()},dispose:function(){this.element.dispose&&this.element.dispose(),e.instances[this.movieName]=null,window[this.movieName]=null}},e.projectName="Supload",e.createSWF=function(t,i,n){var a='<object id="'+t+'" class="'+e.projectName.toLowerCase()+'" type="application/x-shockwave-flash" data="'+i+'"><param name="movie" value="'+i+'" /><param name="allowscriptaccess" value="always" /><param name="wmode" value="transparent" /><param name="flashvars" value="'+n+'" /></object>';return $(a)[0]},e.instances={},e.STATUS_WAITING=0,e.STATUS_UPLOADING=1,e.STATUS_UPLOAD_SUCCESS=2,e.STATUS_UPLOAD_ERROR=3,e.ERROR_CANCEL=0,e.ERROR_SECURITY=1,e.ERROR_IO=2;var a=178245;return window.Supload=e,e});