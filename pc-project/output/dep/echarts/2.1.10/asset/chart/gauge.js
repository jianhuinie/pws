define("echarts/chart/gauge",["require","../component/base","./base","../util/shape/GaugePointer","zrender/shape/Text","zrender/shape/Line","zrender/shape/Rectangle","zrender/shape/Circle","zrender/shape/Sector","../config","../util/ecData","../util/accMath","zrender/tool/util","../chart"],function(require){function e(e,a,i,r,o){t.call(this,e,a,i,r,o),s.call(this),this.refresh(r)}var t=require("../component/base"),s=require("./base"),a=require("../util/shape/GaugePointer"),i=require("zrender/shape/Text"),r=require("zrender/shape/Line"),o=require("zrender/shape/Rectangle"),h=require("zrender/shape/Circle"),l=require("zrender/shape/Sector"),n=require("../config"),d=require("../util/ecData"),u=require("../util/accMath"),f=require("zrender/tool/util");return e.prototype={type:n.CHART_TYPE_GAUGE,_buildShape:function(){var e=this.series;this._paramsMap={};for(var t=0,s=e.length;s>t;t++)if(e[t].type===n.CHART_TYPE_GAUGE)e[t]=this.reformOption(e[t]),this.legendHoverLink=e[t].legendHoverLink||this.legendHoverLink,this._buildSingleGauge(t),this.buildMark(t);this.addShapeList()},_buildSingleGauge:function(e){var t=this.series[e];this._paramsMap[e]={center:this.parseCenter(this.zr,t.center),radius:this.parseRadius(this.zr,t.radius),startAngle:t.startAngle.toFixed(2)-0,endAngle:t.endAngle.toFixed(2)-0},this._paramsMap[e].totalAngle=this._paramsMap[e].startAngle-this._paramsMap[e].endAngle,this._colorMap(e),this._buildAxisLine(e),this._buildSplitLine(e),this._buildAxisTick(e),this._buildAxisLabel(e),this._buildPointer(e),this._buildTitle(e),this._buildDetail(e)},_buildAxisLine:function(e){var t=this.series[e];if(t.axisLine.show)for(var s,a,i=t.min,r=t.max-i,o=this._paramsMap[e],h=o.center,l=o.startAngle,n=o.totalAngle,u=o.colorArray,f=t.axisLine.lineStyle,c=this.parsePercent(f.width,o.radius[1]),p=o.radius[1],g=p-c,w=l,_=0,v=u.length;v>_;_++)a=l-n*(u[_][0]-i)/r,s=this._getSector(h,g,p,a,w,u[_][1],f),w=a,s._animationAdd="r",d.set(s,"seriesIndex",e),d.set(s,"dataIndex",_),this.shapeList.push(s)},_buildSplitLine:function(e){var t=this.series[e];if(t.splitLine.show)for(var s,a,i,o=this._paramsMap[e],h=t.splitNumber,l=t.min,n=t.max-l,d=t.splitLine,u=this.parsePercent(d.length,o.radius[1]),f=d.lineStyle,c=f.color,p=o.center,g=o.startAngle*Math.PI/180,w=o.totalAngle*Math.PI/180,_=o.radius[1],v=_-u,x=0;h>=x;x++)s=g-w/h*x,a=Math.sin(s),i=Math.cos(s),this.shapeList.push(new r({zlevel:this._zlevelBase+1,hoverable:!1,style:{xStart:p[0]+i*_,yStart:p[1]-a*_,xEnd:p[0]+i*v,yEnd:p[1]-a*v,strokeColor:"auto"===c?this._getColor(e,l+n/h*x):c,lineType:f.type,lineWidth:f.width,shadowColor:f.shadowColor,shadowBlur:f.shadowBlur,shadowOffsetX:f.shadowOffsetX,shadowOffsetY:f.shadowOffsetY}}))},_buildAxisTick:function(e){var t=this.series[e];if(t.axisTick.show)for(var s,a,i,o=this._paramsMap[e],h=t.splitNumber,l=t.min,n=t.max-l,d=t.axisTick,u=d.splitNumber,f=this.parsePercent(d.length,o.radius[1]),c=d.lineStyle,p=c.color,g=o.center,w=o.startAngle*Math.PI/180,_=o.totalAngle*Math.PI/180,v=o.radius[1],x=v-f,b=0,M=h*u;M>=b;b++)if(b%u!==0)s=w-_/M*b,a=Math.sin(s),i=Math.cos(s),this.shapeList.push(new r({zlevel:this._zlevelBase+1,hoverable:!1,style:{xStart:g[0]+i*v,yStart:g[1]-a*v,xEnd:g[0]+i*x,yEnd:g[1]-a*x,strokeColor:"auto"===p?this._getColor(e,l+n/M*b):p,lineType:c.type,lineWidth:c.width,shadowColor:c.shadowColor,shadowBlur:c.shadowBlur,shadowOffsetX:c.shadowOffsetX,shadowOffsetY:c.shadowOffsetY}}));else;},_buildAxisLabel:function(e){var t=this.series[e];if(t.axisLabel.show)for(var s,a,r,o,h=t.splitNumber,l=t.min,n=t.max-l,d=t.axisLabel.textStyle,f=this.getFont(d),c=d.color,p=this._paramsMap[e],g=p.center,w=p.startAngle,_=p.totalAngle,v=p.radius[1]-this.parsePercent(t.splitLine.length,p.radius[1])-10,x=0;h>=x;x++)o=u.accAdd(l,u.accMul(u.accDiv(n,h),x)),s=w-_/h*x,a=Math.sin(s*Math.PI/180),r=Math.cos(s*Math.PI/180),s=(s+360)%360,this.shapeList.push(new i({zlevel:this._zlevelBase+1,hoverable:!1,style:{x:g[0]+r*v,y:g[1]-a*v,color:"auto"===c?this._getColor(e,o):c,text:this._getLabelText(t.axisLabel.formatter,o),textAlign:s>=110&&250>=s?"left":70>=s||s>=290?"right":"center",textBaseline:s>=10&&170>=s?"top":s>=190&&350>=s?"bottom":"middle",textFont:f,shadowColor:d.shadowColor,shadowBlur:d.shadowBlur,shadowOffsetX:d.shadowOffsetX,shadowOffsetY:d.shadowOffsetY}}))},_buildPointer:function(e){var t=this.series[e];if(t.pointer.show){var s=t.max-t.min,i=t.pointer,r=this._paramsMap[e],o=this.parsePercent(i.length,r.radius[1]),l=this.parsePercent(i.width,r.radius[1]),n=r.center,u=this._getValue(e);u=u<t.max?u:t.max;var f=(r.startAngle-r.totalAngle/s*(u-t.min))*Math.PI/180,c="auto"===i.color?this._getColor(e,u):i.color,p=new a({zlevel:this._zlevelBase+1,style:{x:n[0],y:n[1],r:o,startAngle:r.startAngle*Math.PI/180,angle:f,color:c,width:l,shadowColor:i.shadowColor,shadowBlur:i.shadowBlur,shadowOffsetX:i.shadowOffsetX,shadowOffsetY:i.shadowOffsetY},highlightStyle:{brushType:"fill",width:l>2?2:l/2,color:"#fff"}});d.pack(p,this.series[e],e,this.series[e].data[0],0,this.series[e].data[0].name,u),this.shapeList.push(p),this.shapeList.push(new h({zlevel:this._zlevelBase+2,hoverable:!1,style:{x:n[0],y:n[1],r:i.width/2.5,color:"#fff"}}))}},_buildTitle:function(e){var t=this.series[e];if(t.title.show){var s=t.data[0],a=null!=s.name?s.name:"";if(""!==a){var r=t.title,o=r.offsetCenter,h=r.textStyle,l=h.color,n=this._paramsMap[e],d=n.center[0]+this.parsePercent(o[0],n.radius[1]),u=n.center[1]+this.parsePercent(o[1],n.radius[1]);this.shapeList.push(new i({zlevel:this._zlevelBase+(Math.abs(d-n.center[0])+Math.abs(u-n.center[1]))<2*h.fontSize?2:1,hoverable:!1,style:{x:d,y:u,color:"auto"===l?this._getColor(e):l,text:a,textAlign:"center",textFont:this.getFont(h),shadowColor:h.shadowColor,shadowBlur:h.shadowBlur,shadowOffsetX:h.shadowOffsetX,shadowOffsetY:h.shadowOffsetY}}))}}},_buildDetail:function(e){var t=this.series[e];if(t.detail.show){var s=t.detail,a=s.offsetCenter,i=s.backgroundColor,r=s.textStyle,h=r.color,l=this._paramsMap[e],n=this._getValue(e),d=l.center[0]-s.width/2+this.parsePercent(a[0],l.radius[1]),u=l.center[1]+this.parsePercent(a[1],l.radius[1]);this.shapeList.push(new o({zlevel:this._zlevelBase+(Math.abs(d+s.width/2-l.center[0])+Math.abs(u+s.height/2-l.center[1]))<r.fontSize?2:1,hoverable:!1,style:{x:d,y:u,width:s.width,height:s.height,brushType:"both",color:"auto"===i?this._getColor(e,n):i,lineWidth:s.borderWidth,strokeColor:s.borderColor,shadowColor:s.shadowColor,shadowBlur:s.shadowBlur,shadowOffsetX:s.shadowOffsetX,shadowOffsetY:s.shadowOffsetY,text:this._getLabelText(s.formatter,n),textFont:this.getFont(r),textPosition:"inside",textColor:"auto"===h?this._getColor(e,n):h}}))}},_getValue:function(e){var t=this.series[e].data[0];return null!=t.value?t.value:t},_colorMap:function(e){var t=this.series[e],s=t.min,a=t.max-s,i=t.axisLine.lineStyle.color;if(!(i instanceof Array))i=[[1,i]];for(var r=[],o=0,h=i.length;h>o;o++)r.push([i[o][0]*a+s,i[o][1]]);this._paramsMap[e].colorArray=r},_getColor:function(e,t){if(null==t)t=this._getValue(e);for(var s=this._paramsMap[e].colorArray,a=0,i=s.length;i>a;a++)if(s[a][0]>=t)return s[a][1];return s[s.length-1][1]},_getSector:function(e,t,s,a,i,r,o){return new l({zlevel:this._zlevelBase,hoverable:!1,style:{x:e[0],y:e[1],r0:t,r:s,startAngle:a,endAngle:i,brushType:"fill",color:r,shadowColor:o.shadowColor,shadowBlur:o.shadowBlur,shadowOffsetX:o.shadowOffsetX,shadowOffsetY:o.shadowOffsetY}})},_getLabelText:function(e,t){if(e)if("function"==typeof e)return e.call(this.myChart,t);else if("string"==typeof e)return e.replace("{value}",t);return t},refresh:function(e){if(e)this.option=e,this.series=e.series;this.backupShapeList(),this._buildShape()}},f.inherits(e,s),f.inherits(e,t),require("../chart").define("gauge",e),e}),define("echarts/util/shape/GaugePointer",["require","zrender/shape/Base","zrender/tool/util","./normalIsCover"],function(require){function e(e){t.call(this,e)}var t=require("zrender/shape/Base"),s=require("zrender/tool/util");return e.prototype={type:"gauge-pointer",buildPath:function(e,t){var s=t.r,a=t.width,i=t.angle,r=t.x-Math.cos(i)*a*(a>=s/3?1:2),o=t.y+Math.sin(i)*a*(a>=s/3?1:2);i=t.angle-Math.PI/2,e.moveTo(r,o),e.lineTo(t.x+Math.cos(i)*a,t.y-Math.sin(i)*a),e.lineTo(t.x+Math.cos(t.angle)*s,t.y-Math.sin(t.angle)*s),e.lineTo(t.x-Math.cos(i)*a,t.y+Math.sin(i)*a),e.lineTo(r,o)},getRect:function(e){if(e.__rect)return e.__rect;var t=2*e.width,s=e.x,a=e.y,i=s+Math.cos(e.angle)*e.r,r=a-Math.sin(e.angle)*e.r;return e.__rect={x:Math.min(s,i)-t,y:Math.min(a,r)-t,width:Math.abs(s-i)+t,height:Math.abs(a-r)+t},e.__rect},isCover:require("./normalIsCover")},s.inherits(e,t),e});