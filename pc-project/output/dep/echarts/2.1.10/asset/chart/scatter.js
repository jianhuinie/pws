define("echarts/chart/scatter",["require","../component/base","./base","../util/shape/Symbol","../component/axis","../component/grid","../component/dataZoom","../component/dataRange","../config","zrender/tool/util","zrender/tool/color","../chart"],function(require){function t(t,a,s,n,h){e.call(this,t,a,s,n,h),i.call(this),this.refresh(n)}var e=require("../component/base"),i=require("./base"),a=require("../util/shape/Symbol");require("../component/axis"),require("../component/grid"),require("../component/dataZoom"),require("../component/dataRange");var s=require("../config"),n=require("zrender/tool/util"),h=require("zrender/tool/color");return t.prototype={type:s.CHART_TYPE_SCATTER,_buildShape:function(){var t=this.series;this._sIndex2ColorMap={},this._symbol=this.option.symbolList,this._sIndex2ShapeMap={},this.selectedMap={},this.xMarkMap={};for(var e,i,a,n,o=this.component.legend,l=[],r=0,d=t.length;d>r;r++)if(e=t[r],i=e.name,e.type===s.CHART_TYPE_SCATTER){if(t[r]=this.reformOption(t[r]),this.legendHoverLink=t[r].legendHoverLink||this.legendHoverLink,this._sIndex2ShapeMap[r]=this.query(e,"symbol")||this._symbol[r%this._symbol.length],o){if(this.selectedMap[i]=o.isSelected(i),this._sIndex2ColorMap[r]=h.alpha(o.getColor(i),.5),a=o.getItemShape(i)){var n=this._sIndex2ShapeMap[r];if(a.style.brushType=n.match("empty")?"stroke":"both",n=n.replace("empty","").toLowerCase(),n.match("rectangle"))a.style.x+=Math.round((a.style.width-a.style.height)/2),a.style.width=a.style.height;if(n.match("star"))a.style.n=n.replace("star","")-0||5,n="star";if(n.match("image"))a.style.image=n.replace(new RegExp("^image:\\/\\/"),""),a.style.x+=Math.round((a.style.width-a.style.height)/2),a.style.width=a.style.height,n="image";a.style.iconType=n,o.setItemShape(i,a)}}else this.selectedMap[i]=!0,this._sIndex2ColorMap[r]=h.alpha(this.zr.getColor(r),.5);if(this.selectedMap[i])l.push(r)}this._buildSeries(l),this.addShapeList()},_buildSeries:function(t){if(0!==t.length){for(var e,i,a,s,n,h,o,l,r=this.series,d={},p=0,g=t.length;g>p;p++)if(e=t[p],i=r[e],0!==i.data.length){n=this.component.xAxis.getAxis(i.xAxisIndex||0),h=this.component.yAxis.getAxis(i.yAxisIndex||0),d[e]=[];for(var _=0,c=i.data.length;c>_;_++)if(a=i.data[_],s=null!=a?null!=a.value?a.value:a:"-",!("-"===s||s.length<2))o=n.getCoord(s[0]),l=h.getCoord(s[1]),d[e].push([o,l,_,a.name||""]);else;this.xMarkMap[e]=this._markMap(n,h,i.data,d[e]),this.buildMark(e)}else;this._buildPointList(d)}},_markMap:function(t,e,i,a){for(var s,n={min0:Number.POSITIVE_INFINITY,max0:Number.NEGATIVE_INFINITY,sum0:0,counter0:0,average0:0,min1:Number.POSITIVE_INFINITY,max1:Number.NEGATIVE_INFINITY,sum1:0,counter1:0,average1:0},h=0,o=a.length;o>h;h++){if(s=i[a[h][2]].value||i[a[h][2]],n.min0>s[0])n.min0=s[0],n.minY0=a[h][1],n.minX0=a[h][0];if(n.max0<s[0])n.max0=s[0],n.maxY0=a[h][1],n.maxX0=a[h][0];if(n.sum0+=s[0],n.counter0++,n.min1>s[1])n.min1=s[1],n.minY1=a[h][1],n.minX1=a[h][0];if(n.max1<s[1])n.max1=s[1],n.maxY1=a[h][1],n.maxX1=a[h][0];n.sum1+=s[1],n.counter1++}var l=this.component.grid.getX(),r=this.component.grid.getXend(),d=this.component.grid.getY(),p=this.component.grid.getYend();n.average0=(n.sum0/n.counter0).toFixed(2)-0;var g=t.getCoord(n.average0);n.averageLine0=[[g,p],[g,d]],n.minLine0=[[n.minX0,p],[n.minX0,d]],n.maxLine0=[[n.maxX0,p],[n.maxX0,d]],n.average1=(n.sum1/n.counter1).toFixed(2)-0;var _=e.getCoord(n.average1);return n.averageLine1=[[l,_],[r,_]],n.minLine1=[[l,n.minY1],[r,n.minY1]],n.maxLine1=[[l,n.maxY1],[r,n.maxY1]],n},_buildPointList:function(t){var e,i,a,s,n=this.series;for(var h in t)if(e=n[h],i=t[h],!(e.large&&e.data.length>e.largeThreshold))for(var o=0,l=i.length;l>o;o++)a=i[o],s=this._getSymbol(h,a[2],a[3],a[0],a[1]),s&&this.shapeList.push(s);else this.shapeList.push(this._getLargeSymbol(i,this.getItemStyleColor(this.query(e,"itemStyle.normal.color"),h,-1)||this._sIndex2ColorMap[h]))},_getSymbol:function(t,e,i,a,s){var n,h=this.series,o=h[t],l=o.data[e],r=this.component.dataRange;if(r){if(n=isNaN(l[2])?this._sIndex2ColorMap[t]:r.getColor(l[2]),!n)return null}else n=this._sIndex2ColorMap[t];var d=this.getSymbolShape(o,t,l,e,i,a,s,this._sIndex2ShapeMap[t],n,"rgba(0,0,0,0)","vertical");return d.zlevel=this._zlevelBase,d._main=!0,d},_getLargeSymbol:function(t,e){return new a({zlevel:this._zlevelBase,_main:!0,hoverable:!1,style:{pointList:t,color:e,strokeColor:e},highlightStyle:{pointList:[]}})},getMarkCoord:function(t,e){var i,a=this.series[t],s=this.xMarkMap[t],n=this.component.xAxis.getAxis(a.xAxisIndex),h=this.component.yAxis.getAxis(a.yAxisIndex);if(e.type&&("max"===e.type||"min"===e.type||"average"===e.type)){var o=null!=e.valueIndex?e.valueIndex:1;i=[s[e.type+"X"+o],s[e.type+"Y"+o],s[e.type+"Line"+o],s[e.type+o]]}else i=["string"!=typeof e.xAxis&&n.getCoordByIndex?n.getCoordByIndex(e.xAxis||0):n.getCoord(e.xAxis||0),"string"!=typeof e.yAxis&&h.getCoordByIndex?h.getCoordByIndex(e.yAxis||0):h.getCoord(e.yAxis||0)];return i},refresh:function(t){if(t)this.option=t,this.series=t.series;this.backupShapeList(),this._buildShape()},ondataRange:function(t,e){if(this.component.dataRange)this.refresh(),e.needRefresh=!0}},n.inherits(t,i),n.inherits(t,e),require("../chart").define("scatter",t),t}),define("echarts/component/dataRange",["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../util/shape/HandlePolygon","../config","zrender/tool/util","zrender/tool/event","zrender/tool/area","zrender/tool/color","../component"],function(require){function t(t,i,a,s,h){if("undefined"==typeof this.query(s,"dataRange.min")||"undefined"==typeof this.query(s,"dataRange.max"))return void console.error("option.dataRange.min or option.dataRange.max has not been defined.");e.call(this,t,i,a,s,h);var o=this;o._ondrift=function(t,e){return o.__ondrift(this,t,e)},o._ondragend=function(){return o.__ondragend()},o._dataRangeSelected=function(t){return o.__dataRangeSelected(t)},o._dispatchHoverLink=function(t){return o.__dispatchHoverLink(t)},o._onhoverlink=function(t){return o.__onhoverlink(t)},this._selectedMap={},this._range={},this.refresh(s),i.bind(n.EVENT.HOVER,this._onhoverlink)}var e=require("./base"),i=require("zrender/shape/Text"),a=require("zrender/shape/Rectangle"),s=require("../util/shape/HandlePolygon"),n=require("../config"),h=require("zrender/tool/util"),o=require("zrender/tool/event"),l=require("zrender/tool/area"),r=require("zrender/tool/color");return t.prototype={type:n.COMPONENT_TYPE_DATARANGE,_textGap:10,_buildShape:function(){if(this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)this._buildGradient();else this._buildItem();if(this.dataRangeOption.show)for(var t=0,e=this.shapeList.length;e>t;t++)this.zr.addShape(this.shapeList[t]);this._syncShapeFromRange()},_buildItem:function(){var t,e,s,n,h=this._valueTextList,o=h.length,r=this.getFont(this.dataRangeOption.textStyle),d=this._itemGroupLocation.x,p=this._itemGroupLocation.y,g=this.dataRangeOption.itemWidth,_=this.dataRangeOption.itemHeight,c=this.dataRangeOption.itemGap,y=l.getTextHeight("国",r);if("vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x)d=this._itemGroupLocation.x+this._itemGroupLocation.width-g;var x=!0;if(this.dataRangeOption.text)if(x=!1,this.dataRangeOption.text[0]){if(s=this._getTextShape(d,p,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient)d+=l.getTextWidth(this.dataRangeOption.text[0],r)+this._textGap;else p+=y+this._textGap,s.style.y+=y/2+this._textGap,s.style.textBaseline="bottom";this.shapeList.push(new i(s))}for(var u=0;o>u;u++){if(t=h[u],n=this.getColorByIndex(u),e=this._getItemShape(d,p,g,_,this._selectedMap[u]?n:"#ccc"),e._idx=u,e.onmousemove=this._dispatchHoverLink,e.onclick=this._dataRangeSelected,this.shapeList.push(new a(e)),x){if(s={zlevel:this._zlevelBase,style:{x:d+g+5,y:p,color:this._selectedMap[u]?this.dataRangeOption.textStyle.color:"#ccc",text:h[u],textFont:r,textBaseline:"top"},highlightStyle:{brushType:"fill"},clickable:!0},"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x)s.style.x-=g+10,s.style.textAlign="right";s._idx=u,s.onclick=this._dataRangeSelected,this.shapeList.push(new i(s))}if("horizontal"==this.dataRangeOption.orient)d+=g+(x?5:0)+(x?l.getTextWidth(t,r):0)+c;else p+=_+c}if(!x&&this.dataRangeOption.text[1]){if("horizontal"==this.dataRangeOption.orient)d=d-c+this._textGap;else p=p-c+this._textGap;if(s=this._getTextShape(d,p,this.dataRangeOption.text[1]),"horizontal"!=this.dataRangeOption.orient)s.style.y-=5,s.style.textBaseline="top";this.shapeList.push(new i(s))}},_buildGradient:function(){var t,e,s=this.getFont(this.dataRangeOption.textStyle),n=this._itemGroupLocation.x,h=this._itemGroupLocation.y,o=this.dataRangeOption.itemWidth,r=this.dataRangeOption.itemHeight,d=l.getTextHeight("国",s),p=!0;if(this.dataRangeOption.text)if(p=!1,this.dataRangeOption.text[0]){if(e=this._getTextShape(n,h,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient)n+=l.getTextWidth(this.dataRangeOption.text[0],s)+this._textGap;else h+=d+this._textGap,e.style.y+=d/2+this._textGap,e.style.textBaseline="bottom";this.shapeList.push(new i(e))}for(var g=require("zrender/tool/color"),_=1/(this.dataRangeOption.color.length-1),c=[],y=0,x=this.dataRangeOption.color.length;x>y;y++)c.push([y*_,this.dataRangeOption.color[y]]);if("horizontal"==this.dataRangeOption.orient)t={zlevel:this._zlevelBase,style:{x:n,y:h,width:10*o,height:r,color:g.getLinearGradient(n,h,n+10*o,h,c)},hoverable:!1},n+=10*o+this._textGap;else t={zlevel:this._zlevelBase,style:{x:n,y:h,width:o,height:10*r,color:g.getLinearGradient(n,h,n,h+10*r,c)},hoverable:!1},h+=10*r+this._textGap;if(this.shapeList.push(new a(t)),this._calculableLocation=t.style,this.dataRangeOption.calculable)this._buildFiller(),this._bulidMask(),this._bulidHandle();if(this._buildIndicator(),!p&&this.dataRangeOption.text[1])e=this._getTextShape(n,h,this.dataRangeOption.text[1]),this.shapeList.push(new i(e))},_buildIndicator:function(){var t,e,i=this._calculableLocation.x,a=this._calculableLocation.y,n=this._calculableLocation.width,h=this._calculableLocation.height,o=5;if("horizontal"==this.dataRangeOption.orient)if("bottom"!=this.dataRangeOption.y)t=[[i,a+h],[i-o,a+h+o],[i+o,a+h+o]],e="bottom";else t=[[i,a],[i-o,a-o],[i+o,a-o]],e="top";else if("right"!=this.dataRangeOption.x)t=[[i+n,a],[i+n+o,a-o],[i+n+o,a+o]],e="right";else t=[[i,a],[i-o,a-o],[i-o,a+o]],e="left";this._indicatorShape={style:{pointList:t,color:"#fff",__rect:{x:Math.min(t[0][0],t[1][0]),y:Math.min(t[0][1],t[1][1]),width:o*("horizontal"==this.dataRangeOption.orient?2:1),height:o*("horizontal"==this.dataRangeOption.orient?1:2)}},highlightStyle:{brushType:"fill",textPosition:e,textColor:this.dataRangeOption.textStyle.color},hoverable:!1},this._indicatorShape=new s(this._indicatorShape)},_buildFiller:function(){this._fillerShape={zlevel:this._zlevelBase+1,style:{x:this._calculableLocation.x,y:this._calculableLocation.y,width:this._calculableLocation.width,height:this._calculableLocation.height,color:"rgba(255,255,255,0)"},highlightStyle:{strokeColor:"rgba(255,255,255,0.5)",lineWidth:1},draggable:!0,ondrift:this._ondrift,ondragend:this._ondragend,onmousemove:this._dispatchHoverLink,_type:"filler"},this._fillerShape=new a(this._fillerShape),this.shapeList.push(this._fillerShape)},_bulidHandle:function(){var t,e,i,a,n,h,o,r,d=this._calculableLocation.x,p=this._calculableLocation.y,g=this._calculableLocation.width,_=this._calculableLocation.height,c=this.getFont(this.dataRangeOption.textStyle),y=l.getTextHeight("国",c),x=Math.max(l.getTextWidth(this._textFormat(this.dataRangeOption.max),c),l.getTextWidth(this._textFormat(this.dataRangeOption.min),c))+2;if("horizontal"==this.dataRangeOption.orient)if("bottom"!=this.dataRangeOption.y)t=[[d,p],[d,p+_+y],[d-y,p+_+y],[d-1,p+_],[d-1,p]],e=d-x/2-y,i=p+_+y/2+2,a={x:d-x-y,y:p+_,width:x+y,height:y},n=[[d+g,p],[d+g,p+_+y],[d+g+y,p+_+y],[d+g+1,p+_],[d+g+1,p]],h=d+g+x/2+y,o=i,r={x:d+g,y:p+_,width:x+y,height:y};else t=[[d,p+_],[d,p-y],[d-y,p-y],[d-1,p],[d-1,p+_]],e=d-x/2-y,i=p-y/2-2,a={x:d-x-y,y:p-y,width:x+y,height:y},n=[[d+g,p+_],[d+g,p-y],[d+g+y,p-y],[d+g+1,p],[d+g+1,p+_]],h=d+g+x/2+y,o=i,r={x:d+g,y:p-y,width:x+y,height:y};else if(x+=y,"right"!=this.dataRangeOption.x)t=[[d,p],[d+g+y,p],[d+g+y,p-y],[d+g,p-1],[d,p-1]],e=d+g+x/2+y/2,i=p-y/2,a={x:d+g,y:p-y,width:x+y,height:y},n=[[d,p+_],[d+g+y,p+_],[d+g+y,p+y+_],[d+g,p+1+_],[d,p+_+1]],h=e,o=p+_+y/2,r={x:d+g,y:p+_,width:x+y,height:y};else t=[[d+g,p],[d-y,p],[d-y,p-y],[d,p-1],[d+g,p-1]],e=d-x/2-y/2,i=p-y/2,a={x:d-x-y,y:p-y,width:x+y,height:y},n=[[d+g,p+_],[d-y,p+_],[d-y,p+y+_],[d,p+1+_],[d+g,p+_+1]],h=e,o=p+_+y/2,r={x:d-x-y,y:p+_,width:x+y,height:y};this._startShape={style:{pointList:t,text:this._textFormat(this.dataRangeOption.max),textX:e,textY:i,color:this.getColor(this.dataRangeOption.max),rect:a,x:t[0][0],y:t[0][1],_x:t[0][0],_y:t[0][1]}},this._startShape.highlightStyle={strokeColor:this._startShape.style.color,lineWidth:1},this._endShape={style:{pointList:n,text:this._textFormat(this.dataRangeOption.min),textX:h,textY:o,color:this.getColor(this.dataRangeOption.min),rect:r,x:n[0][0],y:n[0][1],_x:n[0][0],_y:n[0][1]}},this._endShape.highlightStyle={strokeColor:this._endShape.style.color,lineWidth:1},this._startShape.zlevel=this._endShape.zlevel=this._zlevelBase+1,this._startShape.draggable=this._endShape.draggable=!0,this._startShape.ondrift=this._endShape.ondrift=this._ondrift,this._startShape.ondragend=this._endShape.ondragend=this._ondragend,this._startShape.style.textColor=this._endShape.style.textColor=this.dataRangeOption.textStyle.color,this._startShape.style.textAlign=this._endShape.style.textAlign="center",this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape.style.textBaseline=this._endShape.style.textBaseline="middle",this._startShape.style.width=this._endShape.style.width=0,this._startShape.style.height=this._endShape.style.height=0,this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape=new s(this._startShape),this._endShape=new s(this._endShape),this.shapeList.push(this._startShape),this.shapeList.push(this._endShape)},_bulidMask:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,s=this._calculableLocation.height;this._startMask={zlevel:this._zlevelBase+1,style:{x:t,y:e,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?s:0,color:"#ccc"},hoverable:!1},this._endMask={zlevel:this._zlevelBase+1,style:{x:"horizontal"==this.dataRangeOption.orient?t+i:t,y:"horizontal"==this.dataRangeOption.orient?e:e+s,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?s:0,color:"#ccc"},hoverable:!1},this._startMask=new a(this._startMask),this._endMask=new a(this._endMask),this.shapeList.push(this._startMask),this.shapeList.push(this._endMask)},_buildBackground:function(){var t=this.reformCssArray(this.dataRangeOption.padding);this.shapeList.push(new a({zlevel:this._zlevelBase,hoverable:!1,style:{x:this._itemGroupLocation.x-t[3],y:this._itemGroupLocation.y-t[0],width:this._itemGroupLocation.width+t[3]+t[1],height:this._itemGroupLocation.height+t[0]+t[2],brushType:0===this.dataRangeOption.borderWidth?"fill":"both",color:this.dataRangeOption.backgroundColor,strokeColor:this.dataRangeOption.borderColor,lineWidth:this.dataRangeOption.borderWidth}}))},_getItemGroupLocation:function(){var t=this._valueTextList,e=t.length,i=this.dataRangeOption.itemGap,a=this.dataRangeOption.itemWidth,s=this.dataRangeOption.itemHeight,n=0,h=0,o=this.getFont(this.dataRangeOption.textStyle),r=l.getTextHeight("国",o);if("horizontal"==this.dataRangeOption.orient){if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)n=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?10*a+i:e*(a+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?l.getTextWidth(this.dataRangeOption.text[0],o)+this._textGap:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?l.getTextWidth(this.dataRangeOption.text[1],o)+this._textGap:0);else{a+=5;for(var d=0;e>d;d++)n+=a+l.getTextWidth(t[d],o)+i}n-=i,h=Math.max(r,s)}else{var p;if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)h=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?10*s+i:e*(s+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?this._textGap+r:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?this._textGap+r:0),p=Math.max(l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[0]||"",o),l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[1]||"",o)),n=Math.max(a,p);else{h=(s+i)*e,a+=5,p=0;for(var d=0;e>d;d++)p=Math.max(p,l.getTextWidth(t[d],o));n=a+p}h-=i}var g,_=this.reformCssArray(this.dataRangeOption.padding),c=this.zr.getWidth();switch(this.dataRangeOption.x){case"center":g=Math.floor((c-n)/2);break;case"left":g=_[3]+this.dataRangeOption.borderWidth;break;case"right":g=c-n-_[1]-this.dataRangeOption.borderWidth;break;default:g=this.parsePercent(this.dataRangeOption.x,c),g=isNaN(g)?0:g}var y,x=this.zr.getHeight();switch(this.dataRangeOption.y){case"top":y=_[0]+this.dataRangeOption.borderWidth;break;case"bottom":y=x-h-_[2]-this.dataRangeOption.borderWidth;break;case"center":y=Math.floor((x-h)/2);break;default:y=this.parsePercent(this.dataRangeOption.y,x),y=isNaN(y)?0:y}if(this.dataRangeOption.calculable){var u=Math.max(l.getTextWidth(this.dataRangeOption.max,o),l.getTextWidth(this.dataRangeOption.min,o))+r;if("horizontal"==this.dataRangeOption.orient){if(u>g)g=u;if(g+n+u>c)g-=u}else{if(r>y)y=r;if(y+h+r>x)y-=r}}return{x:g,y:y,width:n,height:h}},_getTextShape:function(t,e,i){return{zlevel:this._zlevelBase,style:{x:"horizontal"==this.dataRangeOption.orient?t:this._itemGroupLocation.x+this._itemGroupLocation.width/2,y:"horizontal"==this.dataRangeOption.orient?this._itemGroupLocation.y+this._itemGroupLocation.height/2:e,color:this.dataRangeOption.textStyle.color,text:i,textFont:this.getFont(this.dataRangeOption.textStyle),textBaseline:"horizontal"==this.dataRangeOption.orient?"middle":"top",textAlign:"horizontal"==this.dataRangeOption.orient?"left":"center"},hoverable:!1}},_getItemShape:function(t,e,i,a,s){return{zlevel:this._zlevelBase,style:{x:t,y:e+1,width:i,height:a-2,color:s},highlightStyle:{strokeColor:s,lineWidth:1},clickable:!0}},__ondrift:function(t,e,i){var a=this._calculableLocation.x,s=this._calculableLocation.y,n=this._calculableLocation.width,h=this._calculableLocation.height;if("horizontal"==this.dataRangeOption.orient)if(t.style.x+e<=a)t.style.x=a;else if(t.style.x+e+t.style.width>=a+n)t.style.x=a+n-t.style.width;else t.style.x+=e;else if(t.style.y+i<=s)t.style.y=s;else if(t.style.y+i+t.style.height>=s+h)t.style.y=s+h-t.style.height;else t.style.y+=i;if("filler"==t._type)this._syncHandleShape();else this._syncFillerShape(t);if(this.dataRangeOption.realtime)this._syncData();return!0},__ondragend:function(){this.isDragend=!0},ondragend:function(t,e){if(this.isDragend&&t.target){if(!this.dataRangeOption.realtime&&this._syncData(),e.dragOut=!0,e.dragIn=!0,!this.dataRangeOption.realtime)this.messageCenter.dispatch(n.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart);e.needRefresh=!1,this.isDragend=!1}},_syncShapeFromRange:function(){var t=this.dataRangeOption.range||{};if(this._range.end="undefined"!=typeof this._range.end?this._range.end:"undefined"!=typeof t.start?t.start:0,this._range.start="undefined"!=typeof this._range.start?this._range.start:"undefined"!=typeof t.end?t.end:100,100!=this._range.start||0!==this._range.end){if("horizontal"==this.dataRangeOption.orient){var e=this._fillerShape.style.width;this._fillerShape.style.x+=e*(100-this._range.start)/100,this._fillerShape.style.width=e*(this._range.start-this._range.end)/100}else{var i=this._fillerShape.style.height;this._fillerShape.style.y+=i*(100-this._range.start)/100,this._fillerShape.style.height=i*(this._range.start-this._range.end)/100}this.zr.modShape(this._fillerShape.id),this._syncHandleShape()}},_syncHandleShape:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,a=this._calculableLocation.height;if("horizontal"==this.dataRangeOption.orient)this._startShape.style.x=this._fillerShape.style.x,this._startMask.style.width=this._startShape.style.x-t,this._endShape.style.x=this._fillerShape.style.x+this._fillerShape.style.width,this._endMask.style.x=this._endShape.style.x,this._endMask.style.width=t+i-this._endShape.style.x,this._range.start=Math.ceil(100-(this._startShape.style.x-t)/i*100),this._range.end=Math.floor(100-(this._endShape.style.x-t)/i*100);else this._startShape.style.y=this._fillerShape.style.y,this._startMask.style.height=this._startShape.style.y-e,this._endShape.style.y=this._fillerShape.style.y+this._fillerShape.style.height,this._endMask.style.y=this._endShape.style.y,this._endMask.style.height=e+a-this._endShape.style.y,this._range.start=Math.ceil(100-(this._startShape.style.y-e)/a*100),this._range.end=Math.floor(100-(this._endShape.style.y-e)/a*100);this._syncShape()},_syncFillerShape:function(t){var e,i,a=this._calculableLocation.x,s=this._calculableLocation.y,n=this._calculableLocation.width,h=this._calculableLocation.height;if("horizontal"==this.dataRangeOption.orient){if(e=this._startShape.style.x,i=this._endShape.style.x,t.id==this._startShape.id&&e>=i)i=e,this._endShape.style.x=e;else if(t.id==this._endShape.id&&e>=i)e=i,this._startShape.style.x=e;this._fillerShape.style.x=e,this._fillerShape.style.width=i-e,this._startMask.style.width=e-a,this._endMask.style.x=i,this._endMask.style.width=a+n-i,this._range.start=Math.ceil(100-(e-a)/n*100),this._range.end=Math.floor(100-(i-a)/n*100)}else{if(e=this._startShape.style.y,i=this._endShape.style.y,t.id==this._startShape.id&&e>=i)i=e,this._endShape.style.y=e;else if(t.id==this._endShape.id&&e>=i)e=i,this._startShape.style.y=e;this._fillerShape.style.y=e,this._fillerShape.style.height=i-e,this._startMask.style.height=e-s,this._endMask.style.y=i,this._endMask.style.height=s+h-i,this._range.start=Math.ceil(100-(e-s)/h*100),this._range.end=Math.floor(100-(i-s)/h*100)}this._syncShape()},_syncShape:function(){this._startShape.position=[this._startShape.style.x-this._startShape.style._x,this._startShape.style.y-this._startShape.style._y],this._startShape.style.text=this._textFormat(this._gap*this._range.start+this.dataRangeOption.min),this._startShape.style.color=this._startShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.start+this.dataRangeOption.min),this._endShape.position=[this._endShape.style.x-this._endShape.style._x,this._endShape.style.y-this._endShape.style._y],this._endShape.style.text=this._textFormat(this._gap*this._range.end+this.dataRangeOption.min),this._endShape.style.color=this._endShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.end+this.dataRangeOption.min),this.zr.modShape(this._startShape.id),this.zr.modShape(this._endShape.id),this.zr.modShape(this._startMask.id),this.zr.modShape(this._endMask.id),this.zr.modShape(this._fillerShape.id),this.zr.refresh()},_syncData:function(){if(this.dataRangeOption.realtime)this.messageCenter.dispatch(n.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart)},__dataRangeSelected:function(t){var e=t.target._idx;this._selectedMap[e]=!this._selectedMap[e],this.messageCenter.dispatch(n.EVENT.REFRESH,null,null,this.myChart)},__dispatchHoverLink:function(t){var e,i;if(this.dataRangeOption.calculable){var a,s=this.dataRangeOption.max-this.dataRangeOption.min;if("horizontal"==this.dataRangeOption.orient)a=(1-(o.getX(t.event)-this._calculableLocation.x)/this._calculableLocation.width)*s;else a=(1-(o.getY(t.event)-this._calculableLocation.y)/this._calculableLocation.height)*s;e=a-.05*s,i=a+.05*s}else{var h=t.target._idx;i=(this._colorList.length-h)*this._gap+this.dataRangeOption.min,e=i-this._gap}this.messageCenter.dispatch(n.EVENT.DATA_RANGE_HOVERLINK,t.event,{valueMin:e,valueMax:i},this.myChart)},__onhoverlink:function(t){if(this.dataRangeOption.show&&this.dataRangeOption.hoverLink&&this._indicatorShape&&t&&null!=t.seriesIndex&&null!=t.dataIndex){var e=t.value;if(isNaN(e))return;if(e<this.dataRangeOption.min)e=this.dataRangeOption.min;else if(e>this.dataRangeOption.max)e=this.dataRangeOption.max;if("horizontal"==this.dataRangeOption.orient)this._indicatorShape.position=[(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.width,0];else this._indicatorShape.position=[0,(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.height];this._indicatorShape.style.text=t.value,this._indicatorShape.style.color=this.getColor(e),this.zr.addHoverShape(this._indicatorShape)}},_textFormat:function(t,e){if(t=t.toFixed(this.dataRangeOption.precision),e="undefined"!=typeof e?e.toFixed(this.dataRangeOption.precision):"",this.dataRangeOption.formatter)if("string"==typeof this.dataRangeOption.formatter)return this.dataRangeOption.formatter.replace("{value}",t).replace("{value2}",e);else if("function"==typeof this.dataRangeOption.formatter)return this.dataRangeOption.formatter.call(this.myChart,t,e);if(""!==e)return t+" - "+e;else return t},refresh:function(t){if(t){if(this.option=t,this.option.dataRange=this.reformOption(this.option.dataRange),this.dataRangeOption=this.option.dataRange,!this.myChart.canvasSupported)this.dataRangeOption.realtime=!1;var e=this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?100:this.dataRangeOption.splitNumber;if(this._colorList=r.getGradientColors(this.dataRangeOption.color,Math.max((e-this.dataRangeOption.color.length)/(this.dataRangeOption.color.length-1),0)+1),this._colorList.length>e){for(var i=this._colorList.length,a=[this._colorList[0]],s=i/(e-1),n=1;e-1>n;n++)a.push(this._colorList[Math.floor(n*s)]);a.push(this._colorList[i-1]),this._colorList=a}var h=this.dataRangeOption.precision;for(this._gap=(this.dataRangeOption.max-this.dataRangeOption.min)/e;this._gap.toFixed(h)-0!=this._gap&&5>h;)h++;this.dataRangeOption.precision=h,this._gap=((this.dataRangeOption.max-this.dataRangeOption.min)/e).toFixed(h)-0,this._valueTextList=[];for(var n=0;e>n;n++)this._selectedMap[n]=!0,this._valueTextList.unshift(this._textFormat(n*this._gap+this.dataRangeOption.min,(n+1)*this._gap+this.dataRangeOption.min))}this.clear(),this._buildShape()},getColor:function(t){if(isNaN(t))return null;if(this.dataRangeOption.min==this.dataRangeOption.max)return this._colorList[0];if(t<this.dataRangeOption.min)t=this.dataRangeOption.min;else if(t>this.dataRangeOption.max)t=this.dataRangeOption.max;if(this.dataRangeOption.calculable)if(t-(this._gap*this._range.start+this.dataRangeOption.min)>5e-5||t-(this._gap*this._range.end+this.dataRangeOption.min)<-5e-5)return null;var e=this._colorList.length-Math.ceil((t-this.dataRangeOption.min)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._colorList.length);if(e==this._colorList.length)e--;if(this._selectedMap[e])return this._colorList[e];else return null},getColorByIndex:function(t){if(t>=this._colorList.length)t=this._colorList.length-1;else if(0>t)t=0;return this._colorList[t]},onbeforDispose:function(){this.messageCenter.unbind(n.EVENT.HOVER,this._onhoverlink)}},h.inherits(t,e),require("../component").define("dataRange",t),t}),define("echarts/util/shape/HandlePolygon",["require","zrender/shape/Base","zrender/shape/Polygon","zrender/tool/util"],function(require){function t(t){e.call(this,t)}var e=require("zrender/shape/Base"),i=require("zrender/shape/Polygon"),a=require("zrender/tool/util");return t.prototype={type:"handle-polygon",buildPath:function(t,e){i.prototype.buildPath(t,e)},isCover:function(t,e){var i=this.getTansform(t,e);t=i[0],e=i[1];var a=this.style.rect;if(t>=a.x&&t<=a.x+a.width&&e>=a.y&&e<=a.y+a.height)return!0;else return!1}},a.inherits(t,e),t});