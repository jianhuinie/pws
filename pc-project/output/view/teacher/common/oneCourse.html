{{ *

@file 非老师详情页 - 课程页面 - 课程列表 - 一对一 2017.1.11
@author wangyujie

* }}

{{ if isset($one_course.course) && count($one_course.course) }}
    <div class="one-course-box list">
        <ul class="one-course-list">
        {{ foreach $one_course.course as $key => $val }}
            <li class="item">
                {{ if count($val.price) > 1 }}
                    {{ $min_price = 99999999 }}
                    {{ $max_price = 0 }}

                    {{ foreach $val.price as $v }}
                        {{ if $v && $v > $max_price }}
                            {{ $max_price = $v }}
                        {{ /if }}
                    {{ /foreach }}

                    {{ foreach $val.price as $v }}
                        {{ if $v && $v < $min_price }}
                            {{ $min_price = $v }}
                        {{ /if }}
                    {{ /foreach }}

                    {{ if $min_price != $max_price }}
                        {{ $final_price = "￥"|cat:$min_price|cat:" - ￥"|cat:$max_price|cat:"/小时" }}
                    {{ else }}
                        {{ $final_price = "￥"|cat:$min_price|cat:"/小时" }}
                    {{ /if }}
                {{ else }}
                    {{ foreach $val.price as $v }}
                        {{ if $v }}
                            {{ $final_price = "￥"|cat:$v|cat:"/小时" }}
                        {{ /if }}
                    {{ /foreach }}
                {{ /if }}

                <div class="base-info" {{ if count($one_course.course) == 1 }}style="display:none;"{{ /if }}>
                    <img src="{{ $static_origin }}/asset/img/teacher/course_icon_58c7e4b678.png">
                    {{ $final_name = $val.name|cn_truncate:10 }}
                    <div class="sub-new-title" {{ if $final_name != $val.name }}data-title="{{ $val.name }}"{{ /if }}>
                        <a href="{{ $val.detail_url }}" target="_blank">{{ $final_name }}</a>
                    </div>
                    <a>购买课程</a>
                    <span>{{ $final_price }}</span>
                </div>

                {{ include file="common/variable/lesson.html" scope=parent }}

                {{ $subjectLessonWay = [] }}

                {{ if !empty($val.price.teacher) }}
                    {{ $subjectLessonWay[] = [ 'teacher-'|cat:$val.price.teacher, $lessonMap.teacher|cat:'- ￥'|cat:$val.price.teacher|cat:'/小时', 'teacher', $val.price.teacher ] }}
                {{ /if }}

                {{ if !empty($val.price.student) }}
                    {{ $subjectLessonWay[] = [ 'student-'|cat:$val.price.student, $lessonMap.student|cat:'- ￥'|cat:$val.price.student|cat:'/小时', 'student', $val.price.student ] }}
                {{ /if }}

                {{ if !empty($val.price.discuss) }}
                    {{ $subjectLessonWay[] = [ 'discuss-'|cat:$val.price.discuss, $lessonMap.discuss|cat:'- ￥'|cat:$val.price.discuss|cat:'/小时', 'discuss', $val.price.discuss ] }}
                {{ /if }}

                {{ if !empty($val.price.online) }}
                    {{ $subjectLessonWay[] = [ 'online-'|cat:$val.price.online, $lessonMap.online|cat:'- ￥'|cat:$val.price.online|cat:'/小时', 'online', $val.price.online ] }}
                {{ /if }}

                <div class="detail-info form" data-number="{{ $val.number }}" data-index="{{ $key+1 }}" data-course="{{ $val.id }}"  data-lessonway="{{ $subjectLessonWay[0][2] }}" data-lessonvalue="{{ $subjectLessonWay[0][3] }}" {{ if count($one_course.course) > 1 }}style="display:none;"{{ /if }}>

                    <div class="new-title">
                        <span {{ if $final_name != $val.name }}data-title="{{ $val.name }}"{{ /if }}>
                            <a href="{{ $val.detail_url }}" target="_blank">
                                {{ $final_name }}
                            </a>
                        </span>
                        {{ $final_price }}
                        <a class="packup"{{ if count($one_course) == 1 }}style="display:none;"{{ /if }}>
                            收起购买
                        </a>
                    </div>

                    <div class="professional-intro">
                        <span class="professional-intro-text">专业背景介绍：</span>
                        <div class="professional-intro-detail">
                            {{ $val.remark|regex_replace: "/\\n/": '<br/>' }}
                        </div>
                    </div>

                    <div class="lesson-way">
                        <span class="lesson-way-text">选择上课方式：</span>
                        <div class="dropdown">
                            <span class="btn-default">
                                <i class="caret"></i>
                                <span>{{ $subjectLessonWay[0][1] }}</span>
                            </span>
                            <ul class="dropdown-menu">
                                {{ foreach $subjectLessonWay as $val }}
                                    <li data-value="{{ $val[0] }}">{{ $val[1] }}</li>
                                {{ /foreach }}
                            </ul>
                        </div>
                        <span class="error" style="display:none;">
                            <i class="icon icon-times-circle"></i>
                            &nbsp;请选择上课方式
                        </span>
                    </div>

                    <div class="course-time">
                        <span class="course-time-text">设置课程时长：</span>
                        <a class="set-time custom active">自定义时长</a>
                        <a class="set-time combo">课时优惠包</a>
                    </div>

                    <div class="custom-box form-group">
                        <div class="custom-box-text">填写购买课时：</div>
                        <input name="hours" class="form-text hours" type="int" required min="1" max="999" >
                        <span>小时</span>
                        <span class="form-hint">
                            <i class="icon icon-info-circle"></i>
                            请填写整数（1-999）
                        </span>
                        <span class="error"></span>
                    </div>

                    <div class="course-list-box form-group">
                        <span class="error" style="display:none;">
                            <i class="icon icon-times-circle"></i>
                            &nbsp;请选择课时优惠包
                        </span>
                        <ul class="course-list">
                        </ul>
                    </div>

                    <div class="button-box" >
                        <div class="price">
                            总价：<span class="total-price">￥0</span>
                        </div>
                        <div class="stage-pay">
                            分期购买
                        </div>
                        <button class="btn btn-primary {{ if !$profile.can_order }}disabled-order{{ /if }}" {{ if !$profile.can_order }}disabled{{ /if }}>
                            购买课时
                        </button>
                    </div>
                </div>
            </li>
        {{ /foreach }}
        </ul>

        {{ include "teacher/newDetail/calendar.html" }}
    </div>
{{ /if }}