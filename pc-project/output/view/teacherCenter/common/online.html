{{ if !empty($val.detail_url) }}
    {{ $course_url = $val.detail_url }}
{{ else if $val.course_type == 4 }}
    {{ $course_url = '/org_class_course/detail/'|cat:$val.number }}
{{ else }}
    {{ $course_url = '/teacher/classCourseDetail/'|cat:$val.number }}
{{ /if }}
{{ $profile = $tpl_data.profile }}

<div class="course-item">
    <a class="course-link" href="{{ $course_url }}" target="_blank">
        <img src="{{ $val.cover_url }}@1e_200w_112h_1c_0i_1o_90Q_1x" alt="{{ $val.name }}-{{ $profile.name }}">
        {{ if !empty($val.discount) && $val.discount }}
            <span class="icon icon_zhekou">
                {{ if $val.discount.type == 1 }}
                    限额折扣
                {{ else if $val.discount.type == 2 }}
                    限时折扣
                {{ /if }}
            </span>
        {{ /if }}
    </a>

    <ul class="course-item-info">
        {{ $course_name = $val.name|cn_truncate:20 }}
        <li class="course-title">
            <a class="title" href="{{ $course_url }}" target="_blank" {{ if $course_name != $val.name }}data-title = "{{ $val.name|escape }}"{{ /if }}>
            <span class="course-lesson-way">直播课</span>
            {{ $course_name }}
            </a>
            {{ if $val.fenqi }}
                <span class="fenqi_tag">{{ $val.fenqi.tag_name }}</span>
            {{ /if }}
        </li>
        {{ *课程安排* }}
        {{ $arrange = $val.arrangement|cn_truncate:25 }}
        <li class="course-time" {{ if $arrange != $val.arrangement }} data-title="{{ $val.arrangement }}" data-width="20em"{{ /if }}>
            {{ $arrange }}
        </li>

        {{ if $val.course_type != 4 }}
        {{ $course_length = $val.course_len/3600 }}
        <li class="course-time">共
        {{ if $course_length == abs(floor($course_length)) }}
            {{ $course_length }}课时
        {{ else }}
            {{ abs(($val.course_len/3600))|number_format: 1 }}课时
        {{ /if }}
        {{ if $val.lesson_way == 2 }}
            {{ if $val.class_type == 1 }}
            （支持手机观看）
            {{ else }}
            （支持手机APP观看）
            {{ /if }}
        {{ /if }}
        </li>
        {{ /if }}

        <li class="course-time">
            {{ if $val.total_pay != 0 }}
            {{ $val.total_pay }}人报名
            {{ else }}
            班级共{{ $val.max_student }}人
            {{ /if }}
        </li>
    </ul>

    {{ $show_zhekou = false }}
    {{ if !empty($val.discount) && $val.discount }}

        {{ if $val.discount.type == 1 }}
            {{ * 限额折扣 活动中提醒 * }}
            {{ $show_zhekou = true }}
            {{ $remain_amount = $val.discount.remain_amount }}
            {{ $class = "price-tip-end" }}
            {{ $price = $val.discount.discount_price }}
            {{ $price_no = $val.discount.pre_price }}
        {{ else if $val.discount.type == 2 }}
            {{ $cur_time = $smarty.now }}
            {{ $start_time = strtotime($val.discount.start_time) }}
            {{ $end_time = strtotime($val.discount.end_time) }}
            {{ if ($start_time - $cur_time) < (24*60*60) && ($start_time - $cur_time > 0) }}
                {{ * 活动开始前提醒 * }}
                {{ $show_zhekou = true }}
                {{ $time = ($start_time - $cur_time) }}
                {{ $class = "price-tip-begin" }}
                {{ $price = $val.discount.pre_price }}
                {{ $price_no = $val.discount.discount_price }}
            {{ else if ($start_time < $cur_time) && ($cur_time < $end_time) }}
                {{ * 距离活动结束提醒 * }}
                {{ $show_zhekou = true }}
                {{ $time = ($end_time - $cur_time) }}
                {{ $class = "price-tip-end" }}
                {{ $price = $val.discount.discount_price }}
                {{ $price_no = $val.discount.pre_price }}
            {{ /if }}
        {{ /if }}
    {{ /if }}

    {{ $canchaban = false }}
    {{ if $val.display_status == 5 && $val.can_chaban && !$val.is_full && !$show_zhekou }}
        {{ $canchaban = true }}
        {{ if $val.chaban_price }}
            {{ $price = $val.chaban_price }}
        {{ else }}
            {{ $price = $val.realtime_price }}
        {{ /if }}
        {{ $price_no = $val.original_price }}
    {{ /if }}

    <div class="course-price">
        {{ if $show_zhekou && $val.discount.type == 1 }}
            <span class="price">
                ￥{{ $price }}
            </span>
            <span class="not-price">
                ￥{{ $price_no }}
            </span>
        {{ else if $show_zhekou && $val.discount.type == 2 && !empty($time) }}
            {{ if $class == "price-tip-begin" }}
                <span>￥{{ $price }}</span>

                <span class="cheap-price">
                    抢购价:￥{{ $price_no }}
                </span>
            {{ else if $class == "price-tip-end" }}
                <span>￥{{ $price }}</span>

                <span class="not-price">
                    ￥{{ $price_no }}
                </span>
            {{ else }}
                <span>￥{{ $price }}</span>
                {{ if !empty($price_no) }}
                    <span class="not-price">￥{{ $price_no }}</span>
                {{ /if }}
            {{ /if }}
        {{ else if $canchaban }}
            {{ if $price != null }}
                <span>￥{{ $price }}</span>
            {{ else }}
                <span class="free">免费</span>
            {{ /if }}
            {{ if $price_no != null }}
                <span class="not-price">
                    ￥{{ $price_no }}
                </span>
            {{ /if }}
        {{ else }}
            {{ if $val.price == 0 || $val.price == "0.00" }}
                <span class="free">免费</span>
            {{ else }}
                <span>￥{{ $val.price }}</span>
            {{ /if }}
        {{ /if }}
    </div>
    <div class="course-button">
        {{ $display_status = $val.display_status }}
        {{ **如果审核未通过则状态置为暂停招生** }}
        {{ if $val.verify_status == 2 }}
            {{ $display_status = 3 }}
        {{ /if }}

        {{ if $display_status == 2 }}
            {{ if $val.max_student <= $val.total_pay }}
                {{ if $val.discount.type == 1 && $show_zhekou }}
                    <span class="limit-discount {{ $class }}">
                        限额折扣：剩余
                        <em class="text-error">{{ $remain_amount }}</em>
                        个优惠名额
                    </span>
                {{ else if $val.discount.type == 2 && $show_zhekou && !empty($time) }}
                    <span class="limit-discount {{ $class }}" data-cur="{{ $cur_time }}" data-start="{{ $start_time }}" data-end="{{ $end_time }}">
                        {{ if $class == "price-tip-begin" }}
                            距抢购开始:
                        {{ else if $class == "price-tip-end" }}
                            距抢购结束:
                        {{ /if }}
                        <span class="time">
                            {{ include file='common/component/countDown.html' time=$time }}</span>
                        </span>
                {{ else }}
                    <span>还有机会，其中<i>{{ $val.total_pay-$val.succ_pay }}</i>人待付款</span>
                {{ /if }}
                <a target="_blank" href="{{ $course_url }}" class="btn btn-default">
                    立即报名
                </a>
            {{ else }}
                {{ if $val.discount.type == 1 && $show_zhekou }}
                    <span class="limit-discount {{ $class }}">
                        限额折扣：剩余
                        <em class="text-error">{{ $remain_amount }}</em>
                        个优惠名额
                    </span>
                {{ else if $val.discount.type == 2 && $show_zhekou && !empty($time) }}
                    <span class="limit-discount {{ $class }}" data-cur="{{ $cur_time }}" data-start="{{ $start_time }}" data-end="{{ $end_time }}">
                        {{ if $class == "price-tip-begin" }}
                            距抢购开始:
                        {{ else if $class == "price-tip-end" }}
                            距抢购结束:
                        {{ /if }}
                        <span class="time">
                            {{ include file='common/component/countDown.html' time=$time }}
                        </span>
                    </span>
                {{ /if }}
                <a target="_blank" href="{{ $course_url }}" class="btn btn-primary reserve-course {{ if !$profile.can_order }}disabled-order{{ /if }}" data-coursenum="{{ $val.number }}" {{ if !$profile.can_order }}disabled{{ /if }}>
                    立即报名
                </a>
            {{ /if }}
        {{ else if $display_status == 3 }}
            <a target="_blank" href="{{ $course_url }}" class="btn btn-default">暂停招生</a>
        {{ else if $display_status == 4 }}
            <span>满班可以联系老师增加名额</span>
            <a target="_blank" href="{{ $course_url }}" class="btn btn-default">已满班</a>
        {{ else if $display_status == 5 }}
            {{ if $val.can_chaban }}
                {{ if $val.is_full }}
                    <span>
                        课程已开始，可联系老师增加名额插班
                    </span>
                    <a target="_blank" href="{{ $course_url }}" class="btn btn-default">
                        进行中
                    </a>
                {{ else if $show_zhekou }}
                    <a target="_blank" href="{{ $course_url }}" class="btn btn-primary reserve-course {{ if !$profile.can_order }}disabled-order{{ /if }}" data-coursenum="{{ $val.number }}" {{ if !$profile.can_order }}disabled{{ /if }}>
                        立即报名
                    </a>
                {{ else }}
                    <a target="_blank" href="{{ $course_url }}" class="btn btn-primary reserve-course {{ if !$profile.can_order }}disabled-order{{ /if }}" data-coursenum="{{ $val.number }}" {{ if !$profile.can_order }}disabled{{ /if }}>
                        立即插班
                    </a>
                {{ /if }}
            {{ else }}
                <a target="_blank" href="{{ $course_url }}" class="btn btn-default">进行中</a>
            {{ /if }}
        {{ else if $display_status == 6 }}
        <a target="_blank" href="{{ $course_url }}" class="btn btn-default">已完成</a>
        {{ else if $display_status == 8 }}
        <a target="_blank" href="{{ $course_url }}" class="btn btn-default">审核中</a>
        {{ else if $display_status == 12 }}
        <a target="_blank" href="{{ $course_url }}" class="btn btn-default">已失效</a>
        {{ else if $display_status == 13 }}
        <a target="_blank" href="{{ $course_url }}" class="btn btn-default">已完成</a>
        {{ /if }}
    </div>


</div>