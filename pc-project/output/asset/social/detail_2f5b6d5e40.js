define('cobble/form/Text',['require','exports','../helper/Input','../helper/Placeholder','../function/init','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return a.init(this,e);}var t=require('../helper/Input'),i=require('../helper/Placeholder'),n=require('../function/init'),o=require('../function/jquerify'),a=require('../function/lifeCycle');return e.prototype={constructor:e,type:'Text',init:function(){var e=this,n=e.element;e.placeholder=new i({element:n,simple:e.placeholderSimple,nativeFirst:e.placeholderNativeFirst,placeholderSelector:e.placeholderSelector,template:e.template});var o=e.action;if(o)$.each(o,function(t,i){o[t]=$.proxy(i,e);});e.input=new t({element:n,onChange:function(t){e.emit(t);},onKeyDown:function(t){e.emit(t);},action:o});},getValue:function(){return $.trim(this.element.val());},setValue:function(e,t){var i=this;if(t=t||{},t.force||i.getValue()!==e){if(i.element.val(e),i.placeholder)i.placeholder.refresh();if(!t.silence)i.emit('change');}},dispose:function(){var e=this;a.dispose(e),e.input.dispose(),e.placeholder.dispose(),e.element=e.input=e.placeholder=null;}},o(e.prototype),e.defaultOptions={simple:!1,nativeFirst:!0,placeholderSelector:'.placeholder',template:'<div class="placeholder-wrapper"><div class="placeholder"></div></div>'},e.init=n(e),e;}),define('cobble/form/Validator',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return o.init(this,e);}function t(e,t){if(e.length>0){var i=e[0].element;if(i.is(':hidden'))i=i.parent();var n=i.offset().top;if(t>0)n-=t;window.scrollTo(window.scrollX,n);}}function i(e){var t=$.Deferred();return $.when.apply($,e).done(function(){t.resolve(arguments);}),t;}var n=require('../function/jquerify'),o=require('../function/lifeCycle');e.prototype={constructor:e,type:'Validator',init:function(){var t=this,i=t.element,n='FORM'===i.prop('tagName')?i:i.find('form');if(n.length>0)n.attr('novalidate','novalidate').on('submit'+r,$.proxy(t.validate,t));$.each(t.fields,function(t,n){var o=i.find('[name="'+t+'"]'),r=n.type;if(!r)r=n.type=o.attr('type')||'text';var s=n.rules;if(!s)s=n.rules={};var c=e.type[r]||[];$.each(c,function(e,t){if(null==s[t]){var i=a[t];if($.isFunction(i))s[t]=i(o,n);}});});var o=t.groupSelector;if(i.on('focusin'+r,function(e){var i=$(e.target).closest(o),n=[t.successClass,t.errorClass,t.requiredClass].join(' ');i.removeClass($.trim(n));}),t.realtime)i.on('focusout'+r,function(e){var i=$(e.target),n=i.prop('name');if(!n)i=i.find('[name]'),n=i.prop('name');if(n)t.validate(n);});},validate:function(e,n){var o=this,a=o.emit('beforeValidate');if(!a.isDefaultPrevented()){var r,s=o.element,c=o.groupSelector;if('string'===$.type(e))e=[e];if($.isArray(e))r=$.map(e,function(e){return s.find('[name="'+e+'"]').closest(c);});else if(r=s.find(c),'boolean'===$.type(e))n=e;var l=[],u=[];$.each(r,function(e,t){var i=o.validateGroup($(t));if(i){if(i.promise)u.push(i),i=i.data;$.merge(l,i);}});var e=[],p=[],f=function(){if($.each(l,function(t,i){if(i.error)p.push(i);e.push(i.element.prop('name'));}),n)t(p,o.scrollGap);o.emit('afterValidate',{fields:e,errors:p});};if(u.length>0)return i(u).done(f);else return f(),0===p.length;}},validateGroup:function(t){if(t.is(':visible')){var n=this,o=[],a=[],r=[];if(t.find('[name]').each(function(t){var i,s,c=this,l=c.name,u=c.value,p=c.disabled,f=$(c);if(!p){var d=n.fields[l];if(d){i=!0,d=$.extend(!0,{},d),d.form=n.element,d.value=$.trim(u);var m;if($.each(e.type[d.type]||[],function(t,i){var n=e.rule[i](d);if(n===!1)return m=i,!1;else if(''===d.value&&'required'===i)return!1;}),m){var h=d.errors;if(h)s=h[m];if(!s)throw new Error(l+' 字段 '+m+' 类型错误信息未定义');}else if($.isFunction(d.custom)){var v=$.Deferred(),g=d.custom(f,function(e){v.resolve(e);});s=null==g||g.done?v:g;}}}if(i)if(t=o.push({element:f,error:s}),s&&s.promise)a.push(s),r.push(t-1);}),a.length>0){var s=i(a).done(function(e){$.each(e,function(e,t){o[r[e]].error=t;}),n.refreshGroup(t,o);});return s.data=o,s;}else return n.refreshGroup(t,o),o;}},refreshGroup:function(e,t){var i=this,n=i.successClass,o=i.errorClass;$.each(t,function(t,a){var r,s=a.element,c=a.error,l=i.errorSelector;if(l)r=e.find(l).eq(t);if(c&&'string'===$.type(c)){if(e.removeClass(n).addClass(o),r){var u=i.renderTemplate;if($.isFunction(u))c=u({text:c},i.errorTemplate);r.html(c).show();var p=i.errorPlacement;if($.isFunction(p))p(s,r);}}else if(a.error='',e.removeClass(o).addClass(n),r)r.html('').hide();});},dispose:function(){var e=this;o.dispose(e),e.element.off(r),e.element=null;}},n(e.prototype),e.defaultOptions={realtime:!1,scrollGap:100,groupSelector:'.form-group',successClass:'has-success',errorClass:'has-error',errorSelector:'.error',errorTemplate:'<i class="icon icon-times-circle"></i>&nbsp;${text}',requiredClass:'has-required',requiredSelector:'.required',requiredTemplate:'${text}',renderTemplate:function(e,t){return t.replace(/\${(\w+)}/g,function(t,i){return e[i]||'';});},errorPlacement:function(e,t){if('hidden'===e.prop('type'))e=e.parent();t.css({position:'static',width:'auto'});var i=t.outerWidth(!0)+5;t.css({position:'absolute',width:i});var n=e.parent();if(n.is('.placeholder-wrapper'))e=n;var o=e.position();t.css({left:o.left+e.outerWidth()-37,top:o.top-t.outerHeight()+8});}},e.type={text:['required','pattern','min','max','minlength','maxlength'],hidden:['required'],password:['required','pattern','minlength','maxlength','equals'],number:['required','pattern','min','max','step'],range:['required','pattern','min','max','step'],tel:['required','pattern'],url:['required','pattern'],email:['required','pattern'],mobile:['required','pattern'],money:['required','pattern','min','max'],idcard:['required','pattern'],'int':['required','pattern','min','max'],internationalMobile:['required','pattern']},e.rule={required:function(e){if(e.value.length>0)return!0;else if(e.rules.required)return!1;},pattern:function(e){var t=e.rules.pattern;if(t)return t.test(e.value);else return void 0;},minlength:function(e){var t=e.rules.minlength;if($.isNumeric(t))return e.value.length>=+t;else return void 0;},maxlength:function(e){var t=e.rules.maxlength;if($.isNumeric(t))return e.value.length<=+t;else return void 0;},min:function(e){var t=e.rules.min;if($.isNumeric(t))return e.value>=+t;else return void 0;},max:function(e){var t=e.rules.max;if($.isNumeric(t))return e.value<=+t;else return void 0;},step:function(e){var t=e.rules.step;if($.isNumeric(t)){var i=e.rules.min||1;return(e.value-i)%t===0;}},equals:function(e){var t=e.rules.equals;if(t){var i=e.form.find('[name="'+t+'"]');return e.value===$.trim(i.val());}}},e.pattern={number:/^[\d.]*$/,'int':/^\d+$/,url:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,tel:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,mobile:/^1[3-9]\d{9}$/,email:/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,money:/^[\d.]*$/,idcard:/(^\d{15}$)|(^\d{17}([0-9]|X)$)/i,internationalMobile:/^\d{7,20}$/};var a={required:function(e){return'required'===e.attr('required');},pattern:function(t,i){var n=t.attr('pattern')||e.pattern[i.type];if('string'===$.type(n))n=new RegExp(n);return n;},minlength:function(e){return e.attr('minlength');},maxlength:function(e){return e.attr('maxlength');},min:function(e){return e.attr('min');},max:function(e){return e.attr('max');},step:function(e){return e.attr('step');},equals:function(e){return e.attr('equals');}},r='.cobble_form_validator';return e;}),define('cobble/function/around',['require','exports','module'],function(){'use strict';return function(e,t,i,n){var o='string'===$.type(t),a=o?e[t]:e;if(!o)n=i,i=t;var r=function(){var e,t=arguments;if($.isFunction(i))e=i.apply(this,t);if(e!==!1){if($.isFunction(a))e=a.apply(this,t);if($.isFunction(n)){var o=n.apply(this,t);if('undefined'!==$.type(o))e=o;}return e;}};return o?e[t]=r:r;};}),define('cobble/function/call',['require','exports','module'],function(){'use strict';return function(e,t,i){if($.isFunction(e)){var n=$.isArray(i)?'apply':'call';return e[n](t,i);}};}),define('cobble/function/contains',['require','exports','module'],function(){'use strict';return function(e,t){if(e=e.jquery?e[0]:e,t=t.jquery?t[0]:t,!e||!t)return!1;if(e===t)return!0;else return $.contains(e,t);};}),define('cobble/function/debounce',['require','exports','module'],function(){'use strict';return function(e,t){t='number'===$.type(t)?t:50;var i;return function(){if(!i){var n=arguments;i=setTimeout(function(){i=null,e.apply(null,$.makeArray(n));},t);}};};}),define('cobble/function/decimalLength',['require','exports','module'],function(){'use strict';return function(e){var t=(''+e).split('.');return 2===t.length?t[1].length:0;};}),define('cobble/function/disableSelection',['require','exports','module'],function(){'use strict';var e=$('<i></i>')[0],t='onselectstart'in e,i='MozUserSelect'in e.style;if(e=null,t)return function(e){e=e||document,e.onselectstart=function(){return!1;};};if(i)return function(e){e=e||document.body,e.style.MozUserSelect='none';};else return $.noop;}),define('cobble/function/divide',['require','exports','module','./decimalLength','./float2Int'],function(require){'use strict';var e=require('./decimalLength'),t=require('./float2Int');return function(i,n){var o=Math.max(e(i),e(n));return i=t(i,o),n=t(n,o),i/n;};}),define('cobble/function/dragGlobal',['require','exports','module','../helper/Draggable','../util/instance','../util/dimension','./pin'],function(require){'use strict';{var e=require('../helper/Draggable'),t=require('../util/instance'),i=require('../util/dimension');require('./pin');}return function(n){return new e({element:n.element,container:t.body,draggingClass:n.draggingClass,handleSelector:n.handleSelector,cancelSelector:n.cancelSelector,rect:function(){var e=n.fixed,t=n.scrollable;return{x:e||t?0:i.getPageScrollLeft(),y:e||t?0:i.getPageScrollTop(),width:e||!t?i.getViewportWidth():i.getPageWidth(),height:e||!t?i.getViewportHeight():i.getPageHeight()};}});};}),define('cobble/function/enableSelection',['require','exports','module'],function(){'use strict';var e=$('<i></i>')[0],t='onselectstart'in e,i='MozUserSelect'in e.style;if(e=null,t)return function(e){e=e||document,e.onselectstart=null;};if(i)return function(e){e=e||document.body,e.style.MozUserSelect='';};else return $.noop;}),define('cobble/function/float2Int',['require','exports','module'],function(){'use strict';return function(e,t){var i,n=(''+e).split('.');if(t>=0);else t=0;if(1===n.length)i=e+new Array(t+1).join('0');else t=Math.max(0,t-n[1].length),i=n.join('')+new Array(t+1).join('0');return+i;};}),define('cobble/function/imageDimension',['require','exports','module'],function(){'use strict';var e=[];return function(t,i){var n=new Image(),o=e.push(n);n.onload=function(){var t=n.height;if(null!=t&&t>0)i(n.width,t),delete e[o-1],n=null;else setTimeout(n.onload,10);},n.src=t;};}),define('cobble/function/init',['require','exports','module'],function(){'use strict';return function(e){return function(t,i){var n=[];return t.each(function(){n.push(new e($.extend({element:$(this)},i)));}),n;};};}),define('cobble/function/innerOffset',['require','exports','module','./toNumber'],function(require){'use strict';var e=require('./toNumber');return function(t){var i=t.offset(),n=t.css('border-left-width'),o=t.css('border-top-width');return{left:i.left+e(n,0,'int'),top:i.top+e(o,0,'int')};};}),define('cobble/function/isHidden',['require','exports','module'],function(){'use strict';return function(e){e.css('display');return'none'===e.css('display')||0==e.css('opacity')||'hidden'===e.css('visibility');};}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var t=$.prototype,i={on:function(){return t.on.apply(e(this),arguments),this;},off:function(){return t.off.apply(e(this),arguments),this;},emit:function(i,n){var o=this,a=e(o);if(a){if(!i[$.expando])i='string'===$.type(i)?$.Event(i):$.Event(null,i);i.cobble=o;var r=[i];if(n)r.push(n);var s=o[$.camelCase('on-'+i.type)];if($.isFunction(s)&&s.apply(o,r)===!1)i.preventDefault();if(!i.isPropagationStopped())t.trigger.apply(a,r);return i;}},before:function(t){e(this).before(t);},after:function(t){e(this).after(t);},appendTo:function(t){e(this).appendTo(t);},prependTo:function(t){e(this).prependTo(t);}};return function(e){$.each(i,function(t,i){if(null==e[t])e[t]=i;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,t){var i=e.constructor,n='__cobble__'+i.prototype.type,o=t.element;if(o&&o.data(n))e=o.data(n);else if($.extend(e,i.defaultOptions,t),e.init(),o)o.data(n,e);return e;},exports.dispose=function(e){var t='__cobble__'+e.constructor.prototype.type,i=e.element;if(i)i.removeData(t);};}),define('cobble/function/offsetParent',['require','exports','module'],function(){'use strict';function e(e){return e.is('body')||'static'!==e.css('position');}return function(t){if(t.is('body'))return t;for(var i=t.parent();!e(i);)i=i.parent();return i;};}),define('cobble/function/outerOffset',['require','exports','module','./toNumber'],function(require){'use strict';var e=require('./toNumber');return function(t){var i=t.offset(),n=e(t.css('margin-left'),0,'int'),o=e(t.css('margin-top'),0,'int');return{left:i.left-n,top:i.top-o};};}),define('cobble/function/page',['require','exports','module','../util/instance'],function(require){'use strict';var e=require('../util/instance');return function(){if(e.body.prop('clientHeight')<e.html.prop('clientHeight'))return e.html;else return e.body;};}),define('cobble/function/pageHeight',['require','exports','module','./page'],function(require){'use strict';var e=require('./page');return function(){var t=e()[0];return Math.max(t.scrollHeight,t.clientHeight);};}),define('cobble/function/pageScrollLeft',['require','exports','module'],function(){'use strict';return function(){return Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);};}),define('cobble/function/pageScrollTop',['require','exports','module'],function(){'use strict';return function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop);};}),define('cobble/function/pageWidth',['require','exports','module','./page'],function(require){'use strict';var e=require('./page');return function(){var t=e()[0];return Math.max(t.scrollWidth,t.clientWidth);};}),define('cobble/function/parsePercent',['require','exports','module','./divide'],function(require){'use strict';var e=require('./divide'),t=/(-?\d+(\.\d+)?)%/;return function(i){if(t.test(i))return e(RegExp.$1,100);else return void 0;};}),define('cobble/function/pin',['require','exports','module','../util/instance','./parsePercent'],function(require){'use strict';function e(e){var t=o[e.x];if(null==t)t=e.x;if('string'===$.type(t)){var i=n(t);if(null!=i)t=i*(e.width||e.element.outerWidth());}return t;}function t(e){var t=o[e.y];if(null==t)t=e.y;if('string'===$.type(t)){var i=n(t);if(null!=i)t=i*(e.height||e.element.outerHeight());}return t;}var i=require('../util/instance'),n=require('./parsePercent'),o={left:0,top:0,center:'50%',middle:'50%',right:'100%',bottom:'100%'};return function(n){var o=n.element,a=n.attachment||{};if(!a.element)a.element=i.body;var r=a.element.offset(),s=r.left+e(a),c=r.top+t(a),l=s-e(n),u=c-t(n),p=n.offset;if(p){if('number'===$.type(p.x))l+=p.x;if('number'===$.type(p.y))u+=p.y;}var f={left:l,top:u},d=o.css('position');if('absolute'!==d&&'fixed'!==d)f.position='absolute';if(n.silence)return f;else o.css(f);};}),define('cobble/function/pinGlobal',['require','exports','module','./pin','../util/dimension','../function/viewport'],function(require){'use strict';var e=require('./pin'),t=require('../util/dimension'),i=require('../function/viewport');return function(n){var o={silence:!0,element:n.element,x:'50%'===n.x?'50%':0,y:'50%'===n.y?'50%':0,attachment:{element:i(),width:t.getViewportWidth(),height:t.getViewportHeight(),x:n.x,y:n.y}};if(!n.fixed)o.offset={x:t.getPageScrollLeft(),y:t.getPageScrollTop()};return e(o);};}),define('cobble/function/position',['require','exports','module','./offsetParent'],function(require){'use strict';var e=require('./offsetParent');return function(t){var i=e(t),n=t.css('position'),o=parseInt(t.css('left'),10),a=parseInt(t.css('top'),10),r=isNaN(o),s=isNaN(a);if(r||s)if(1===i.length){var c=t.offset(),l=i.offset();if(r)o=c.left-l.left-(parseInt(i.css('border-left-width'),10)||0);if(s)a=c.top-l.top-(parseInt(i.css('border-top-width'),10)||0);}else o=a=0;if(!n||'static'===n)n='absolute';return{position:n,left:o,top:a};};}),define('cobble/function/replaceWith',['require'],function(){'use strict';return function(e,t){e=e[0],t=t[0],e.parentNode.replaceChild(t,e);};}),define('cobble/function/restrain',['require','exports','module'],function(){'use strict';return function(e,t,i){if(t>e)e=t;else if(e>i)e=i;return e;};}),define('cobble/function/split',['require','exports','module'],function(){'use strict';return function(e,t){var i=[];return $.each(e.split(t),function(e,t){if(t=$.trim(t))i.push(t);}),i;};}),define('cobble/function/toNumber',['require','exports','module'],function(){'use strict';var e={'int':parseInt,'float':parseFloat};return function(t,i,n){if('number'!==$.type(t)){var o=e[n];if(t=o?o(t,10):+t,isNaN(t))t=i;}return t;};}),define('cobble/function/viewport',['require','exports','module','../util/instance'],function(require){'use strict';var e=require('../util/instance');return function(){if(e.body.prop('clientHeight')>e.html.prop('clientHeight'))return e.html;else return e.body;};}),define('cobble/function/viewportHeight',['require','exports','module'],function(){'use strict';return function(){return window.innerHeight||document.documentElement.clientHeight;};}),define('cobble/function/viewportWidth',['require','exports','module'],function(){'use strict';return function(){return window.innerWidth||document.documentElement.clientWidth;};}),define('cobble/helper/AjaxUploader',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return l.init(this,e);}function t(e,t){var i=new FormData();$.each(e.data,function(e,t){i.append(e,t);}),i.append(e.fileName,t.nativeFile),t.xhr.send(i);}function i(t,i){var n=i.nativeFile,o=i.file.size,a=i.chunk;if(!a)a=i.chunk={index:0,uploaded:0};var r=a.index,s=t.chunkSize,c=s*r,l=s*(r+1);if(l>o)l=o;if(a.uploading=l-c,a.uploading<=0)return void setTimeout(function(){t.emit('uploadError',{fileItem:i,errorCode:e.ERROR_CHUNK_SIZE});});var u='bytes '+(c+1)+'-'+l+'/'+o,p=i.xhr;p.setRequestHeader('Content-Type',''),p.setRequestHeader('X_FILENAME',encodeURIComponent(n.name)),p.setRequestHeader('Content-Range',u),p.send(n.slice(c,l));}function n(t,i){var n=i.xhr;if(n)$.each(f,function(e,t){n['on'+t.type]=null;}),$.each(d,function(e,t){n.upload['on'+t.type]=null;}),delete i.xhr;if(t.emit('uploadComplete',{fileItem:i}),i.status===e.STATUS_UPLOAD_SUCCESS||i.status===e.STATUS_UPLOAD_ERROR&&t.ignoreError){var a=i.index+1;if(a<t.fileQueue.files.length)t.fileQueue.index=a,t.upload();else o(t,[]);}}function o(t,i){var n=t.fileQueue;n.index=0,n.files=$.map(i,function(t,i){return{index:i,file:s(t),nativeFile:t,status:e.STATUS_WAITING};});}function a(e){var t=e.fileQueue,i=t.index;if(t.files&&'number'===$.type(i))return t.files[i];else return void 0;}function r(e){var t=[];return $.each(e,function(e,i){if(p[i])t.push(p[i]);}),$.unique(t).join(',');}function s(e){var t=e.name,i=t.split('.'),n=i.length>0?i.pop().toLowerCase():'';return{name:t,type:n,size:e.size};}var c=require('../function/jquerify'),l=require('../function/lifeCycle');e.prototype={constructor:e,type:'AjaxUploader',init:function(){var e=this;e.fileQueue={};var t=e.element;if(!t.is(':file'))throw new Error('AjaxUploader element must be <input type="file" />');var i=e.faker=$('<form></form>');t.replaceWith(i),i.append(t);var n={};if(e.accept)n.accept=r(e.accept);if(e.multiple)n.multiple=!0;t.prop(n),t.on('change'+u,function(){o(e,t.prop('files')),e.emit('fileChange');}),e.emit('ready');},getFiles:function(){return this.fileQueue.files||[];},setAction:function(e){this.action=e;},setData:function(e){$.extend(this.data,e);},reset:function(){this.faker[0].reset();},upload:function(n){var o=this,r=o.useChunk?e.STATUS_UPLOADING:e.STATUS_WAITING;if(n=n||a(o),n&&!(n.status>r)){var s=new XMLHttpRequest();if(o.xhrProps)$.extend(s,o.xhrProps);n.xhr=s,$.each(f,function(e,t){s['on'+t.type]=function(e){t.handler(o,e);};}),$.each(d,function(e,t){s.upload['on'+t.type]=function(e){t.handler(o,e);};}),s.open('post',o.action,!0);var c=o.useChunk?i:t;c(o,n);}},stop:function(){var t=this,i=a(t);if(i&&i.status===e.STATUS_UPLOADING)i.xhr.abort();t.reset();},enable:function(){this.element.prop('disabled',!1);},disable:function(){this.element.prop('disabled',!0);},dispose:function(){var e=this;l.dispose(e),e.stop(),e.element.off(u),e.faker=e.element=e.fileQueue=null;}},c(e.prototype),e.defaultOptions={data:{},multiple:!1,fileName:'Filedata',ignoreError:!1},e.supportChunk='undefined'!=typeof FileReader,e.STATUS_WAITING=0,e.STATUS_UPLOADING=1,e.STATUS_UPLOAD_SUCCESS=2,e.STATUS_UPLOAD_ERROR=3,e.ERROR_CANCEL=0,e.ERROR_CHUNK_SIZE=-1;var u='.cobble_helper_ajaxuploader',p={html:'text/html',htm:'text/html',shtml:'text/html',xml:'text/xml',css:'text/css',js:'application/x-javascript',json:'application/json',atom:'application/atom+xml',rss:'application/rss+xml',mml:'text/mathml',txt:'text/plain',jad:'text/vnd.sun.j2me.app-descriptor',wml:'text/vnd.wap.wml',htc:'text/x-component',jpg:'image/jpeg',jpeg:'image/jpeg',png:'image/png',gif:'image/gif',tif:'image/tiff',tiff:'image/tiff',wbmp:'image/vnd.wap.wbmp',ico:'image/x-icon',jng:'image/x-jng',bmp:'image/x-ms-bmp',svg:'image/svg+xml',svgz:'image/svg+xml',webp:'image/webp',mp3:'audio/mpeg',wma:'audio/x-ms-wma',wav:'audio/x-wav',mid:'audio/midi',midd:'audio/midi',kar:'audio/midi',ogg:'audio/ogg',m4a:'audio/x-m4a',ra:'audio/x-realaudio',ram:'audio/x-pn-realaudio',mod:'audio/mod','3gp':'video/3gpp','3gpp':'video/3gpp',mp4:'video/mp4',mpeg:'video/mpeg',mpg:'video/mpeg',mov:'video/quicktime',webm:'video/webm',flv:'video/x-flv',m4v:'video/x-m4v',mng:'video/x-mng',asx:'video/x-ms-asf',asf:'video/x-ms-asf',wmv:'video/x-ms-wmv',avi:'video/x-msvideo',rm:'video/vnd.rn-realvideo',rmvb:'video/vnd.rn-realvideo',ts:'video/MP2T',dv:'video/x-dv',mkv:'video/x-matroska',jar:'application/java-archive',war:'application/java-archive',ear:'application/java-archive',hqx:'application/mac-binhex40',pdf:'application/pdf',ps:'application/postscript',eps:'application/postscript',ai:'application/postscript',rtf:'application/rtf',wmlc:'application/vnd.wap.wmlc',kml:'application/vnd.google-earth.kml+xml',kmz:'application/vnd.google-earth.kmz','7z':'application/x-7z-compressed',cco:'application/x-cocoa',jardiff:'application/x-java-archive-diff',jnlp:'application/x-java-jnlp-file',run:'application/x-makeself',pl:'application/x-perl',pm:'application/x-perl',prc:'application/x-pilot',pdb:'application/x-pilot',rar:'application/x-rar-compressed',rpm:'application/x-redhat-package-manager',sea:'application/x-sea',swf:'application/x-shockwave-flash',sit:'application/x-stuffit',tcl:'application/x-tcl',tk:'application/x-tcl',der:'application/x-x509-ca-cert',pem:'application/x-x509-ca-cert',crt:'application/x-x509-ca-cert',xpi:'application/x-xpinstall',xhtml:'application/xhtml+xml',zip:'application/zip',bin:'application/octet-stream',exe:'application/octet-stream',dll:'application/octet-stream',deb:'application/octet-stream',dmg:'application/octet-stream',eot:'application/octet-stream',iso:'application/octet-stream',img:'application/octet-stream',msi:'application/octet-stream',msp:'application/octet-stream',msm:'application/octet-stream',doc:'application/msword',xls:'application/vnd.ms-excel',ppt:'application/vnd.ms-powerpoint',docx:'application/vnd.openxmlformats-officedocument.wordprocessingml.document',xlsx:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',pptx:'application/vnd.openxmlformats-officedocument.presentationml.presentation'},f={uploadStart:{type:'loadstart',handler:function(t){var i=a(t);i.status=e.STATUS_UPLOADING,t.emit('uploadStart',{fileItem:i});}},uploadSuccess:{type:'load',handler:function(t,i){var o=a(t),r={fileItem:o,responseText:o.xhr.responseText},s=o.chunk;if(s){var c=s.uploaded;if(c<o.file.size){var i=t.emit('chunkUploadSuccess',r);if(!i.isDefaultPrevented())if(s.index++,s.uploaded=c+s.uploading,s.uploaded<o.file.size)t.upload();else return o.status=e.STATUS_UPLOAD_SUCCESS,t.emit('uploadSuccess',r),void n(t,o);return;}}o.status=e.STATUS_UPLOAD_SUCCESS,t.emit('uploadSuccess',r),n(t,o);}},uploadError:{type:'error',handler:function(t,i,o){var r=a(t);r.status=e.STATUS_UPLOAD_ERROR,t.emit('uploadError',{fileItem:r,errorCode:o}),n(t,r);}},uploadStop:{type:'abort',handler:function(t,i){f.uploadError.handler(t,i,e.ERROR_CANCEL);}}},d={uploadProgress:{type:'progress',handler:function(e,t){var i=a(e),n=i.file.size,o=t.loaded,r=i.chunk;if(r)o+=r.uploaded;var s=o/(n||1);if(s>=0&&1>=s);else if(0>s)s=0;else if(s>1)s=1;s=parseInt(100*s,10)+'%',e.emit('uploadProgress',{fileItem:i,uploaded:o,total:n,percent:s});}}};return e;}),define('cobble/helper/Draggable',['require','exports','module','../function/page','../function/toNumber','../function/restrain','../function/position','../function/contains','../function/jquerify','../function/lifeCycle','../function/innerOffset','../function/outerOffset','../function/pageScrollLeft','../function/pageScrollTop','../function/enableSelection','../function/disableSelection','../util/instance','../util/mouse'],function(require){'use strict';function e(e){return l.init(this,e);}function t(e){var t=x(e),i=b(e);if(w.left!==t||w.top!==i){w.left=t,w.top=i;var n=e.data;if(1===++y){var o=n.draggingClass;if(o)n.element.addClass(o);n.emit('beforeDrag');}if(!n.silence)n.element.css(w);n.emit('drag',w);}}function i(e){m(),v.document.off(_);var t=e.data,i=t.draggingClass;if(i)t.element.removeClass(i);if(y>0)t.emit('afterDrag',w);y=x=b=null;}function n(e,t,i){var n=!1;if($.isArray(t))t=t.join(',');return e.find(t).each(function(){if(n=s(this,i))return!1;else return void 0;}),n;}var o=require('../function/page'),a=(require('../function/toNumber'),require('../function/restrain')),r=require('../function/position'),s=require('../function/contains'),c=require('../function/jquerify'),l=require('../function/lifeCycle'),u=require('../function/innerOffset'),p=require('../function/outerOffset'),f=require('../function/pageScrollLeft'),d=require('../function/pageScrollTop'),m=require('../function/enableSelection'),h=require('../function/disableSelection'),v=require('../util/instance'),g=require('../util/mouse');e.prototype={constructor:e,type:'Draggable',init:function(){var e=this,a=e.element;if(!e.container)e.container=o();a.css(r(a)),$.each(g,function(o,c){if(c.support)a.on(c.mousedown+_,function(l){var f=l.target,d=e.handleSelector,m=e.cancelSelector;if(!(d&&!n(a,d,f)||m&&n(a,m,f))){var g=S[o],$=p(a),k=g.absoluteX(l)-$.left,T=g.absoluteY(l)-$.top,I=e.container;if(s(I,a)){var q=u(I);k+=q.left,T+=q.top;}var j=r(a),O=j.position;w.left=j.left,w.top=j.top;var A=e.axis,R=e.getRectange(!0);x='y'===A?C.constant(w.left):C.change(g[O+'X'],k,R.x,R.x+R.width),b='x'===A?C.constant(w.top):C.change(g[O+'Y'],T,R.y,R.y+R.height),y=0,h(),v.document.on(c.mousemove+_,e,t).on(c.mouseup+_,e,i);}});});},getRectange:function(e){var t=this,i=t.rect;if($.isFunction(i))i=t.rect();if(e){var n=t.element,o=i.width-n.outerWidth(!0),a=i.height-n.outerHeight(!0);i.width=Math.max(0,o),i.height=Math.max(0,a);}return i;},setRectange:function(e){this.rect=e;},dispose:function(){var e=this;l.dispose(e),e.element.off(_),e.element=e.container=null;}},c(e.prototype),e.defaultOptions={rect:function(){var e=this,t=e.container,i={x:0,y:0,width:t.innerWidth(),height:t.innerHeight()};if(!s(t,e.element)){var n=u(t);i.x=n.left,i.y=n.top;}return i;}};var x,b,y,_='.cobble_helper_draggable',w={},C={constant:function(e){return function(){return e;};},change:function(e,t,i,n){return function(o){return a(e(o)-t,i,n);};}},S={};return $.each(g,function(e,t){if(t.support)S[e]={absoluteX:function(e){return t.clientX(e)+f();},absoluteY:function(e){return t.clientY(e)+d();},fixedX:function(e){return t.clientX(e);},fixedY:function(e){return t.clientY(e);}};}),e;}),define('cobble/helper/FlashUploader',['require','exports','module','../util/supload/supload','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return n.init(this,e);}require('../util/supload/supload');var t=window.Supload,i=require('../function/jquerify'),n=require('../function/lifeCycle');e.prototype={constructor:e,type:'FlashUploader',init:function(){var e=this,i={flashUrl:e.flashUrl,element:e.element[0],action:e.action,accept:e.accept,multiple:e.multiple,data:e.data,fileName:e.fileName,ignoreError:e.ignoreError,customSettings:{uploader:e}};$.each(o,function(e,t){e=$.camelCase('on-'+e),i[e]=t;}),e.supload=new t(i);},getFiles:function(){return this.supload.getFiles();},setAction:function(e){this.supload.setAction(e);},setData:function(e){this.supload.setData(e);},reset:function(){this.supload.reset();},upload:function(){this.supload.upload();},stop:function(){this.supload.cancel();},enable:function(){this.supload.enable();},disable:function(){this.supload.disable();},dispose:function(){var e=this;n.dispose(e),e.supload.dispose(),e.supload=e.element=null;}},i(e.prototype),e.defaultOptions={multiple:!1,fileName:'Filedata',ignoreError:!1,flashUrl:require.toUrl('../util/supload/supload.swf')},e.STATUS_WAITING=t.STATUS_WAITING,e.STATUS_UPLOADING=t.STATUS_UPLOADING,e.STATUS_UPLOAD_SUCCESS=t.STATUS_UPLOAD_SUCCESS,e.STATUS_UPLOAD_ERROR=t.STATUS_UPLOAD_ERROR,e.ERROR_CANCEL=t.ERROR_CANCEL,e.ERROR_SECURITY=t.ERROR_SECURITY,e.ERROR_IO=t.ERROR_IO;var o={ready:function(){var e=this.customSettings.uploader;e.emit('ready');},fileChange:function(){var e=this.customSettings.uploader;e.emit('fileChange');},uploadStart:function(e){var t=this.customSettings.uploader;t.emit('uploadStart',e);},uploadProgress:function(e){var t=this.customSettings.uploader,i=e.uploaded/(e.total||1);if(i>=0&&1>=i);else i=0;e.percent=parseInt(100*i,10)+'%',t.emit('uploadProgress',e);},uploadSuccess:function(e){var t=this.customSettings.uploader;t.emit('uploadSuccess',e);},uploadError:function(e){var t=this.customSettings.uploader;t.emit('uploadError',e);},uploadComplete:function(e){var t=this.customSettings.uploader;t.emit('uploadComplete',e);}};return e;}),define('cobble/helper/Input',['require','exports','module','../function/around','../function/jquerify','../function/lifeCycle','../util/keyboard','../util/input','./Keyboard'],function(require){'use strict';function e(e){return i.init(this,e);}var t=(require('../function/around'),require('../function/jquerify')),i=require('../function/lifeCycle'),n=require('../util/keyboard'),o=require('../util/input'),a=require('./Keyboard');e.prototype={constructor:e,type:'Input',init:function(){var e=this,t=e.element;o.init(t);var i=e.action;if(i)$.each(i,function(t,n){i[t]=$.proxy(n,e);});var s,c;e.keyboard=new a({element:t,action:i,longPress:e.longPress,onKeyDown:function(t){e.emit(t);},onKeyUp:function(t){e.emit(t);},onBeforeLongPress:function(){s=t.val(),c=!0,e.emit('beforeLongPress');},onAfterLongPress:function(i){if(c=!1,e.emit('afterLongPress'),s!==t.val()&&(n.isCharKey(i.keyCode)||n.isDeleteKey()))e.emit('change');}}),t.on('input'+r,function(){if(!c||!e.smart)e.emit('change');});},autoWidth:function(){var e=this,t=e.element;e.on('change',function(){if(t.scrollLeft()>0)t.width(t.prop('scrollWidth'));});},autoHeight:function(){var e=this,t=e.element;if('hidden'!==t.css('overflow-y'))t.css('overflow-y','hidden');var i,n=t.height(),o=n,a=parseInt(t.css('font-size'),10),r=t.innerHeight()-n;e.on('change',function(){if(o!==n)o=n,t.height(n);if(i=t.prop('scrollHeight')-r,Math.abs(i-o)>a)t.height(i),o=i;});},dispose:function(){var e=this;i.dispose(e);var t=e.element;o.dispose(t),t.off(r),e.keyboard.dispose(),e.element=e.keyboard=null;}},t(e.prototype),e.defaultOptions={smart:!0,longPress:!1};var r='.cobble_helper_input';return e;}),define('cobble/helper/Keyboard',['require','exports','module','../function/call','../function/split','../function/jquerify','../util/keyboard'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}function t(e){var t=[];return $.each(e,function(e,i){var n=[],o='plus',r=a(e.replace(/\$\+/g,o),'+');if($.each(s.combinationKey,function(e){if($.inArray(e,r)<0)r.push('!'+e);}),$.each(r,function(e,t){var i=0===t.indexOf('!');if(i)t=t.substr(1);if(t===o)t='$+';if(s.combinationKey[t])n.push((i?'!':'')+'e.'+t+'Key');else if(s[t])n.push('e.keyCode==='+s[t]);else return n.length=0,!1;}),n.length>0)t.push({test:new Function('e','return '+n.join('&')),handler:i});}),t;}function i(e){var t=e.data,i=e.keyCode,n=t.cache,a=n.counter;if(n.keyCode===i&&a>0){if(1===a)t.emit({type:'beforeLongPress',keyCode:i});a++;}else n.keyCode=i,a=1;if(n.counter=a,t.longPress||1===a)$.each(n.action,function(i,n){if(n.test(e))o(n.handler,t,e);});e.type='keyDown',t.emit(e);}function n(e){var t=e.data,i=t.cache;if(i.keyCode=null,i.counter>1)t.emit({type:'afterLongPress',keyCode:e.keyCode}),i.counter=0;e.type='keyUp',t.emit(e);}var o=require('../function/call'),a=require('../function/split'),r=require('../function/jquerify'),s=require('../util/keyboard');e.prototype={constructor:e,type:'Keyboard',init:function(){var e=this;e.cache={counter:0,action:t(e.action||{})},e.element.on('keydown'+c,e,i).on('keyup'+c,e,n);},dispose:function(){var e=this;e.element.off(c),e.element=e.cache=null;}},r(e.prototype),e.defaultOptions={longPress:!1};var c='.cobble_helper_keyboard';return e;}),define('cobble/helper/Placeholder',['require','exports','module','../function/init','../function/jquerify','../function/lifeCycle','../function/replaceWith','../util/input'],function(require){'use strict';function e(e){return n.init(this,e);}var t=require('../function/init'),i=require('../function/jquerify'),n=require('../function/lifeCycle'),o=require('../function/replaceWith'),a=require('../util/input');e.prototype={constructor:e,type:'Placeholder',init:function(){var e=this,t=e.element,i=t.attr('placeholder');if(null==e.value)e.value=i||'';var n;if(c)if(e.nativeFirst)n='native';else if(i)t.removeAttr('placeholder');if(!n)n=e.simple?'simple':'complex';if(n=l[n],$.extend(e,n),n.init)e.init();if(e.refresh)e.refresh();}},i(e.prototype),e.defaultOptions={simple:!1,nativeFirst:!0,simpleClass:'placeholder-active',placeholderSelector:'.placeholder',template:'<div class="placeholder-wrapper"><div class="placeholder"></div></div>'},e.init=t(e);var r='.cobble_helper_placeholder',s=$('<input type="text" />')[0],c='placeholder'in s;s=null;var l={'native':{show:$.noop,hide:$.noop,refresh:$.noop,dispose:function(){var e=this;n.dispose(e),e.element=null;}},simple:{init:function(){var e=this,t=$.proxy(e.refresh,e);e.element.on('focus'+r,t).on('blur'+r,t);},show:function(){var e=this;e.element.addClass(e.simpleClass).val(e.value);},hide:function(){var e=this;e.element.removeClass(e.simpleClass).val('');},refresh:function(){var e=this,t=e.element;if(document.activeElement===t[0]){if(t.hasClass(e.simpleClass))e.hide();}else if(!t.val())e.show();},dispose:function(){var e=this;n.dispose(e),e.element.off(r),e.element=null;}},complex:{init:function(){var e=this,t=e.element,i=$(e.template);o(t,i),i.append(t),e.faker=i.find(e.placeholderSelector);var n=$.proxy(e.refresh,e);a.init(t),t.on('focus'+r,n).on('blur'+r,n).on('input'+r,n);},show:function(){var e=this;e.faker.html(e.value).show();},hide:function(){this.faker.hide();},refresh:function(){var e=this,t=e.element.val();if($.trim(t))e.hide();else e.show();},dispose:function(){var e=this;n.dispose(e);var t=e.element;a.dispose(t),t.off(r),e.faker=e.element=null;}}};return e;}),define('cobble/helper/Popup',['require','exports','module','../function/split','../function/isHidden','../function/contains','../function/jquerify','../function/lifeCycle','../util/instance'],function(require){'use strict';function e(e){return S.init(this,e);}function t(e,t){$.each(e.showConfigList,function(i,n){n[t](e);});}function i(e,t){$.each(e.hideConfigList,function(i,n){n[t](e);});}function n(e,t){if(e)e.type=t;else e=t;return e;}function o(e){var t=e.currentTarget;return t&&'HTML'===t.tagName?null:t;}function a(e,t){return e.emit(n(t,'beforeShow'));}function r(e,n){return e.layer.data(O,o(n)),t(e,'off'),i(e,'on'),e.emit('afterShow');}function s(e,t){return e.emit(n(t,'beforeHide'));}function c(e){return e.layer.removeData(O),i(e,'off'),t(e,'on'),e.emit('afterHide');}function l(){return $.now();}function u(e){return'__'+e+'Handler__';}function p(e,t){return null==e[t];}function f(e,t){return e.layer.data(O)!==o(t);}function d(e,t,i){return!t||t(e,i);}function m(e,t){return t-e[j]>50;}function h(t,i){return function(n){var o=n.data,a=l(n);if(p(o,I)&&f(o,n)&&d(o,i,n))o[j]=a,g({popup:o,delay:o.show.delay,toggle:e.trigger.show[t].delay,timer:I,success:function(){var e=function(){o.open(n);},t=o[T];if(t)t.done(e);else e();}});};}function v(t,i){return function(n){var o=n.data,a=l(n);if(p(o,q)&&d(o,i,n)&&m(o,a))o[j]=a,o[T]=$.Deferred(),g({popup:o,delay:o.hide.delay,toggle:e.trigger.hide[t].delay,timer:q,success:function(){o.close(n),o[T].resolve();},fail:function(){o[T]=null;}});};}function g(e){var t=e.delay,i=e.success;if(t>0){var n=e.popup,o=e.timer,a=e.toggle||{},r=a.on||$.noop,s=a.off||$.noop,c=e.fail||$.noop,l=function(){clearTimeout(n[o]),s(n,u),n[o]=null;},u=function(e){var t=n[o];if(t)l();if(t&&e===j)i();else c();};r(n,u),n[o]=setTimeout(function(){u(j);},t);}else i();}function x(e){var t=this,i=t.type,n=t.handler,o=u(i);if(e[o]!==n)e.element.on(i,e.selector,e,n),e[o]=n;}function b(e){var t=this;if(!e.selector){var i=t.type;e.element.off(i,t.handler),e[u(i)]=null;}}var y=require('../function/split'),_=require('../function/isHidden'),w=require('../function/contains'),C=require('../function/jquerify'),S=require('../function/lifeCycle'),k=require('../util/instance');e.prototype={constructor:e,type:'Popup',init:function(){var n=this,o=n.showConfigList=[],a=n.hideConfigList=[],r=n.show.trigger,s=n.hide.trigger;if(r)$.each(y(r,','),function(t,i){var n=e.trigger.show[i];if(n)o.push(n);});if(s)$.each(y(n.hide.trigger,','),function(t,i){var n=e.trigger.hide[i];if(n)a.push(n);});if(n.hidden=_(n.layer))t(n,'on');else i(n,'on');},open:function(){var e=this,t=arguments[0];if(!t)e[j]=l();if(t=a(e,t),!t.isDefaultPrevented()){var i=e.layer,n=e.show.animation;if($.isFunction(n))n.call(e,i);else i.show();e.hidden=!1,r(e,t);}},close:function(){var e=this;if(!e.hidden){var t=arguments[0];if(!t)e[j]=l();if(t=s(e,t),!t.isDefaultPrevented()){var i=e.layer,n=e.hide.animation;if($.isFunction(n))n.call(e,i);else i.hide();e.hidden=!0,c(e);}}},dispose:function(){var e=this;S.dispose(e),e.close(),t(e,'off'),e.element=e.layer=null;}},C(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var T='__hidePromise__',I='__showTimer__',q='__hideTimer__',j='__lastTriggerTime__',O='__sourceElement__',A=function(e,t){if(!t)return!1;else return w(e.layer,t);};return e.trigger={show:{focus:{type:'focusin',handler:h('focus'),on:x,off:b},click:{type:'click',handler:h('click'),on:x,off:b},over:{type:'mouseenter',handler:h('over'),on:x,off:b,delay:{on:function(e,t){e.element.on('mouseleave',e.selector,t);},off:function(e,t){e.element.off('mouseleave',t);}}},context:{type:'contextmenu',handler:h('context'),on:x,off:b}},hide:{blur:{type:'focusout',handler:v('blur'),on:x,off:b},click:{type:'click',handler:function(){return v(this.type,function(e,t){return!A(e,t.target);});},on:function(e){var t=this;k.document.on(t.type,e,e.clickHandler=t.handler());},off:function(e){k.document.off(this.type,e.clickHandler);}},out:{type:'mouseleave',handler:v('out'),on:function(e){var t=this.type,i=this.handler;e.layer.on(t,e,i),e.element.on(t,e.selector,e,i);},off:function(e){var t=this.type,i=this.handler;e.element.off(t,i),e.layer.off(t,i);},delay:{on:function(e,t){e.element.on('mouseenter',e.selector,t),e.layer.on('mouseenter',t);},off:function(e,t){e.element.off('mouseenter',t),e.layer.off('mouseenter',t);}}},context:{type:'contextmenu',handler:function(){return v('context',function(e,t){return!A(e,t.target);});},on:function(e){var t=this;k.document.on(t.type,e,e.contextHandler=t.handler());},off:function(e){k.document.off(this.type,e.contextHandler);}}}},e;}),define('cobble/ui/ComboBox',['require','exports','module','../function/jquerify','../function/lifeCycle','../helper/Popup'],function(require){'use strict';function e(e){return i.init(this,e);}var t=require('../function/jquerify'),i=require('../function/lifeCycle'),n=require('../helper/Popup');e.prototype={constructor:e,type:'ComboBox',init:function(){var e=this,t=e.button,i=e.menu,a=e.element||t,r=e.openClass,s=e.show,c=e.hide,l=s.animation;if($.isFunction(l))s.animation=$.proxy(l,e);if(l=c.animation,$.isFunction(l))c.animation=$.proxy(l,e);if(e.popup=new n({element:t,layer:i,show:s,hide:c,onBeforeShow:function(t){e.emit(t);},onBeforeHide:function(t){e.emit(t);},onAfterShow:function(t){if(r)a.addClass(r);e.emit(t);},onAfterHide:function(t){if(r)a.removeClass(r);e.emit(t);}}),null==e.value){var u=i.find('.'+e.activeClass);if(1===u.length)e.value=u.data('value');}if(e.data)i.html(e.renderTemplate(e.data,e.template));if(null!=e.value)e.setValue(e.value,{force:!0,silence:!0});i.on('click'+o,'[data-value]',function(){e.setValue($(this).data('value')),e.close();});},getValue:function(){return this.value;},setValue:function(e,t){var i,n=this,o=n.menu,a=o.find('[data-value="'+e+'"]');if(1===a.length){if(i=a.data(),null==i.text)i.text=a.html();}else i={};if(t=t||{},t.force||e!=n.value){var r=n.activeClass;if(r)o.find('.'+r).removeClass(r);if(1===a.length){if(n.value=e,r)a.addClass(r);}else n.value=null;if(!t.silence)n.emit('change',i);}if($.isFunction(n.setText))n.setText(i.text||n.defaultText);},refresh:function(e){var t=this,i=t.value,n={};if(e){var o=e.data;if(o)t.menu.html(t.renderTemplate(o,t.template));if('value'in e)i=e.value,n.force=!0;}t.setValue(i,n);},open:function(){this.popup.open();},close:function(){this.popup.close();},dispose:function(){var e=this;i.dispose(e),e.menu.off(o),e.popup.dispose(),e.popup=e.element=e.button=e.menu=null;}},t(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var o='.cobble_ui_combobox';return e;}),define('cobble/ui/Dialog',['require','exports','module','../util/instance','../util/dimension','../function/jquerify','../function/lifeCycle','../function/offsetParent','../function/debounce','../function/pinGlobal','../function/dragGlobal'],function(require){'use strict';function e(e){return o.init(this,e);}var t=require('../util/instance'),i=require('../util/dimension'),n=require('../function/jquerify'),o=require('../function/lifeCycle'),a=require('../function/offsetParent'),r=require('../function/debounce'),s=require('../function/pinGlobal'),c=require('../function/dragGlobal');e.prototype={constructor:e,type:'Dialog',init:function(){var e=this,i=e.element||(e.element=$(e.template)),n=[],o=e.skinClass;if(o)n.push(o);var r=e.draggableClass;if(e.draggable&&r)n.push(r);if(n.length>0)i.addClass(n.join(' '));var s=e.removeOnEmpty,c=e.title;if(c)i.find(e.titleSelector).html(c);else if(s)i.find(e.headerSelector).remove();var u=e.content,p=i.find(e.bodySelector);if(u)p.html(u);else if(s)p.remove();var f=e.closeSelector,d=$.proxy(e.hide,e);if(f)i.on('click'+l,f,d);var m={};if(e.width)m.width=e.width;var h=e.fixed?'fixed':'absolute';if(i.css('position')!==h)m.position=h;if(!a(i).is('body'))t.body.append(i);if(e.modal){var v=e.mask||(e.mask=$(e.maskTemplate));if(i.before(v),e.hideOnClickMask)v.on('click'+l,d);var g='zIndex',x=e[g];if(!$.isNumeric(x))if(x=v.css(g),!$.isNumeric(x))x='auto';var b={overflow:'hidden'};b[g]=x,v.css(b),m[g]=x;}if(i.css(m),!e.hidden)e.hidden=!0,e.show();},show:function(){var e=this;if(e.hidden!==!1){var i=e.emit('beforeShow');if(!i.isDefaultPrevented()){var n=e.element,o=e.scrollable;if(e.draggable)e.drager=c({element:n,handleSelector:e.draggableHandleSelector,cancelSelector:e.draggableCancelSelector,draggingClass:e.draggingClass,fixed:e.fixed,scrollable:o});if(e.refresh(),e.showAnimation(),e.mask)e.showMaskAnimation();e.hidden=!1,t.window.resize(e.resizer=r(function(){e.refresh(!0);},50)),e.emit('afterShow');}}},hide:function(){var e=this;if(e.hidden!==!0){var i=e.emit('beforeHide');if(!i.isDefaultPrevented()){if(e.resizer)t.window.off('resize',e.resizer),e.resizer=null;if(e.drager)e.drager.dispose(),e.drager=null;if(e.hideAnimation(),e.mask)e.hideMaskAnimation();if(e.hidden=!0,e.emit('afterHide'),e.disposeOnHide)e.dispose();}}},refresh:function(){var e=this,t=arguments[0];if(!t||e.positionOnResize){var n=e.element,o=s({element:n,x:e.x,y:e.y,fixed:e.fixed});if(t)e.resizeAnimation(o);else n.css(o);}var a=e.mask;if(a)a.css({width:i.getPageWidth(),height:i.getPageHeight()});},dispose:function(){var e=this;if(o.dispose(e),!e.hidden)e.disposeOnHide=!1,e.hide();var t=e.element,i=e.mask;if(t.off(l),i)i.off(l);if(e.removeOnDispose)if(t.remove(),i)i.remove();e.element=e.mask=null;}},n(e.prototype),e.defaultOptions={x:'50%',y:'50%',modal:!0,fixed:!0,hidden:!1,draggable:!0,scrollable:!0,removeOnEmpty:!0,disposeOnHide:!0,removeOnDispose:!0,hideOnClickMask:!1,positionOnResize:!0,draggableClass:'draggable',draggableHandleSelector:'.dialog-header',draggableCancelSelector:['.dialog-header h1','.dialog-close'],headerSelector:'.dialog-header',titleSelector:'.dialog-header h1',closeSelector:'.dialog-close',bodySelector:'.dialog-body',template:'<div class="dialog"><i class="dialog-close">&times;</i><div class="dialog-header"><h1></h1></div><div class="dialog-body"></div></div>',maskTemplate:'<div class="dialog-mask"></div>',showAnimation:function(){this.element.show();},hideAnimation:function(){this.element.hide();},showMaskAnimation:function(){this.mask.show();},hideMaskAnimation:function(){this.mask.hide();},resizeAnimation:function(e){this.element.css(e);}};{var l='.cobble_ui_dialog';t.html.css('overflow'),t.body.css('overflow');}return e;}),define('cobble/ui/Uploader',['require','exports','module','../helper/AjaxUploader','../helper/FlashUploader'],function(require){'use strict';function e(){return'files'in $('<input type="file" />')[0];}function t(){if(!XMLHttpRequest)return!1;var e=new XMLHttpRequest();return'upload'in e&&'onprogress'in e.upload;}return e()&&t()?require('../helper/AjaxUploader'):require('../helper/FlashUploader');}),define('cobble/util/browser',['require','exports','module'],function(){'use strict';function e(e){var r,s=t(e)||n.exec(e)||o.exec(e)||i(e)||a.exec(e)||[];if(/Android/i.test(e))r='android';else if(/iPhone/i.test(e)||/iPad/i.test(e)||/iTouch/i.test(e))r='ios';else if(/Windows/i.test(e))r='windows';else if(/Macintosh/i.test(e))r='mac';else if(/Linux/i.test(e))r='linux';return{name:s[1]||'',version:s[2]||'0',os:r||''};}function t(e){var t,i=s.exec(e);if(i)t=i[1];else if(i=c.exec(e))t=parseInt(i[1],10)+4+'.0';if(t)return['','ie',t];else return void 0;}function i(e){var t=r.exec(e);if(t)return['','safari',t[1]];else return void 0;}var n=/(chrome)[ \/]([\w.]+)/,o=/(firefox)[ \/]([\w.]+)/,a=/(opera)(?:.*version)?[ \/]([\w.]+)/,r=/version[ \/]([\w.]+) safari/,s=/msie ([\w.]+)/,c=/trident[ \/]([\w.]+)/,l=e(navigator.userAgent.toLowerCase());if(l.name)l[l.name]=!0;return l;}),define('cobble/util/cookie',['require','exports','module'],function(require,exports){'use strict';function e(e){if(0===e.indexOf('"'))e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');var t={};try{e=decodeURIComponent(e.replace(/\+/g,' ')),$.each(e.split(';'),function(e,i){var n=i.split('='),o=$.trim(n[0]),a=$.trim(n[1]);if(o)t[o]=a;});}catch(i){}return t;}function t(e,t,n){var o=n.expires;if($.isNumeric(o)){var a=o;o=new Date(),o.setTime(o.getTime()+a*i);}document.cookie=[encodeURIComponent(e),'=',encodeURIComponent(t),o?';expires='+o.toUTCString():'',n.path?';path='+n.path:'',n.domain?';domain='+n.domain:'',n.secure?';secure':''].join('');}var i=3600000;exports.get=function(t){var i=e(document.cookie);return'string'===$.type(t)?i[t]:i;},exports.set=function(e,i,n){if($.isPlainObject(e))n=i,i=null;if(n=$.extend({},exports.defaultOptions,n),null===i)$.each(e,function(e,i){t(e,i,n);});else t(e,i,n);},exports.remove=function(e,i){if(null!=e)i=i||{},i.expires=-1,t(e,'',$.extend({},exports.defaultOptions,i));},exports.defaultOptions={path:'/'};}),define('cobble/util/dimension',['require','exports','module','../function/pageScrollTop','../function/pageScrollLeft','../function/pageWidth','../function/pageHeight','../function/viewportWidth','../function/viewportHeight'],function(require,exports){'use strict';var e=require('../function/pageScrollTop'),t=require('../function/pageScrollLeft'),i=require('../function/pageWidth'),n=require('../function/pageHeight'),o=require('../function/viewportWidth'),a=require('../function/viewportHeight');exports.getPageScrollTop=e,exports.getPageScrollLeft=t,exports.getPageWidth=i,exports.getPageHeight=n,exports.getViewportWidth=o,exports.getViewportHeight=a;}),define('cobble/util/input',['require','exports','module','../function/around'],function(require,exports){'use strict';function e(){}function t(e){var t=e.val(),n=!1;e.on('propertychange'+a,function(i){if(n)return void(n=!1);if('value'===i.originalEvent.propertyName){var o=e.val();if(o!==t)e.trigger('input'),t=o;}}),i(e,'val',function(){if(0!==arguments.length)n=!0;});}var i=require('../function/around'),n=$('<input type="text" />')[0],o='oninput'in n;n=null;var a='.cobble_util_input';exports.init=o?e:t,exports.dispose=function(e){e.off(a);};}),define('cobble/util/instance',['require','exports','module'],function(require,exports){exports.window=$(window),exports.document=$(document),exports.html=$(document.documentElement),exports.body=$(document.body);}),define('cobble/util/json',['require','exports','module'],function(require,exports,module){if('object'!=typeof JSON)JSON={};return function(){'use strict';function f(e){return 10>e?'0'+e:e;}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return'string'==typeof t?t:'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+e+'"';}function str(e,t){var i,n,o,a,r,s=gap,c=t[e];if(c&&'object'==typeof c&&'function'==typeof c.toJSON)c=c.toJSON(e);if('function'==typeof rep)c=rep.call(t,e,c);switch(typeof c){case'string':return quote(c);case'number':return isFinite(c)?String(c):'null';case'boolean':case'null':return String(c);case'object':if(!c)return'null';if(gap+=indent,r=[],'[object Array]'===Object.prototype.toString.apply(c)){for(a=c.length,i=0;a>i;i+=1)r[i]=str(i,c)||'null';return o=0===r.length?'[]':gap?'[\n'+gap+r.join(',\n'+gap)+'\n'+s+']':'['+r.join(',')+']',gap=s,o;}if(rep&&'object'==typeof rep){for(a=rep.length,i=0;a>i;i+=1)if('string'==typeof rep[i])if(n=rep[i],o=str(n,c))r.push(quote(n)+(gap?': ':':')+o);}else for(n in c)if(Object.prototype.hasOwnProperty.call(c,n))if(o=str(n,c))r.push(quote(n)+(gap?': ':':')+o);return o=0===r.length?'{}':gap?'{\n'+gap+r.join(',\n'+gap)+'\n'+s+'}':'{'+r.join(',')+'}',gap=s,o;}}if('function'!=typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null;},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf();};var cx,escapable,gap,indent,meta,rep;if('function'!=typeof JSON.stringify)escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},JSON.stringify=function(e,t,i){var n;if(gap='',indent='','number'==typeof i)for(n=0;i>n;n+=1)indent+=' ';else if('string'==typeof i)indent=i;if(rep=t,t&&'function'!=typeof t&&('object'!=typeof t||'number'!=typeof t.length))throw new Error('JSON.stringify');return str('',{'':e});};if('function'!=typeof JSON.parse)cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var i,n,o=e[t];if(o&&'object'==typeof o)for(i in o)if(Object.prototype.hasOwnProperty.call(o,i))if(n=walk(o,i),void 0!==n)o[i]=n;else delete o[i];return reviver.call(e,t,o);}var j;if(text=String(text),cx.lastIndex=0,cx.test(text))text=text.replace(cx,function(e){return'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4);});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'')))return j=eval('('+text+')'),'function'==typeof reviver?walk({'':j},''):j;throw new SyntaxError('JSON.parse');};}(),JSON;}),define('cobble/util/keyboard',['require','exports','module'],function(require,exports){'use strict';function e(e){var t={};return $.each(e,function(e,i){t[i]=e;}),t;}var t={a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,'`':192,'-':173,'=':61,'[':219,']':221,'\\':220,';':59,"'":222,',':188,'.':190,'/':191,$0:96,$1:97,$2:98,$3:99,$4:100,$5:101,$6:102,$7:103,$8:104,$9:105,'$.':110,'$+':107,'$-':109,'$*':106,'$/':111,space:32,tab:9},i={backspace:8,'delete':46},n={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,enter:13,esc:27,capslock:20,insert:45,home:36,end:35,pageup:33,pagedown:34,left:37,right:39,up:38,down:40},o={shift:16,ctrl:17,meta:91,alt:18};$.extend(exports,t,n,o),exports.charKey=t,exports.deleteKey=i,exports.functionKey=n,exports.combinationKey=o,exports.isCharKey=function(i){return i in e(t);},exports.isDeleteKey=function(t){return t in e(i);},exports.isFunctionKey=function(t){return t in e(n);},exports.isCombinationKey=function(t){return t in e(o);};}),define('cobble/util/mouse',['require','exports','module'],function(){'use strict';function e(e){return e.originalEvent.changedTouches[0];}var t=document.createElement('div'),i={support:'ontouchend'in t,click:'touchstart',mousedown:'touchstart',mousemove:'touchmove',mouseup:'touchend',pageX:function(t){return e(t).pageX;},pageY:function(t){return e(t).pageY;},clientX:function(t){return e(t).clientX;},clientY:function(t){return e(t).clientY;}},n={support:'onclick'in t,click:'click',mousedown:'mousedown',mousemove:'mousemove',mouseup:'mouseup',pageX:function(e){return e.pageX;},pageY:function(e){return e.pageY;},clientX:function(e){return e.clientX;},clientY:function(e){return e.clientY;}};return t=null,{touch:i,mouse:n};}),define('cobble/util/redirect',['require','exports','module','../util/url'],function(require,exports){'use strict';function e(e,i){var n=t.parse(e),o='<form action="'+n.origin+n.pathname+'" target="_blank"';if(i)o+=' accept-charset="'+i+'" onsubmit="document.charset=\''+i+'\';"';return o+='>',$.each(t.parseQuery(n.search),function(e,t){o+='<input type="hidden" name="'+e+'" value="'+t+'" />';}),o+='</form>',$(o);}var t=require('../util/url');exports.openForm=function(t,i){var n=e(t,i);n.appendTo('body'),n.submit();},exports.openLink=function(e){var t=$('<a href="'+e+'" target="_blank"><b></b></a>');t.appendTo('body');try{t.find('b')[0].click();}catch(i){exports.openForm(e);}};}),define('cobble/util/supload/supload',['require','exports','module','../cookie','../json'],function(require){function e(e){$.extend(this,e),this.init();}function t(){return'_Supload_'+o++;}if(window.Supload===e)return window.Supload;var i=require('../cookie'),n=require('../json');e.prototype={constructor:e,init:function(){var n=t();this.movieName=n;var o=this.element;if('string'===$.type(o))o=document.getElementById(o);var a=this.data||(this.data={});$.each(i.get(),function(e,t){if('undefined'===$.type(a[e]))a[e]=t;});var r=e.createSWF(n,this.flashUrl,this.getFlashVars());o.parentNode.replaceChild(r,o),this.element=r,this.onLog=function(e){console.log(e);},e.instances[n]=this;},getFlashVars:function(){var t=this,i=[];return $.each(['movieName','action','accept','multiple','fileName','data','ignoreError'],function(e,o){var a=t[o];if(null!=a){if($.isPlainObject(a))a=n.stringify(a);else if($.isArray(a))a=a.join(',');i.push(o+'='+encodeURIComponent(a));}}),i.push('projectName='+e.projectName),i.join('&amp;');},getFiles:function(){return this.element.getFiles&&this.element.getFiles()||[];},setAction:function(e){this.element.setAction&&this.element.setAction(e);},setData:function(e){this.element.setData&&this.element.setData(e);},reset:function(){this.element.reset&&this.element.reset();},upload:function(){this.element.upload&&this.element.upload();},cancel:function(){this.element.cancel&&this.element.cancel();},enable:function(){this.element.enable&&this.element.enable();},disable:function(){this.element.disable&&this.element.disable();},dispose:function(){this.element.dispose&&this.element.dispose(),e.instances[this.movieName]=null,window[this.movieName]=null;}},e.projectName='Supload',e.createSWF=function(t,i,n){var o='<object id="'+t+'" class="'+e.projectName.toLowerCase()+'" type="application/x-shockwave-flash" data="'+i+'"><param name="movie" value="'+i+'" /><param name="allowscriptaccess" value="always" /><param name="wmode" value="transparent" /><param name="flashvars" value="'+n+'" /></object>';return $(o)[0];},e.instances={},e.STATUS_WAITING=0,e.STATUS_UPLOADING=1,e.STATUS_UPLOAD_SUCCESS=2,e.STATUS_UPLOAD_ERROR=3,e.ERROR_CANCEL=0,e.ERROR_SECURITY=1,e.ERROR_IO=2;var o=178245;return window.Supload=e,e;}),define('cobble/util/url',['require','exports','module'],function(require,exports){'use strict';exports.parseQuery=function(e){var t={};if('string'===$.type(e)&&e.length>1){var i=0,n=e.charAt(0);if('?'===n)i=1;else if('#'===n){i=1;var o=e.charAt(1);if('/'===o)i=2;}if(i>0)e=e.substr(i);$.each(e.split('&'),function(e,i){var n=i.split('=');if(2===n.length){var o=$.trim(n[0]);if(o)t[o]=decodeURIComponent($.trim(n[1]));}});}return t;},exports.getOrigin=function(e){if(!e)e=document.URL;return exports.parse(e).origin;},exports.parse=function(e){var t=document.createElement('a');t.href=e,e=t.href;var i='';if(t.protocol&&t.host)i=t.protocol+'//'+t.host;else if(/^(http[s]?:\/\/[^\/]+)(?=\/)/.test(e))i=RegExp.$1;var n=i.split(':');if(0===i.indexOf('http:')&&3===n.length&&80==n[2])n.length=2,i=n.join(':');var o=t.pathname;if(o&&'/'!==o.charAt(0))o='/'+o;return{origin:i,pathname:o,search:t.search};};}),define('common/component/BanLessonDialog_2c09adc638',['require','exports','common/service_9c322508d3','./InviteResultDialog_67a8d4ed9e'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}var t=require('common/service_9c322508d3'),i=require('./InviteResultDialog_67a8d4ed9e');return e.prototype={init:function(){var e=this,n=e.next;alert({title:'温馨提示',content:e.text,width:420,buttons:[{text:e.noskip?'确认':e.hasStudentRole?'切换身份':'立即开通',type:'primary',handler:function(){this.hide(),o();}},{text:'取消',handler:function(){if(this.hide(),$.isFunction(e.onCancel))e.onCancel();}}]});var o=function(){var o=function(o){t.sendInviteCode({role:2,formData:o?e.switchRoleData:null}).done(function(t){var a=function(){if($.isFunction(e.onSuccess))e.onSuccess();if(!n)window.location.href=t.data.url;else if('0'!==n)window.location.href=n;};if(0===t.code)if(o)new i({userType:0,status:'succ',onAfterHide:a});else a();else if(o)new i({userType:0,status:'err'});else alert('数据正在维护\uFF01');});};if(e.hasStudentRole)o();else o(!0);};}},e.defaultOptions={hasStudentRole:!1},e;}),define('common/component/Captcha_e804b20fed',['require','cobble/form/Validator','common/service_9c322508d3'],function(require){'use strict';function e(e){$.extend(this,e),this.init();}function t(){var e=this;return{captcha:{errors:{required:'请输入验证码',minlength:'请输入 4 位验证码',maxlength:'请输入 4 位验证码'},custom:function(t,i){if(e.skipAuth)i();var o={captcha:e.newCaptcha,captcha_name:e.captchaName};if($.isFunction(e.onBeforeValidate))e.onBeforeValidate();n.validateCaptcha(o,{errorHandler:{1:function(){}}}).done(function(e){if(0===e.code)i();else i('请输入正确的验证码');});}}};}var i=require('cobble/form/Validator'),n=require('common/service_9c322508d3');return e.prototype={init:function(){var e=this,n=e.element,o=n.find('input[name="captcha"]');e.input=o,e.captchaImage=e.element.find('.captcha-image'),e.captchaName=e.captchaName||'',e.newCaptcha='',e.isValid=!1,e.needAuth=!0,e.captchaValidator=new i({element:n,fields:t.call(e),onAfterValidate:function(t,i){if(0===i.errors.length){if(e.needAuth=!1,e.isValid=!0,$.isFunction(e.onValid))e.onValid();}else if(e.isValid=!1,$.isFunction(e.onInvalid))e.onInvalid();}});var a,r=function(t){var i=$(t.currentTarget),n=$.trim(i.val()),o=/^[0-9a-zA-Z]{4}$/g;if(o.test(n))e.newCaptcha=n,e.captchaValidator.validate();};if(e.element.on('click','.btn-change-captcha',function(){e.change();}),!e.skipAuth)if(o.on('blur',function(t){var i=$(t.currentTarget);if(e.newCaptcha=i.val(),a!=e.newCaptcha||e.needAuth)if(!e.autoValidate)e.captchaValidator.validate();return a=i.val(),!1;}),e.autoValidate)o.on('input',r).on('propertychange',r);},validate:function(){return this.captchaValidator.validate(),this.isValid;},getValue:function(){return this.input.val();},change:function(){var e=this;if(e.captchaName)e.captchaImage.prop('src','/captcha?captcha_name='+e.captchaName+'&'+$.now());else e.captchaImage.prop('src','/captcha?'+$.now());if($.isFunction(e.onBeforeValidate))e.onBeforeValidate();e.needAuth=!0,e.input.val('');},hide:function(){this.element.hide(),this.hidden=!0;},show:function(){this.element.show(),this.hidden=!1;},setCaptchaName:function(e){this.captchaName=e||'';}},e;}),define('common/component/CodeButton_edf3c78096',['require'],function(){'use strict';function e(e){$.extend(this,e),this.init();}return e.prototype={init:function(){var e=this,t=e.element;e.isCounting=!1,e.origin=t.html();var i=function(){e.sendCode();};if(e.container)e.container.on('click',function(e){if(e.target===t[0])i();});else t.click(i);},countDown:function(e){var t=this,i=this.element;t.isCounting=!0;var n=function(e){if(i.html(e+' 秒后再次发送'),$.isFunction(t.onTextChange))t.onTextChange();};i.prop('disabled',!0),t.timer=setInterval(function(){if(e--,e>0)n(e);else t.reset();},1000),n(e);},reset:function(){var e=this;e.isCounting=!1;var t=e.element;if(clearInterval(e.timer),t.html(e.origin),t.prop('disabled',!1),$.isFunction(e.onTextChange))e.onTextChange();if($.isFunction(e.onFinish))e.onFinish();},dispose:function(){if(this.element.off(),this.timer)clearInterval(this.timer);},sendCode:function(){var e=this,t=e.element;t.prop('disabled',!0);var i=e.send();if(i)i.done(function(i){if(0===i.code)e.countDown(60);else t.prop('disabled',!1);});else t.prop('disabled',!1);return i;}},e;}),define('common/component/Editor_c19cafc60f',['require','cobble/form/Text'],function(require){'use strict';function e(e){$.extend(this,e),this.init();}var t=require('cobble/form/Text');e.prototype={constructor:e,init:function(){var e=this,i=this.element,n=this.minLength||0,o=this.maxLength,a=(this.flexHeight||!1,this.autoHint||!1),r=i.find('.form-hint');if(n)r.html('还需要输入<strong>'+n+'</strong>个字');else if(!a)r.html('还可以输入<strong>'+o+'</strong>个字');var s=this.textarea=i.find('textarea'),c=function(){var t,i=s.val();if(i.length<n)t=n-i.length,r.html('还需要输入<strong>'+t+'</strong>个字');else if(i.length>=n&&i.length<=o)if(!a||i.length>=a)t=o-i.length,r.html('还可以输入<strong>'+t+'</strong>个字');else r.html('');else if(o<i.length)t=i.length-o,r.html('<span class="text-error">已超出<strong>'+t+'</strong>个字</span>');e.autoHeight();};this.textInput=new t({element:s,placeholderNativeFirst:!1,placeholderSimple:!1,onChange:c}),c();},getValue:function(){return this.textarea.val();},setValue:function(e){this.textInput.setValue(e),this.autoHeight();},autoHeight:function(){if(this.flexHeight){var e=this.textarea[0].scrollHeight+'px';this.textarea.css('height',e);}},validate:function(){return this.maxLength>=this.getValue().length;}};return e;}),define('common/component/ImageDialog_992ca63b0f',['require','cobble/ui/Dialog','../function/compressImage_1539d29a96','cobble/function/imageDimension','cobble/function/viewportHeight','../function/scale_330792fa50'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}var t=require('cobble/ui/Dialog'),i=require('../function/compressImage_1539d29a96'),n=require('cobble/function/imageDimension'),o=require('cobble/function/viewportHeight'),a=require('../function/scale_330792fa50');return e.prototype={init:function(){var e=this,i=e.dialog=new t({skinClass:'image-dialog',removeOnEmpty:!1,hideOnClickMask:!0,hidden:!0}),n=i.element,a=n.find('.dialog-header').outerHeight(),r=e.imageHeight=e.imageHeight?e.imageHeight:o()-a-20,s=e.imageWidth=e.imageWidth?e.imageWidth:4/3*r;n.width(s);var c=n.find('.dialog-body');c.height(r);var l='<i class="icon icon-chevron-left"></i><i class="icon icon-chevron-right"></i>';c.after(l),n.on('click','.icon-chevron-left',function(){e.setImage(e.index-1);}).on('click','.icon-chevron-right',function(){e.setImage(e.index+1);}),e.setImage(e.index);},setImage:function(e){var t=this,o=t.data[e],r=t.dialog,s=r.element;if(s.find(r.titleSelector).html(o.title),o.noCompress)var c=o.url;else var c=i({url:o.url,width:t.imageWidth,height:t.imageHeight,noCrop:!0});var l=s.find(r.bodySelector);o=$('<img src="'+c+'" />'),l.html(''),l.append(o),n(c,function(e,i){var n=a({width:e,height:i},{width:t.imageWidth,height:t.imageHeight});i*=n,o.css({width:e*n,height:i,position:'relative',top:(t.imageHeight-i)/2}),r.show();}),t.index=e;var u=s.find('.icon-chevron-left'),p=s.find('.icon-chevron-right');if(u.show(),p.show(),0===e)u.hide();if(e===t.data.length-1)p.hide();}},e.defaultOptions={},e;}),define('common/component/InviteDialog_c5f0f737c8',['require','exports','cobble/ui/Dialog','cobble/helper/Input','common/service_9c322508d3'],function(require){'use strict';function e(e){$.extend(this,e),this.init();}var t=require('cobble/ui/Dialog'),i=require('cobble/helper/Input'),n=require('common/service_9c322508d3');e.prototype={init:function(){var e=this,a=e.userType,r=e.targetRole,s=e.formData,c='',l='',u=e.next;if(0!=a)c=o.teacher.content,l=o.teacher.title;else c=o.student.content,l=o.student.title;var p=new t({title:l,content:c,skinClass:'invite-dialog',disposeOnHide:!0,width:450});e.dialog=p;{var f=p.element,d=f.find('.btn-confirm');new i({element:f.find(':text'),onChange:function(){$.trim(this.element.val());d.prop('disabled',!1);}});}f.on('click','.btn-confirm',function(){p.hide(),n.sendInviteCode({inviteCode:f.find('input').val(),role:r,formData:s}).done(function(t){if(0===t.code){if($.isFunction(e.onSuccess))e.onSuccess();if(u&&'0'!==u)setTimeout(function(){if('2'==r){if(!u)window.location.href=t.data.url;else if(u.length>1)window.location.href=u;}else if('0'==r);},5500);}else if($.isFunction(e.onError))e.onError();});}).on('click','.btn-cancel',function(){p.hide();});}};var o={teacher:{title:'开通老师身份',content:'<div class="title"><span>即将给您开通老师身份\uFF0C是否继续\uFF1F</span></div><div class="form-group invite"><label class="form-label">邀请码\uFF08选填\uFF09\uFF1A</label><div class="form-controls"><input type="text" class="form-text" /><div class="form-block">拨打 <span class="text-info">4000-910-910</span> 获取邀请码</div></div></div><div class="dialog-action"><button class="btn-primary btn-confirm">确定</button><button class="btn-default btn-cancel">取消</button></div>'},student:{title:'开通学生身份',content:'<div class="title"><span>即将给您开通学生身份\uFF0C是否继续\uFF1F</span></div><div class="invite"><span>邀请码\uFF08选填\uFF09</span><input type="text" class="form-text" /></div><div class="dialog-action"><button class="btn-primary btn-confirm">确定</button><button class="btn-default btn-cancel">取消</button></div>'}};return e;}),define('common/component/InviteResultDialog_67a8d4ed9e',['require','exports','cobble/ui/Dialog'],function(require){'use strict';function e(e){$.extend(this,e),this.init();}var t=require('cobble/ui/Dialog');e.prototype={init:function(){var e=this,n=e.userType,o=e.status,a='',r='';if('2'==n)if('succ'==o)r=i.teacher.succ.title,a=i.teacher.succ.content;else r=i.teacher.err.title,a=i.teacher.err.content;else if('0'==n)if('succ'==o)r=i.student.succ.title,a=i.student.succ.content;else r=i.student.err.title,a=i.student.err.content;var s=new t({title:r,content:a,skinClass:'invite-result-dialog',disposeOnHide:!0,width:450,onAfterHide:function(){if('succ'==o&&$.isFunction(e.onAfterHide))e.onAfterHide();}}),c=s.element,l=c.find('.timer'),u=5,p=setInterval(function(){if(1>u)clearInterval(p),s.hide();u--,l.html(u);},1000);c.on('click','.btn-confirm',function(){s.hide();});}};var i={teacher:{succ:{title:'开通老师身份成功',content:'<div class="invite-result-dialog"><div class="wrapper"><i class="icon icon-check-circle"></i><div class="msg-content"><div class="msg-content-title">恭喜你开通老师身份\uFF01</div><div class="msg-content-words">快去完善个人资料和课程信息吧~~</div><div class="msg-content-time"><span class="timer">5</span>秒后跳转至老师中心</div></div></div><div class="dialog-action"><button class="btn btn-info btn-confirm">立即前往</button></div></div>'},err:{title:'开通老师身份失败',content:'<div class="invite-result-dialog"><div class="wrapper"><i class="icon icon-times-circle"></i><div class="msg-content"><div class="msg-content-title">对不起\uFF0C你的老师身份开通失败</div><div class="msg-content-words">拨打 <span class="phone">4000-910-910</span> 咨询客服</div><div class="msg-content-time"><span class="timer">5</span>秒后自动关闭</div></div></div><div class="dialog-action"><button class="btn btn-info btn-confirm">立即关闭</button></div></div>'}},student:{succ:{title:'开通学生身份成功',content:'<div class="invite-result-dialog"><div class="wrapper"><i class="icon icon-check-circle"></i><div class="msg-content"><div class="msg-content-title">恭喜你开通学生身份\uFF01</div><div class="msg-content-words">快去搜索喜欢的老师和课程吧~~</div><div class="msg-content-time"><span class="timer">5</span>秒后返回</div></div></div><div class="dialog-action"><button class="btn btn-info btn-confirm">立即返回</button></div></div>'},err:{title:'开通学生身份失败',content:'<div class="invite-result-dialog"><div class="wrapper"><i class="icon icon-times-circle"></i><div class="msg-content"><div class="msg-content-title">对不起\uFF0C您的学生身份开通失败</div><div class="msg-content-words">拨打 <span class="phone">4000-910-910</span> 咨询客服</div><div class="msg-content-time"><span class="timer">5</span>秒后自动关闭</div></div></div><div class="dialog-action"><button class="btn btn-info btn-confirm">立即关闭</button></div></div>'}}};return e;}),define('common/component/LoginDialog_da294c651f',['require','cobble/ui/Dialog','./LoginForm_cffa2f6994'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}var t=require('cobble/ui/Dialog'),i=require('./LoginForm_cffa2f6994');return e.prototype={init:function(){var e=this,n=e.failNext;e.dialog=new t({zIndex:e.zIndex||5,title:e.title,content:$('#login-dialog-form').html(),width:e.width,skinClass:e.skinClass});var o=e.dialog.element;if(e.next)o.find('input[name="next"]').val(encodeURIComponent(e.next));new i({element:o,mobile:e.mobile,showKefu:e.showKefu,wrongRoleText:e.wrongRoleText,failNext:n,activityVoiceRegister:e.activityVoiceRegister,registerPrefix:e.registerPrefix,onSuccess:function(t){if(e.hide(),$.isFunction(e.onSuccess))e.onSuccess(t);}});},show:function(){this.dialog.show();},hide:function(){this.dialog.hide();}},e.defaultOptions={title:'登录',width:383,onSuccess:$.noop,skinClass:'login-dialog'},e;}),define('common/component/LoginForm_cffa2f6994',['require','exports','cobble/form/Validator','cobble/helper/Placeholder','cobble/util/cookie','common/service_9c322508d3','common/form_2ef59f4d41','common/store_a1a35b3dfc','cobble/ui/Dialog','cobble/util/url','common/function/rc4_c97a7cac84','cobble/util/redirect','common/component/SaveButton_b1f301d041','common/component/CodeButton_edf3c78096','common/component/InviteDialog_c5f0f737c8','common/component/InviteResultDialog_67a8d4ed9e','common/component/BanLessonDialog_2c09adc638','common/component/MobileInput_8f8e780d3d','common/function/wechatQrcode_248248d034','common/component/Captcha_e804b20fed'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}function t(e){var t='';if($.each(e,function(e,i){if(i.value){if(0!==e)t+='&';t+=i.key+'='+i.value;}}),t)t='?'+t;return t;}function i(e){if(e===!0)return p.getSMSCode({mobile:o.getMobile(),captcha:r&&r.getValue()||'',captcha_name:'signin',type:'signin',is_voice:1});if(!o.getMobile())alert('请输入手机号');else{if(s='voice',r&&!r.hidden)if(!r.validate())return!1;alert({title:'获取语音校验码',content:'校验码将以电话形式通知到你\uFF0C请注意接听',buttons:[{text:'获取',type:'primary',handler:function(){this.hide(),p.getSMSCode({mobile:o.getMobile(),captcha:r&&r.getValue()||'',captcha_name:'signin',type:'signin',is_voice:1},{errorHandler:{1000111:function(){r.show(),r.change(),setTimeout(function(){r.validate();});}}});}},{text:'取消',handler:function(){this.hide();}}]});}}function n(e,t){if(e.validate('mobile')&&!t.isCounting)t.element.prop('disabled',!1);else t.element.prop('disabled',!0);}var o,a,r,s,c=require('cobble/form/Validator'),l=require('cobble/helper/Placeholder'),u=require('cobble/util/cookie'),p=require('common/service_9c322508d3'),f=require('common/form_2ef59f4d41'),d=require('common/store_a1a35b3dfc'),m=require('cobble/ui/Dialog'),h=(require('cobble/util/url'),require('common/function/rc4_c97a7cac84')),v=require('cobble/util/redirect'),g=require('common/component/SaveButton_b1f301d041'),x=require('common/component/CodeButton_edf3c78096'),b=(require('common/component/InviteDialog_c5f0f737c8'),require('common/component/InviteResultDialog_67a8d4ed9e')),y=require('common/component/BanLessonDialog_2c09adc638'),_=require('common/component/MobileInput_8f8e780d3d'),w=require('common/function/wechatQrcode_248248d034'),C=require('common/component/Captcha_e804b20fed'),S='44332777625',k='<div class="form-block captcha form-captcha"><div class="form-group"><label class="form-label">验证码\uFF1A</label><div class="form-controls"><span class="input-group"><input class="form-text" type="text" name="captcha" required minlength="4" maxlength="4" placeholder="请输入图中的文字"><span class="input-group-addon"><img class="captcha-image" src="/captcha?captcha_name=signin&'+$.now()+'" /></span></span><span class="error"></span></div><div class="form-hint"><span class="btn-link btn-change-captcha">换一张</span></div></div></div>',T=2;e.prototype={init:function(){var e=this,d=e.element;e.validator=new c({realtime:!0,element:d,fields:{password:{errors:{required:'请输入密码',minlength:'最小长度长为 6 个',maxlength:'最大长度长为 16 个'}},mobile:{errors:{required:'请输入手机号',pattern:'请输入正确的手机号'}},verifycode:{errors:{required:'请输入校验码',pattern:'请输入正确的校验码'}}}});var m,b=d.find('[name="mobile"]'),y=u.get('LOGIN_USERNAME');w('wechat-login',T),o=e.mobileInput=new _({element:d.find('#login-mobile'),validator:e.validator,onInputChange:function(){if(a)a.hide();}});var j=!1,O=d.find('.form-switch-international b'),A=d.find('.voice-code-link');A.on('click','.btn-link',i),b.on('blur',function(){n(e.validator,m);});var R=d.find('.login-way-switch [data-way="sms"]');if(O.on('click',function(){if(j)j=!1,o.disableInternational(),O.text('国际手机登录'),R.show();else j=!0,o.enableInternational(),O.text('普通登录'),R.hide();}),!$.trim(b.val())&&y)if(/^1[3-9]\d{9}$/.test(y))b.val(y);else b.val(h(y,S));if(e.mobile)b.val(e.mobile);new g({element:d.find('.btn-primary'),form:d,saveText:'正在登录...',save:function(){return d.blur(),e.login();}}),l.init(d.find('[placeholder]'));{var E=d.find('.form-sms'),N=E.find('.form-text'),P=d.find('.btn-info');N.width();}m=new x({element:P,send:function(){A.show();var e=o.getMobile(),t='signin';return s='sms',p.getSMSCode({mobile:e,type:'signin',captcha:r&&r.getValue()||'',captcha_name:'signin'},{errorHandler:{1000111:function(){if(!r)$(k.replace('exceed_count',t)).insertAfter('.form-group.form-sms'),r=new C({element:$('.form-block.captcha'),captchaName:t,skipAuth:!1,autoValidate:!0,onValid:function(){if(r.hide(),!s||'sms'===s)P.prop('disabled',!1),m.sendCode();else i(!0);N.focus(),setTimeout(function(){r.input.val('');});},onInvalid:function(){P.prop('disabled',!0);}});else r.change();r.show(),setTimeout(function(){r.validate();},0);}}}).done(function(e){if(0==e.code)N.focus();});},onTextChange:function(){N.outerWidth(E.width()-P.outerWidth(!0)-2);}}),e.loginWay='password';var L='active',U=d.parents('#main').find('.login-banner-student'),D=d.parents('#main').find('.login-banner-teacher');if(e.showKefu)d.find('.bykefu-div').show();d.on('click','.form-radios input',function(){d.find('.form-radios .'+L).removeClass(L);var e=$(this),t=e.closest('label');if(t.addClass(L),e.prop('checked',!0),'0'==e.val()){U.hide(),D.show(),T=0,w('wechat-login',T);var i={type:'t_login',stype:'tpc_login',client:'PC'};WAT.send('http://click.genshuixue.com/gs.gif',i);}else D.hide(),U.show(),T=2,w('wechat-login',T);}).on('click','.login-way-switch a',function(t){t.preventDefault();var i=$(this),o=e.loginWay=i.data('way');if(a&&a.hide(),r&&r.hide(),'sms'==o)O.hide(),n(e.validator,m);else O.show();d.attr('data-login',o);}).on('click','input[name="remember_me"]',function(){u.set(q,$(this).prop('checked')?1:0,I);}).on('click','.form-forget, .form-signup',function(i){var n=$(i.target).data('url'),o=[];if(o.push({key:'next',value:d.find('input[name="next"]').val()}),o.push({key:'mobile',value:d.find('input[name="mobile"]').val()}),o.push({key:'user_type',value:d.find('input[name="usertype"]:checked').val()}),e.activityVoiceRegister)o.push({key:'activity_voice',value:'1'});if(n+=t(o),$(this).is('.form-signup')&&e.registerPrefix)n=e.registerPrefix+encodeURIComponent(n);v.openLink(n);}).on('click','.sns-login .icon',function(){var e=$(this),t=e.data('way'),i=f.parse(d);location.href='/connect/login/'+t+'/'+i.usertype;}).on('click','.form-wechat .help',function(){d.find('#wechat-login').hide(),d.find('.wechat-help').show(),$(this).removeClass('help').addClass('scan').text('扫码登录');}).on('click','.form-wechat .scan',function(){d.find('#wechat-login').show(),d.find('.wechat-help').hide(),$(this).removeClass('scan').addClass('help').text('使用帮助');});},login:function(){var e=this,t=e.element,i=e.failNext,n=f.parse(t),o=decodeURIComponent(n.next);if(n.next=o,e.validator.validate()){if(u.get(q))u.set(j,h(n.mobile,S),I);else u.remove(j);var r,s=e.mobileInput.getMobile(),c={userType:n.usertype,mobile:s,rememberMe:n.remember_me,next:o};if('password'===e.loginWay){if(a&&!a.hidden)if(!a.validate())return;else c.captcha=a.getValue(),c.captchaName=a.captchaName;r='loginByPassword',c.password=n.password;}else r='loginBySms',c.code=n.verifycode;var l=function(t){var i=d.get('user');p.getUserBasicInfo().done(function(n){if(0===n.code){var o=n.data;if(o)i.id=o.user_id?parseInt(o.user_id,10):i.id,i.type=o.user_type?parseInt(o.user_type,10):i.type,i.name=o.user_name||i.name,i.number=o.user_number||i.number,i.mobile=o.mobile||i.mobile;if($.isFunction(e.onSuccess))e.onSuccess(t);}});};if(0==n.usertype){var v={type:'t_login',stype:'tpc_login_con',client:'PC'};WAT.send('http://click.genshuixue.com/gs.gif',v);}return p[r](c).done(function(t){var o=t.data||{};if(0===t.code)l(o);else if(null!=o.has_role){var r=n.usertype,c=r==O?A:O,u=r==O?'老师':'学生';if(n.username=s,e.wrongRoleText)new y({text:e.wrongRoleText,hasStudentRole:!1,next:i,onSuccess:e.onSuccess,switchRoleData:n});else{var f='<div class="msg-content-title">'+('确认要开通'+u+'身份吗\uFF1F')+'</div><div class="dialog-action"><button class="btn btn-primary btn-confirm">立即开通</button></div>',d=new m({title:'温馨提示',content:f,disposeOnHide:!0,width:420}),h=d.element;h.on('click','.btn-confirm',function(){d.hide(),p.sendInviteCode({role:r,formData:n}).done(function(e){if(0===e.code)new b({userType:c,status:'succ',onAfterHide:function(){l(e.data);}});else new b({userType:c,status:'err'});});});}}else if(1000070===t.code){if(!a)$(k).insertAfter('.form-group.form-password'),a=new C({element:$('.form-block.captcha'),captchaName:'signin',skipAuth:!1,autoValidate:!0});a.change(),a.show();}});}}},e.defaultOptions={onSuccess:function(e){location.href=e.url;}};var I={expires:720,secure:!0},q='LOGIN_USERNAME_REMEMBER',j='LOGIN_USERNAME',O=0,A=2;if(null==u.get(q))u.set(q,1,I);return e;}),define('common/component/MobileInput_8f8e780d3d',['require','exports','common/service_9c322508d3','cobble/ui/ComboBox','common/data/hotRegions_d442ddf09d','common/data/regionFlagPositions_e26d985ce0'],function(require){'use strict';function e(e){return'<li data-value="'+e.value+'" data-valuecode="'+e.valueCode+'" data-text="'+e.text+'" data-code="'+e.code+'" data-country-code="'+e.countryCode+'"><i class="icon icon-region-flag" style="background-position:0 '+l[e.countryCode]+'"></i>'+e.text+'</li>';}function t(t){return''+$.map(t,function(t){return e(t);}).join('')+'<li class="more">更多国家...</li>';}function i(t){return''+$.map(t,function(t){return'<li class="alphabet">'+t.text+'</li>'+$.map(t.list,function(t){return e(t);}).join('');}).join('');}function n(e,t,i){if('+86'!==e){var n=t.length;if(i)i.fields.mobile.rules.pattern=new RegExp('^\\d{'+(7-n)+','+(20-n)+'}$');}else if(i)i.fields.mobile.rules.pattern=/^1[3-9]\d{9}$/;}function o(e,t,i){var n=$.map(e,function(e,t){return{code:e.code,value:i?i+t:t,valueCode:e.value,text:e.text,countryCode:e.country_code};});return n.type=t,n;}function a(e){$.extend(this,e),this.init();}var r=require('common/service_9c322508d3'),s=require('cobble/ui/ComboBox'),c=require('common/data/hotRegions_d442ddf09d'),l=require('common/data/regionFlagPositions_e26d985ce0'),u=!1;return a.prototype={init:function(){var e=this,a=e.element;e.wrapper=a.find('.wrapper');var u=a.find('.flag'),p=a.find('.tel-code'),f=a.find('input[name="mobile"]');e.mobile=f;var d=new s({element:a.find('.tel-code-select'),button:a.find('.trigger'),menu:a.find('.dropdown-menu'),activeClass:'active',data:null,renderTemplate:function(e){if('hot'==e.type)return t(e);else return i(e);},onChange:function(t,i){if(u.css('background-position','0 '+l[i.countryCode]),e.value=i.valuecode,e.code=i.code,n(e.code,e.value,e.validator),p.text(i.code),$.isFunction(e.onChange))e.onChange();}});if(e.select=d,d.refresh({data:o(c,'hot')}),setTimeout(function(){d.setValue(0);}),d.element.on('click','.more',function(){r.getInternationalCode().done(function(e){if(0===e.code){var t=e.data,i=[],n=0;for(var a in t)i.push({text:a,list:o(t[a],'all',n)}),n+=t[a].length;d.refresh({data:i}),d.setValue(0),d.element.find('.dropdown-menu').animate({scrollTop:0},100,'linear');}});}),$.isFunction(e.onInputChange))f.on('change',e.onInputChange);if($.isFunction(e.onMobileChange))f.on('input',onMobileChange).on('propertychange',onMobileChange);},getValue:function(){return this.value;},getMobile:function(){var e;if(this.isInternational())e=this.value+this.mobile.val();else e=this.mobile.val();return $.trim(e);},isInternational:function(){return void 0===this.code?!1:'+86'!==this.code;},disableInternational:function(){this.wrapper.removeClass('enable-international'),this.wrapper.addClass('disable-international'),this.code='+86',n(this.code,'',this.validator),this.mobile.val('');},enableInternational:function(){if(this.wrapper.removeClass('disable-international'),this.wrapper.addClass('enable-international'),!u&&this.data)this.select.refresh({data:this.data.slice(1)}),u=!0;this.select.setValue(1,{force:!0}),this.mobile.val('');}},a;}),define('common/component/Rotatable_2030c1ef8f',['require','exports','cobble/util/browser'],function(require){function e(e){$.extend(this,e),this.init();}for(var t,n,o=require('cobble/util/browser'),a=document.getElementsByTagName('head')[0].style,r='transformProperty WebkitTransform OTransform msTransform MozTransform'.split(' '),s=0,c=r.length;c>s;s++)if(void 0!==a[r[s]])t=r[s];if(t)if(n=t.replace(/[tT]ransform/,'TransformOrigin'),'T'==n[0])n[0]='t';var l=1==o.ie&&'8.0'==o.version,u={};if(u.PhotoEffect=function(){if(t)return function(e,t){e.Wilq32={PhotoEffect:this},this._img=this._rootObj=this._eventObj=e,this._handleRotation(t);};else return function(e,t){if(this._img=e,this._onLoadDelegate=[t],this._rootObj=document.createElement('span'),this._rootObj.style.display='inline-block',this._rootObj.Wilq32={PhotoEffect:this},e.parentNode.insertBefore(this._rootObj,e),e.complete)this._Loader();else{var i=this;jQuery(this._img).bind('load',function(){i._Loader();});}};}(),u.PhotoEffect.prototype={_setupParameters:function(e){if(this._parameters=this._parameters||{},'number'!=typeof this._angle)this._angle=0;if('number'==typeof e.angle)this._angle=e.angle;if(this._parameters.animateTo='number'==typeof e.animateTo?e.animateTo:this._angle,this._parameters.step=e.step||this._parameters.step||null,this._parameters.easing=e.easing||this._parameters.easing||this._defaultEasing,this._parameters.duration=e.duration||this._parameters.duration||1000,this._parameters.callback=e.callback||this._parameters.callback||this._emptyFunction,this._parameters.center=e.center||this._parameters.center||['50%','50%'],'string'==typeof this._parameters.center[0])this._rotationCenterX=parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW;else this._rotationCenterX=this._parameters.center[0];if('string'==typeof this._parameters.center[1])this._rotationCenterY=parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH;else this._rotationCenterY=this._parameters.center[1];if(e.bind&&e.bind!=this._parameters.bind)this._BindEvents(e.bind);},_emptyFunction:function(){},_defaultEasing:function(e,t,i,n,o){return-n*((t=t/o-1)*t*t*t-1)+i;},_handleRotation:function(e,i){if(!t&&!this._img.complete&&!i)return void this._onLoadDelegate.push(e);if(this._setupParameters(e),this._angle==this._parameters.animateTo)this._rotate(this._angle);else this._animateStart();},_BindEvents:function(e){if(e&&this._eventObj){if(this._parameters.bind){var t=this._parameters.bind;for(var i in t)if(t.hasOwnProperty(i))jQuery(this._eventObj).unbind(i,t[i]);}this._parameters.bind=e;for(var i in e)if(e.hasOwnProperty(i))jQuery(this._eventObj).bind(i,e[i]);}},_Loader:function(){if(l)return function(){var e=this._img.width,t=this._img.height;this._imgWidth=e,this._imgHeight=t,this._img.parentNode.removeChild(this._img),this._vimage=this.createVMLNode('image'),this._vimage.src=this._img.src,this._vimage.style.height=t+'px',this._vimage.style.width=e+'px',this._vimage.style.position='absolute',this._vimage.style.top='0px',this._vimage.style.left='0px',this._aspectW=this._aspectH=1,this._container=this.createVMLNode('group'),this._container.style.width=e,this._container.style.height=t,this._container.style.position='absolute',this._container.style.top='0px',this._container.style.left='0px',this._container.setAttribute('coordsize',e-1+','+(t-1)),this._container.appendChild(this._vimage),this._rootObj.appendChild(this._container),this._rootObj.style.position='relative',this._rootObj.style.width=e+'px',this._rootObj.style.height=t+'px',this._rootObj.setAttribute('id',this._img.getAttribute('id')),this._rootObj.className=this._img.className,this._eventObj=this._rootObj;for(var i;i=this._onLoadDelegate.shift();)this._handleRotation(i,!0);};else return function(){this._rootObj.setAttribute('id',this._img.getAttribute('id')),this._rootObj.className=this._img.className,this._imgWidth=this._img.naturalWidth,this._imgHeight=this._img.naturalHeight;var e=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*e,this._height=3*e,this._aspectW=this._img.offsetWidth/this._img.naturalWidth,this._aspectH=this._img.offsetHeight/this._img.naturalHeight,this._img.parentNode.removeChild(this._img),this._canvas=document.createElement('canvas'),this._canvas.setAttribute('width',this._width),this._canvas.style.position='relative',this._canvas.style.left=-this._img.height*this._aspectW+'px',this._canvas.style.top=-this._img.width*this._aspectH+'px',this._canvas.Wilq32=this._rootObj.Wilq32,this._rootObj.appendChild(this._canvas),this._rootObj.style.width=this._img.width*this._aspectW+'px',this._rootObj.style.height=this._img.height*this._aspectH+'px',this._eventObj=this._canvas,this._cnv=this._canvas.getContext('2d');for(var t;t=this._onLoadDelegate.shift();)this._handleRotation(t,!0);};}(),_animateStart:function(){if(this._timer)clearTimeout(this._timer);this._animateStartTime=+new Date(),this._animateStartAngle=this._angle,this._animate();},_animate:function(){var e=+new Date(),t=e-this._animateStartTime>this._parameters.duration;if(t&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img){var i=this._parameters.easing(0,e-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate(~~(10*i)/10);}if(this._parameters.step)this._parameters.step(this._angle);var n=this;this._timer=setTimeout(function(){n._animate.call(n);},10);}if(this._parameters.callback&&t)this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj);},_rotate:function(){var e=Math.PI/180;if(l)return function(e){this._angle=e,this._container.style.rotation=e%360+'deg',this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+'px',this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+'px',this._container.style.top=this._rotationCenterY-this._imgHeight/2+'px',this._container.style.left=this._rotationCenterX-this._imgWidth/2+'px';};else if(t)return function(e){this._angle=e,this._img.style[t]='rotate('+e%360+'deg)',this._img.style[n]=this._parameters.center.join(' ');};else return function(t){this._angle=t,t=t%360*e,this._canvas.width=this._width,this._canvas.height=this._height,this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH),this._cnv.translate(this._rotationCenterX,this._rotationCenterY),this._cnv.rotate(t),this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY),this._cnv.scale(this._aspectW,this._aspectH),this._cnv.drawImage(this._img,0,0);};}()},l)u.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule('.rvml','behavior:url(#default#VML)');try{return!document.namespaces.rvml&&document.namespaces.add('rvml','urn:schemas-microsoft-com:vml'),function(e){return document.createElement('<rvml:'+e+' class="rvml">');};}catch(e){return function(e){return document.createElement('<'+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">');};}}();return e.prototype={constructor:e,init:function(){},rotate:function(e){if('undefined'!=typeof e)this.element.each(function(){if('number'==typeof e)e={angle:e};var t=[];if(!this.Wilq32||!this.Wilq32.PhotoEffect){var i=$.extend(!0,{},e),n=new u.PhotoEffect(this,i)._rootObj;t.push($(n));}else this.Wilq32.PhotoEffect._handleRotation(e);});},getRotateAngle:function(){var e=[];return this.element.each(function(){if(this.Wilq32&&this.Wilq32.PhotoEffect)e[i]=this.Wilq32.PhotoEffect._angle;}),e;},stopRotate:function(){this.element.each(function(){if(this.Wilq32&&this.Wilq32.PhotoEffect)clearTimeout(this.Wilq32.PhotoEffect._timer);});}},e;}),define('common/component/SaveButton_b1f301d041',['require'],function(){'use strict';function e(e){$.extend(this,e),this.init();}return e.prototype={init:function(){var e=this,t=e.element,i=t.html();if('BUTTON'!==t.prop('tagName'))throw new Error('SaveButton 必须使用 button 标签');var n=function(){var n=e.save();if(n)t.focus(),t.prop('disabled',!0),t.html(e.saveText||'正在保存...'),n.always(function(){setTimeout(function(){t.prop('disabled',!1),t.html(i);},10);});return!1;};if(t.click(n),e.form)e.form.submit(function(){return n(),!1;});}},e;}),define('common/data/hotRegions_d442ddf09d',['require','exports'],function(){return[{text:'中国',code:'+86',value:'',country_code:'CN'},{text:'中国香港',code:'+852',value:'00852',country_code:'HK'},{text:'中国澳门',code:'+853',value:'00853',country_code:'MO'},{text:'中国台湾',code:'+886',value:'00886',country_code:'TW'},{text:'美国',code:'+1',value:'001',country_code:'US'},{text:'加拿大',code:'+1',value:'001',country_code:'CA'},{text:'马来西亚',code:'+60',value:'0060',country_code:'MY'},{text:'澳大利亚',code:'+61',value:'0061',country_code:'AU'},{text:'日本',code:'+81',value:'0081',country_code:'JP'},{text:'韩国',code:'+82',value:'0082',country_code:'KR'},{text:'新加坡',code:'+65',value:'0065',country_code:'SG'},{text:'英国',code:'+44',value:'0044',country_code:'GB'},{text:'法国',code:'+33',value:'0033',country_code:'FR'},{text:'俄罗斯',code:'+7',value:'007',country_code:'RU'},{text:'印度',code:'+91',value:'0091',country_code:'IN'},{text:'泰国',code:'+66',value:'0066',country_code:'TH'},{text:'德国',code:'+49',value:'0049',country_code:'DE'}];}),define('common/data/regionFlagPositions_e26d985ce0',['require','exports'],function(){'use strict';return{AL:'-1034px',DZ:'-528px',AF:'-2311px',AR:'-2377px',AE:'-2223px',AW:'-792px',OM:'-2454px',AZ:'-1243px',AC:'-55px',EG:'-2201px',ET:'-2443px',IE:'-1969px',EE:'-2410px',AD:'-594px',AO:'-1947px',AI:'-1980px',AG:'-869px',AT:'-1331px',AU:'-1716px',MO:'-2597px',BB:'-1573px',PG:'-1485px',BS:'-363px',PK:'-2035px',PY:'-2344px',PS:'-1199px',BH:'-1496px',PA:'-847px',BR:'-770px',BY:'-1100px',BM:'-1914px',BG:'-2586px',MP:'-704px',BJ:'-1298px',BE:'0px',IS:'-1991px',BO:'-1650px',PR:'-473px',PL:'-1177px',BA:'-1584px',BW:'-2707px',BZ:'-484px',BT:'-1848px',BF:'-726px',BI:'-1892px',KP:'-1804px',GQ:'-1507px',DK:'-1386px',DE:'-2509px',TL:'-2784px',TG:'-605px',DO:'-1529px',DM:'-2432px',RU:'-660px',EC:'-1188px',ER:'-715px',FR:'-1012px',FO:'-1111px',PF:'-1705px',GF:'-2234px',MF:'-55px',PH:'-1815px',FI:'-1903px',CV:'-2652px',FK:'-2762px',GM:'-627px',CG:'-1793px',CD:'-1518px',CO:'-330px',CR:'-2090px',GD:'-2399px',GL:'-1760px',GE:'-858px',CU:'-748px',GP:'-407px',GU:'-2366px',GY:'-803px',KZ:'-1210px',HT:'-319px',KR:'-2245px',NL:'-1441px',BQ:'-2719px',SX:'-2773px',ME:'-2167px',HN:'-2156px',KI:'-374px',DJ:'-2101px',KG:'-1617px',GN:'-2575px',GW:'-1925px',CA:'-1375px',GH:'-2112px',GA:'-880px',KH:'-242px',CZ:'-2256px',ZW:'-2046px',CM:'-2057px',QA:'-462px',KY:'-308px',KM:'-1430px',CI:'-1661px',KW:'-2487px',HR:'-902px',KE:'-2630px',CK:'-2267px',CW:'-2729px',LV:'-1936px',LS:'-2190px',LA:'-451px',LB:'-1254px',LR:'-2068px',LY:'-132px',LT:'-1122px',LI:'-979px',RE:'-264px',LU:'-1474px',RW:'-2674px',RO:'-671px',MG:'-1287px',MT:'-1551px',MV:'-616px',MW:'-2145px',MY:'-1870px',ML:'-2520px',MK:'-1353px',MH:'-1144px',MQ:'-198px',MU:'-2179px',MR:'-253px',US:'-44px',AS:'-1562px',VI:'-1782px',MN:'-2553px',MS:'-583px',BD:'-1771px',PE:'-946px',FM:'-1738px',MM:'-11px',MD:'-2685px',MA:'-2333px',MC:'-913px',MZ:'-638px',MX:'-2024px',NA:'-1881px',ZA:'-2355px',SS:'-2741px',NP:'-110px',NI:'-154px',NE:'-550px',NG:'-2476px',NU:'-2079px',NO:'-836px',NF:'-209px',PW:'-231px',PT:'-517px',JP:'-429px',SE:'-385px',CH:'-1320px',SV:'-1639px',WS:'-2300px',RS:'-2465px',SL:'-737px',SN:'-2134px',CY:'-561px',SC:'-1045px',SA:'-33px',BL:'-1012px',ST:'-2388px',SH:'-495px',KN:'-99px',LC:'-1397px',SM:'-2123px',PM:'-1078px',VC:'-2619px',LK:'-2641px',SK:'-2212px',SI:'-1221px',SZ:'-2278px',SD:'-352px',SR:'-2663px',SO:'-1364px',SB:'-1067px',TJ:'-187px',TW:'-506px',TH:'-957px',TZ:'-2289px',TO:'-1089px',TC:'-1309px',TT:'-440px',TN:'-539px',TV:'-286px',TR:'-1606px',TM:'-2542px',TK:'-2751px',WF:'-1012px',VU:'-1265px',GT:'-935px',VE:'-1056px',BN:'-1683px',UG:'-1166px',UA:'-2002px',UY:'-2608px',UZ:'-1001px',ES:'-1155px',GR:'-165px',HK:'-2696px',SG:'-22px',NC:'-1276px',NZ:'-1540px',HU:'-682px',SY:'-1826px',JM:'-1727px',AM:'-176px',YE:'-1672px',IQ:'-649px',IR:'-2013px',IL:'-341px',IT:'-143px',IN:'-1694px',ID:'-1958px',GB:'-55px',VG:'-1408px',IO:'-55px',JO:'-1463px',VN:'-968px',ZM:'-1595px',TD:'-814px',GI:'-275px',CL:'-1342px',CF:'-1837px',CN:'-825px',NR:'-1749px',VA:'-2322px',FJ:'-1859px'};}),define('common/eventEmitter_8bcc038860',['require','exports'],function(require,exports){var e=$({});exports.emit=function(){e.trigger.apply(e,arguments);},exports.on=function(){e.on.apply(e,arguments);},exports.un=function(){e.off.apply(e,arguments);},exports.once=function(){e.one.apply(e,arguments);};}),define('common/form_2ef59f4d41',['require','exports','cobble/form/Validator'],function(require,exports){'use strict';function e(e){var t={},i=e.find('[name]');return i.each(function(){var e=this.name,i=this.value,n='radio'===this.type||'checkbox'===this.type;if(n){if(this.checked)t[e]=i;}else{var o=t[e];if(null==o)t[e]=i;else o=t[e]=[o],o.push(i);}}),$.each(t,function(e,i){t[e]=$.isArray(i)?i.join(','):$.trim(i);}),t;}function t(e,t){$.each(t,function(t,n){if(n){var o=e.find('[name="'+t+'"]'),a=o.closest('.form-group');a.removeClass('has-success').addClass('has-error');var r=a.find('.error');r.html(n),i.defaultOptions.errorPlacement(o,r);}});}var i=require('cobble/form/Validator');exports.parse=function(t){return e(t);},exports.get=function(i,n){return $.ajax({url:n,type:'get',dataType:'json',data:i.jquery?e(i):i}).done(function(e){if(e.code){var n=e.data;if(n)t(i,n);}return e;});},exports.post=function(i,n){return $.ajax({url:n,type:'post',dataType:'json',data:i.jquery?e(i):i}).done(function(e){if(e.code){var n=e.data;if(n)t(i,n);}return e;});};}),define('common/function/compressImage_1539d29a96',function(){function e(e,i,n,o,a){var r=0.05;if(o/a/(n/ i)>1+2*r)return'@1e_'+i+'w_1c_0i_1o_90Q_1x.'+e+'%7C0-'+r*i*a/o+'-'+i+'-'+n+'a.'+e.toLowerCase();else return t(e,i,n);}function t(e,t,i,n){return'@'+(n?0:1)+'e_'+t+'w_'+i+'h_1c_0i_1o_90Q_1x.'+e.toLowerCase();}return function(i){var n=i.url,o=n.split('.').pop();if('gif'===o)o='jpg';var a=i.width,r=i.height,s=i.rawWidth,c=i.rawHeight;if(a=Math.floor(a),r=Math.floor(r),null!=s&&null!=c)return s=Math.floor(s),c=Math.floor(c),n+e(o,a,r,s,c);else return n+t(o,a,r,i.noCrop);};}),define('common/function/rc4_c97a7cac84',['require','exports'],function(){'use strict';return function(e,t){for(var i=Array(256),n=Array(e.length),o=0;256>o;o++){i[o]=o;var a=(a+i[o]+t.charCodeAt(o%t.length))%256,r=i[o];i[o]=i[a],i[a]=r;}for(var o=0;o<e.length;o++)n[o]=e.charCodeAt(o);for(var s=0;s<n.length;s++){var o=(o+1)%256,a=(a+i[o])%256,r=i[o];i[o]=i[a],i[a]=r;var c=(i[o]+i[a]%256)%256;n[s]=String.fromCharCode(n[s]^i[c]);}return n.join('');};}),define('common/function/scale_330792fa50',function(){'use strict';return function(e,t){var i=e.width,n=e.height,o=t.width/ i;if(i=t.width,n*=o,n>t.height)o=t.height/n,n=t.height,i*=o;return i/e.width;};}),define('common/function/wechatQrcode_248248d034',['require','exports','module','../service_9c322508d3','cobble/util/url'],function(require){'use strict';var e=require('../service_9c322508d3'),t=require('cobble/util/url');return function(i,n){require(['js!https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js'],function(){e.getWechatInfo({type:n}).done(function(e){if(0===e.code){var n=e.data,o=n.host,a=t.getOrigin(o);if(0===a.indexOf('http:'))a='https'+a.substr(4);new WxLogin({id:i,appid:'wxc141277bb62cfd84',scope:'snsapi_login',redirect_uri:encodeURIComponent(o),state:n.redirect,style:'',href:a+'/asset/css/common/component/wechatQrcode.css'}),$('#'+i+' iframe').height(159);}});});};}),define('social/common/ModifyProfileLandingDialog_5da1060dca',['require','exports','cobble/ui/Dialog'],function(require){function e(e){e=$.extend({tpl:'no-nickname'},e);var i=new t({content:n[e.tpl],title:'温馨提示',width:402,skinClass:'modify-landing-dialog'});i.element.on('click','.btn-action',function(){i.hide(),window.open('/forum/userUploadAvatar','_blank');});}var t=require('cobble/ui/Dialog'),i=window.require.toUrl,n={'no-avatar':'<div class="text-center"><img width="88px" src="'+i('./img/social/empty_nickname.png')+'"/></div><div class="text-center tip"><span class="hilight">上传个人头像</span>后就可以玩转社区啦~</div><div class="text-center"><a href="javascript:void(0);" class="btn btn-primary btn-action">现在就去</a></div>','no-nickname':'<div class="text-center"><img width="88px" src="'+i('./img/social/empty_nickname.png')+'"/></div><div class="text-center tip"><span class="hilight">填写昵称</span>后就可以玩转社区啦~</div><div class="text-center"><a href="javascript:void(0);" class="btn btn-primary btn-action">现在就去</a></div>','duply-nickname':'<div class="text-center"><img width="88px" src="'+i('./img/teacher/comment_empty.png')+'"/></div><div class="text-center tip">我们的口号是\uFF1A不要撞衫\u3001拒绝重名</div><div class="text-center"><a href="javascript:void(0);" class="btn btn-primary btn-action">马上取个新名字</a></div>'};return e;}),define('social/common/pager_html',function(){return'{{ -- tpl:social-common-pager -- }}<%var pager = _this.pager || {};var page = pager.page || 1;var pageSize = pager.page_size;var count = pager.count || 0;var hideJump = pager.hide_jump;var showCount = pager.show_count || 4;var pageCount = Math.ceil(count/pageSize);if(showCount % 2 == 1){showCount = showCount - 1;}%><% if(pageCount > 1){ %><div class="pager-block"><div class="pager"><% if(page > 1){ %><a href="javascript:void(0);" data-page="<%= page-1 %>" rel="nofollow"><i class="icon icon-chevron-left"></i> 上一页</a><% } %><%var start = 1, end = pageCount;if(pageCount <= showCount + 1){start = 1;end = pageCount;} else if (pageCount <= page + showCount) {end = pageCount;start = pageCount - showCount;} else if (page <= showCount/2){start = 1;end = 1 + showCount;} else {start = page - showCount/2;end = page + showCount/2;}%><% if (start > 2){ %><a href="javascript:void(0);" data-page="1" rel="nofollow">1</a><b class="ellipsis">...</b><% } %><% for(var item=start; item <= end; item++){ %><% if(item != page){ %><a href="javascript:void(0);" data-page="<%= item %>" rel="nofollow"><%= item %></a><% } else { %><a class="active" href="javascript:void(0);" rel="nofollow"><%= item %></a><% } %><% }%><% if(end < pageCount){ %><b class="ellipsis">...</b><a href="javascript:void(0);" data-page="<%= pageCount %>" rel="nofollow"><%= pageCount %></a><% } %><% if(page < pageCount){ %><a href="javascript:void(0);" data-page="<%= page+1 %>" rel="nofollow">下一页 <i class="icon icon-chevron-right"></i></a><% } %></div><% if(!hideJump){ %><div class="pager-form"><b>共 <%= pageCount %> 页\uFF0C去第</b><input class="form-text small" type="text" onchange="var button = this.nextSibling.nextSibling;var page = this.value;button.href = \'javascript:void(0);\';button.removeAttribute(\'data-page\');if (/^\\d+$/.test(page) && parseInt(page, 10) >= 1 && parseInt(page, 10) <= <%= page_count %>) {button.setAttribute(\'data-page\', page);}else {this.select();}"/><b>页</b><a class="btn-default small">确定</a></div><% } %></div><% } %>{{ -- /tpl -- }}{{ -- tpl:social-common-report -- }}<div class="report-dialog"><diV class="row"><label>举报类型\uFF1A</label><label><input type="radio" value="1" name="type"/>广告</label><label><input type="radio" value="2" name="type"/>色情</label><label><input type="radio" value="3" name="type"/>反动</label><label><input type="radio" value="4" name="type"/>欺诈</label></div><div class="actions"><button class="btn btn-primary" disabled="disabled">确认举报</button></div></div>{{ -- /tpl -- }}{{ -- tpl:social-common-ban -- }}<div class="ban-dialog"><div class="row"><div class="row-label"><label>封禁时间\uFF1A</label></div><div class="row-content"><label><input type="radio" value="1" name="time"/>1天</label><label><input type="radio" value="3" name="time"/>3天</label><label><input type="radio" value="10" name="time"/>10天</label></div></div><div class="row"><div class="row-label"><label>封禁理由\uFF1A</label></div><div class="row-content"><div class="reason"><label><input type="radio" value="辱骂管理员\uFF0C对管理员工作造成干扰" name="reason"/>辱骂管理员\uFF0C对管理员工作造成干扰</label></div><div class="reason"><label><input type="radio" value="垃圾广告营销" name="reason"/>垃圾广告营销</label></div><div class="reason"><label><input type="radio" value="传播有害信息" name="reason"/>传播有害信息</label></div></div></div><div class="row actions"><button class="btn btn-primary" disabled="disabled">确认禁言</button></div></div>{{ -- /tpl -- }}';}),define('social/common/proxyService_0644e1105b',['require','exports','common/service_9c322508d3','common/store_a1a35b3dfc','common/component/LoginDialog_da294c651f'],function(require,exports){var e=require('common/service_9c322508d3'),t=require('common/store_a1a35b3dfc'),i=require('common/component/LoginDialog_da294c651f');exports.checkLogin=function(){var n=$.Deferred(),o=t.get('user');if(o&&o.id)n.resolve(e);else new i({onSuccess:function(){window.location.reload();}});return n.promise();};}),define('social/common/up_e534af04c3',function(){function e(e){var t=this;$.extend(this,{container:$(document),selector:'.up-btn',upedSelector:'uped',tpl:'<b style="position:absolute;left:50%;margin-left:-10px;z-index:1;">+1</b>'},e),t.init();}return e.prototype.init=function(){var e=this;e.container.on('click',e.selector,function(){var t=$(this),i=$(e.tpl),n=0;if(t.hasClass(e.upedSelector))n=1,i.text('-1');t.css('position','relative'),t.append(i),i.animate({top:'-38px',opacity:0},800,function(){t.css('position',''),i.remove();});});},e.prototype.updateStatus=function(e){var t=this;if(e.hasClass(t.upedSelector))e.removeClass(t.upedSelector);else e.addClass(t.upedSelector);},e;}),define('social/detail_2f5b6d5e40',['require','exports','./detail/commentList_8efb17c32c','./detail/tools_c25942eaeb','./detail/commentEditor_0545966f6c','./detail/groupInfo_2837996b46','common/eventEmitter_8bcc038860','common/component/Editor_c19cafc60f','cobble/ui/Dialog','common/store_a1a35b3dfc','common/service_9c322508d3','./common/proxyService_0644e1105b','./common/ModifyProfileLandingDialog_5da1060dca','./common/up_e534af04c3','tpl!social/detail_06f065e086.tpl','tpl!social/common/pager_8de893f3ed.tpl'],function(require,exports){var e=require('./detail/commentList_8efb17c32c'),t=(require('./detail/tools_c25942eaeb'),require('./detail/commentEditor_0545966f6c')),i=(require('./detail/groupInfo_2837996b46'),require('common/eventEmitter_8bcc038860')),n=require('common/component/Editor_c19cafc60f'),o=require('cobble/ui/Dialog'),a=require('common/store_a1a35b3dfc'),r=(require('common/service_9c322508d3'),require('./common/proxyService_0644e1105b')),s=require('./common/ModifyProfileLandingDialog_5da1060dca'),c=require('./common/up_e534af04c3');require('tpl!social/detail_06f065e086.tpl'),require('tpl!social/common/pager_8de893f3ed.tpl'),exports.init=function(){var l=a.get('threadId'),u=a.get('groupId'),p=a.get('threadUserId'),f=(a.get('user'),{800053:function(){new s({tpl:'duply-nickname'});},800054:function(){new s({tpl:'no-nickname'});},800055:function(){new s({tpl:'no-avatar'});}}),d=new c({container:$('.post-actions')}),m=$('#main .content');m.find('.post-content-holder').html(a.get('threadContent'));var h=new n({element:m.find('.fast-reply'),maxLength:100,autoHint:1,flexHeight:!1});$(document).on('click','[data-need-intercept="1"]',function(){var e=$(this);return r.checkLogin().done(function(){window.open(e.data('href'),'_blank');}),!1;}),$('.fast-reply').on('click','.placeholder',function(){$('.fast-reply').find('textarea').focus();}),$('.actions').find('.action').last().addClass('last'),$('.fast-reply .btn').click(function(){var e=$(this);e.prop('disabled',!0),setTimeout(function(){e.prop('disabled',!1);},3000),r.checkLogin().done(function(t){var n=$.trim(h.getValue());if(n)if(n.length<=100)t.postComment({threadId:l,content:n},f).done(function(t){if(!t.code)i.emit('comment-saved',t.data),h.setValue(''),e.prop('disabled',!1);});else alert('评论不能超过100个字符','温馨提示');else alert('评论不能为空','温馨提示');});}),i.on('comment-saved',function(t,i){var n={user_id:'',avatar:'',user_name:'',zans:0,time_tip:'刚刚'},o=a.get('user');i.user_id=o.id,i.avatar=o.avatar,i.user_name=o.name,e.addComment($.extend(n,i)),success('评论成功'),$('html, body').animate({scrollTop:$('.comment-item:last').offset().top+'px'},1000);}),i.on('detail-comment',function(){t.focus();}),i.on('detail-write',function(){window.location.href='/forum/addThread?group_id='+u;}),$('.post-actions').on('click','.up-btn',function(){var e=$(this),t=0,i=e.find('.num'),n=+$.trim(i.text());if(!e.hasClass('active'))t=1;r.checkLogin().done(function(o){o.setThumbs({id:l,postType:1,op:t}).done(function(o){if(!o.code)if(d.updateStatus(e),t)i.text(n+1),e.addClass('active');else i.text(n-1),e.removeClass('active');});});}).on('click','.star-btn',function(){var e=$(this),t=0;if(!e.hasClass('active'))t=1;r.checkLogin().done(function(i){i.setCollect({threadId:l,op:t}).done(function(i){if(!i.code)if(t)success('收藏成功'),e.addClass('active');else success('取消收藏成功'),e.removeClass('active');});});}),m.find('.post-header-wrapper').on('click','.set-black',function(){var e=$(this),t=(e.data('status'),{id:l,postType:1});r.checkLogin().done(function(e){var i=new o({title:'举报帖子',content:Simplite.render('social-common-report'),width:428,heigt:192});i.element.on('click','.btn',function(){if(t.reasonType=$('input[name="type"]:checked').val(),t.reasonType)e.setBlack(t).done(function(e){if(!e.code)i.hide(),success('举报成功');});}).on('click','input',function(){i.element.find('.btn-primary').prop('disabled',!1);});});}).on('click','.set-top',function(){var e=$(this),t=e.data('status'),i=$('.post-main').find('.content-label.top');t='1'==t?0:1;var n={threadId:l,op:t};r.checkLogin().done(function(o){o.setTop(n).done(function(n){if(!n.code)e.data('status',t),e.text('1'==t?'取消置顶':'置顶'),success('0'==t?'取消置顶成功':'置顶成功'),i['0'==t?'hide':'show']();});});}).on('click','.set-good',function(){var e=$(this),t=e.data('status'),i=$('.post-main').find('.content-label.better');t='1'==t?0:1;var n={threadId:l,op:t};r.checkLogin().done(function(o){o.setGood(n).done(function(n){if(!n.code)e.data('status',t),e.text('1'==t?'取消加精':'加精'),success('0'==t?'取消加精成功':'加精成功'),i['0'==t?'hide':'show']();});});}).on('click','.set-ban',function(){var e=$(this),t={userId:p,groupId:u};r.checkLogin().done(function(i){var n=new o({title:'封禁账号',content:Simplite.render('social-common-ban'),width:535,heigt:345});n.element.on('click','.btn',function(){t.len=24*n.element.find(':radio[name="time"]:checked').val()*3600,t.reason=n.element.find(':radio[name="reason"]:checked').val(),i.setBan(t).done(function(t){if(!t.code)n.hide(),e.removeClass('set-ban').addClass('baned').text('已禁言');});}).on('click',':radio',function(){var e=n.element.find(':radio[name="time"]:checked').val(),t=n.element.find(':radio[name="reason"]:checked').val();e&&t&&n.element.find('.btn-primary').prop('disabled',!1);});});}).on('click','.delete',function(){r.checkLogin().done(function(e){confirm('您确定要删除该帖子么\uFF1F','温馨提示').done(function(){var t={threadId:l};e.deleteThread(t).done(function(e){if(!e.code)success('删除成功'),window.location.href='/forum/threadBrowse/'+u;});});});});};}),define('social/detail_html',function(){return'{{ -- tpl:social-detail-commentImgs -- }}<% for(var i = 0, offset = _this.start, len = _this.data.length; i < len; i++){ %><li class="img-wrapper" data-index="<%= i + offset %>"><img src="" width="80" height="60"><i class="icon icon-recycle-bin"></i></li><% } %>{{ -- /tpl -- }}{{ -- tpl:social-detail-reply -- }}<li class="reply-item-wrapper" data-user="<%= _this.user_name %>" data-user-id="<%= _this.user_id %>" data-comment-id="<%= _this.comment_id %>"><div class="reply-item"><div class="reply-user-avatar"><a href="<%= _this.homepage %>" target="_blank"><img src="<%= _this.avatar %>@1e_30w_30h_1c_0i_1o_90Q_1x.jpeg" width="30" height="30"/></a></div><div class="reply-content"><p><a class="user-name" href="<%= _this.homepage %>"><%= _this.user_name %></a><% if(_this.commented_user){ %><span class="action-label">回复</span><a class="user-name" href="<%= _this.commented_user.homepage %>" target="_blank"><%=# _this.commented_user.user_name %></a><% } %>\uFF1A<%=# _this.content %></p><div class="reply-actions"><span class="action reply-to-action" data-need-login="1" data-action="reply-to-action">回复</span><span class="action"><%= _this.time_tip %></span><% if((_this.permission && _this.permission.is_admin == \'1\') || (_this.user && _this.user.id == _this.user_id)){ %><span class="action delete-reply-action" data-need-login="1" data-action="delete-reply-action">删除</span><% } %></div></div></div></li>{{ -- /tpl -- }}{{ -- tpl:social-detail-comment -- }}<li class="comment-item" data-post-id="<%= _this.post_id %>" data-user-id="<%= _this.user_id %>"><div class="user-avatar"><a href="<%= _this.homepage %>" target="_blank"><img src="<%= _this.avatar %>@1e_48w_48h_1c_0i_1o_90Q_1x.jpeg" width="48" height="48"/></a></div><% if (!_this.comment_list) { _this.comment_list = {}; } %><div class="comment-content <%= (_this.comment_list.list && _this.comment_list.list.length)  ? \' open-reply\' : \'\' %>"><h4 class="comment-info"><a class="user-name" href="<%= _this.homepage %>" target="_blank"><%= _this.user_name %></a><% if(_this.user_role == 0){ %><span class="user-label">师</span><% } %><span class="icon icon-level"></span><span class="time-tip">发表于 <%= _this.time_tip %></span><% if(_this.floor){ %><span class="comment-top <%= (+_this.floor <= 3) ? (\'top\' + _this.floor ) : \' topx\' %>"><% if(_this.floor > 3){ %><%= (\'#\' + _this.floor) %><% } else { %><%= [\'沙发\', \'板凳\', \'地板\'][_this.floor-1] %><% } %></span><% } %></h4><p class="comment-des"><%= _this.content %></p><% if (_this.photo_list){ %><div class="comment-photo-box photo-list-wrapper"><ul class="comment-photo-list photo-list"><% for(var j = 0, max = _this.photo_list.length; j < max; j++){ %><li class="photo-item" data-image="<%= _this.photo_list[j].img %>"data-horizontal="<%= _this.photo_list[j].img %>"data-vertical="<%= _this.photo_list[j].img %>"data-hheight="<%= _this.photo_list[j].height %>"data-vheight="<%= _this.photo_list[j].height %>"><img src="<%= _this.photo_list[j].img %>@1e_80w_60h_1c_0i_1o_90Q_1x" /></li><% } %></ul><div class="comment-photo-player" style="display:none;"><ul class="photo-action"><li class="packup"><i class="photo-icon photo-packup"></i>收起</li><li class="sourse"><i class="photo-icon photo-sourse"></i>原图</li><li class="left"><i class="photo-icon photo-left"></i>向左转</li><li class="right"><i class="photo-icon photo-right"></i>向右转</li></ul><div class="photo-wrapper"><div class="floater" style=""></div><img src="" class="rotate-img"></div><div class="photo-name"></div></div></div><% } %><div class="comment-actions"><span class="action up-action up-btn <% if(_this.is_zan == \'1\'){ %> uped active<% } %>" data-need-login="1" data-action="up-action"><i class="icon icon-thumbs-up"></i><b class="num"><%= (_this.zans||0) %></b></span><span class="action reply-action" data-need-login="1" data-action="reply-action">回复</span><% if(_this.permission && _this.permission.is_admin == 1){ %><span class="action close-action" data-need-login="1" data-action="close-action">禁言</span><span class="divider">|</span><span class="action delete-action" data-need-login="1" data-action="delete-action">删除</span><% } else if (_this.user && _this.user.id == _this.user_id){ %><span class="action delete-action" data-need-login="1" data-action="delete-action">删除</span><% } %></div><div class="reply-list-wrapper"><div class="reply-list"><ul><%var tmp;var list = _this.comment_list.list || [];for(var i = 0, len = list.length; i < len; i++){tmp = list[i];tmp.user = _this.user;tmp.permission = _this.permission;include(\'social-detail-reply\', tmp);}%></ul><div class="reply-form"><textarea class="hide" data-init=""></textarea><div class="reply-form-actions"><div class="form-hint"></div><button class="btn btn-primary btn-reply" data-need-login="1" data-action="btn-reply">回复</button></div></div><% if(_this.comment_list.has_more == \'1\'){ %><span class="more-reply" data-page="1">查看更多回复</span><% } %></div></div></div></li>{{ -- /tpl -- }}{{ -- tpl:social-detail-commentList -- }}<ul class="comment-list"><% var tmp; %><%for(var i = 0, len = _this.data.length; i < len; i++){tmp = _this.data[i];tmp.permission = _this.permission;tmp.user = _this.loginUser;include(\'social-detail-comment\', tmp);}%></ul>{{ -- /tpl -- }}';}),define('social/detail/commentEditor_0545966f6c',['require','exports','teacherCenter/component/MultiplyFileUpload_bce97eae54','common/component/Editor_c19cafc60f','common/service_9c322508d3','common/store_a1a35b3dfc','../common/proxyService_0644e1105b','../common/ModifyProfileLandingDialog_5da1060dca'],function(require,exports){var e,t,i,n,o=require('teacherCenter/component/MultiplyFileUpload_bce97eae54'),a=require('common/component/Editor_c19cafc60f'),r=(require('common/service_9c322508d3'),require('common/store_a1a35b3dfc'),require('../common/proxyService_0644e1105b')),s=require('../common/ModifyProfileLandingDialog_5da1060dca'),c={800053:function(){new s({tpl:'duply-nickname'});},800054:function(){new s({tpl:'no-nickname'});},800055:function(){new s({tpl:'no-avatar'});}},l={error:function(){return function(e,n){var o=n.fileItem.file,a=i.getCurrentFileIndex(o.name),r=t.find('.img-wrapper[data-index="'+a+'"]');r.removeClass('loading-bg').addClass('error-bg');};},success:function(){return function(e,n){var o=$.parseJSON(n.responseText),a=n.fileItem.file,r=i.getCurrentFileIndex(a.name),s=t.find('.img-wrapper[data-index="'+r+'"]');if(s.removeClass('loading-bg'),0===o.code){var c=o.data,l=i.getFile(r);l.id=c.id,l.success=!0,s.find('img').attr('src',c.url+'@1e_80w_60h_1c_0i_1o_90Q_1x');}else s.addClass('error-bg');};},start:function(){return function(e,n){var o=n.fileItem.file,a=i.getCurrentFileIndex(o.name),r=t.find('.img-wrapper[data-index="'+a+'"]');r.addClass('loading-bg');};},complete:function(){return function(){if(i.increment(),i.getCurrentOffset()===i.getImages().length)e.reset();};}},u=function(){var e,i,n=t.find('.comment-img-list-wrapper'),o=n.find('.comment-img-list'),a=function(){e=[],i=0,o.html(''),n.hide();},r=function(t){if(t)for(var n,o=e.length-1;o>=i;o--)if((n=e[o])&&n.name===t)return o;},s=function(t){return e[t];},c=function(t){for(var a=Simplite.render('social-detail-commentImgs',{data:t,start:i}),r=0,s=t.length;s>r;r++)e.push(t[r]);o.append(a),n.show();},l=function(){i++;},u=function(){return i;},p=function(t){var i=t?[]:e.slice(0);if(t)$.each(e,function(e,n){if(t(n))i.push(n);});return i;},f=function(t){delete e[t].success;};return{freshUpload:a,getCurrentFileIndex:r,addToContainer:c,increment:l,getCurrentOffset:u,getImages:p,removeImage:f,getFile:s};},p='.fileUploadDialog';exports.init=function(s,f){t=$(this),i=u(),i.freshUpload(),n=new a({element:t.find('.comment-content'),maxLength:500,autoHint:20,flexHeight:!1}),e=new o({element:t.find('.comment-show-photos input'),action:'/user/previewImage',fileName:'attachment',onchange:function(t){i.addToContainer(t),e.upload();}}),e.on('uploadError'+p,l.error()).on('uploadSuccess'+p,l.success()).on('uploadStart'+p,l.start()).on('uploadComplete'+p,l.complete()),t.find('.comment-actions .btn').click(function(){var e=[],t={threadId:f.threadId},o=$(this);if(o.prop('disabled',!0),setTimeout(function(){o.prop('disabled',!1);},3000),i.getImages(function(t){return t.success&&e.push(t.id);}),t.content=n.getValue(),t.photoList=e.join(','),t.content)if(t.content.length<=500)if(e.length<=6)r.checkLogin().done(function(e){e.postComment(t,c).done(function(e){if(!e.code)n.setValue(''),i.freshUpload(),s.emit('comment-saved',e.data);o.prop('disabled',!1);});});else alert('最多只能保存6张\uFF0C请删除多余图片','温馨提示');else alert('评论不能超过500个字','温馨提示');else alert('评论不能为空','温馨提示');}),t.find('.comment-img-list-wrapper').on('click','.icon-recycle-bin',function(){var e=$(this).closest('.img-wrapper'),t=e.data('index');if(0==e.siblings('.img-wrapper').length)e.closest('.comment-attach').find('.comment-img-list-wrapper').hide();i.removeImage(t),e.remove();}),t.on('click','.placeholder',function(){n.textarea.focus();});},exports.focus=function(){n.textarea.focus();};}),define('social/detail/commentList_8efb17c32c',['require','exports','common/service_9c322508d3','common/store_a1a35b3dfc','cobble/ui/Dialog','../common/proxyService_0644e1105b','../common/up_e534af04c3','../common/ModifyProfileLandingDialog_5da1060dca','common/component/Rotatable_2030c1ef8f','common/component/ImageDialog_992ca63b0f'],function(require,exports){function e(e){if('number'==typeof e.selectionStart)e.selectionStart=e.selectionEnd=e.value.length;else if('undefined'!=typeof e.createTextRange){e.focus();var t=e.createTextRange();t.collapse(!1),t.select();}}var t,i,n,o,a,r=require('common/service_9c322508d3'),s=require('common/store_a1a35b3dfc'),c=require('cobble/ui/Dialog'),l=require('../common/proxyService_0644e1105b'),u=require('../common/up_e534af04c3'),p=require('../common/ModifyProfileLandingDialog_5da1060dca'),f={time_tip:'刚刚',user_id:0,user_role:0,user_name:'',avatar:''},d=require('common/component/Rotatable_2030c1ef8f'),m=require('common/component/ImageDialog_992ca63b0f'),h=1,v={},g={800053:function(){new p({tpl:'duply-nickname'});},800054:function(){new p({tpl:'no-nickname'});},800055:function(){new p({tpl:'no-avatar'});}},x=function(e,t){return r.postReply(t,g).done(function(t){if(!t.code){var i=s.get('user'),n=t.data;f.user_name=i.name,f.user_id=i.id,f.user_role=i.type,f.avatar=i.avatar,n=$.extend(!0,f,n),n.permission=o,n.user=a;var r=Simplite.render('social-detail-reply',n);e.find('.reply-list ul').append(r);}});};exports.addComment=function(e){var i,n=t.find('.comment-list-wrapper .comment-list');e.permission=o,e.user=a,i=Simplite.render('social-detail-comment',e),n.find('.no-comment').remove(),n.append(i);},exports.fresh=function(e){var e=$.extend(!0,{page:1,page_size:25,count:0,hide_jump:!0,thread_id:i},e);r.getCurrentCommentList(e).done(function(i){e.count=+i.data.pager.count;var n=Simplite.render('social-detail-commentList',{data:i.data.list||[],permission:o,loginUser:a});n+=Simplite.render('social-common-pager',{pager:e}),t.find('.comment-list-wrapper').html(n);});},exports.init=function(p,f){i=f.threadId,n=f.groupId,t=$(this),o=s.get('permission'),a=s.get('user')||{};var g=new u({container:t}),b={'reply-action':function(){var e=$(this).closest('.comment-content'),t=e.find('.reply-form');e.addClass('open-reply'),t.show(),t.data('toCommentId',''),e.find('textarea').removeClass('hide').focus().data('init','');},'up-action':function(){var e=$(this),t=0,i=e.find('.num'),n=+$.trim(i.text()),o=e.closest('.reply-item-wrapper');0==o.length&&(o=e.closest('.comment-item'));var a=o.data('commentId')||o.data('postId');if(!e.hasClass('active'))t=1;r.setThumbs({id:a,postType:2,op:t}).done(function(o){if(!o.code)if(g.updateStatus(e),t)i.text(n+1),e.addClass('active');else i.text(n-1),e.removeClass('active');});},'reply-to-action':function(){var t=$(this).closest('.reply-item-wrapper'),i=t.closest('.reply-list').find('.reply-form'),n=t.data(),o=i.find('textarea'),a='回复'+n.user+'\uFF1A';o.val(a).removeClass('hide').data('init',a),i.show().data('toCommentId',n.commentId),o.focus(),e(o[0]);},'btn-reply':function(){var e=$(this),t=e.closest('.reply-form'),i=t.closest('.reply-list-wrapper'),n=i.closest('.comment-item'),o=t.find('textarea');if(o.hasClass('hide'))t.data('toCommentId',''),o.removeClass('hide');else{var a=$.trim(o.val().replace(o.data('init'),''));if(e.prop('disabled',!0),setTimeout(function(){e.prop('disabled',!1);},3000),a.length<=500)if(a.length>0)x(i,{postId:n.data('postId'),commentId:t.data('toCommentId')||'',content:a}).done(function(i){if(!i.code)o.val(''),o.addClass('hide'),t.find('.form-hint').hide();e.prop('disabled',!1);});else alert('回复不能为空','温馨提示');else alert('回复不能超过500个字','温馨提示');}},'delete-action':function(){var e=$(this).closest('.comment-item'),t=e.data('postId');confirm('您确定要删除该评论么\uFF1F','温馨提示').done(function(){var i={postId:t};r.deletePost(i).done(function(t){if(!t.code)e.remove(),success('删除成功');});});},'delete-reply-action':function(){var e=$(this).closest('.reply-item-wrapper'),t=e.closest('.comment-content'),i=e.data('commentId');confirm('您确定要删除该回复么\uFF1F','温馨提示').done(function(){var n={commentId:i};r.deleteReply(n).done(function(i){if(!i.code){if(1==t.find('.reply-list').find('.reply-item-wrapper').length)t.removeClass('open-reply');e.remove(),success('删除成功');}});});},'close-action':function(){var e=$(this).closest('.comment-item'),t={userId:e.data('userId'),groupId:n},i=new c({title:'封禁账号',content:Simplite.render('social-common-ban'),width:535,heigt:345});i.element.on('click','.btn',function(){t.len=24*i.element.find(':radio[name="time"]:checked').val()*3600,t.reason=i.element.find(':radio[name="reason"]:checked').val(),r.setBan(t).done(function(e){if(!e.code)i.hide();});}).on('click',':radio',function(){var e=i.element.find(':radio[name="time"]:checked').val(),t=i.element.find(':radio[name="reason"]:checked').val();e&&t&&i.element.find('.btn-primary').prop('disabled',!1);});}},y=function(){var e=$(this),t=e.val().length,i=e.data('init').length,n=500-t+i,o=e.closest('.reply-form').find('.form-hint');if(n>=0)o.text('还可以输入'+n+'个字').show(),o.css('color','');else o.text('已超出'+(0-n)+'个字').show(),o.css('color','#f00');};t.on('click','a[data-page]',function(){var e=$(this),t=e.data('page');return exports.fresh({page:t}),!1;}).on('click','[data-need-login="1"]',function(){var e=this;l.checkLogin().done(function(){var t=$(e).data('action');b[t].call(e);});}).on('click','.more-reply',function(){var e=$(this),t=e.closest('.reply-list'),i=t.closest('.comment-item').data('postId'),n=e.data('page')||1;r.getMoreReply({postId:i,page:n,pageSize:10}).done(function(i){if(!i.code&&i.data.list&&i.data.list.length){var r,s='',c=i.data.list,l=0;if('1'==n)l=3;for(var u=c.length;u>l;l++)r=c[l],r.permission=o,r.user=a,s+=Simplite.render('social-detail-reply',r);if(t.find('ul').append(s),'1'==i.data.has_more)e.data('page',n+1);else e.hide();}});}).on('input','.reply-form textarea',y).on('propertychange','.reply-form textarea',y).on('click','.photo-item',function(){var e=$(this),i=e.parent().parent();i.find('.photo-item').removeClass('active'),e.addClass('active');var n=(e.data('vertical'),e.data('vheight'),e.data('horizontal')),o=e.data('hheight'),a=e.data('name'),r=i.find('.photo-wrapper'),s=r.find('.floater'),c=r.find('.rotate-img'),l=i.find('.photo-name');c.attr('src',n),r.css({width:400,height:300}),s.css({'margin-bottom':'-'+Math.floor(o/2)+'px'}),l.text(a),i.find('.comment-photo-player').show();t.find('.photo-wrapper').find('img');if(!r.data('rotateindex'))v[h]=new d({element:r.find('.rotate-img'),callback:function(){}}),r.data('rotateindex',h),h++;else{var u=r.data('rotateindex');v[u].rotate({animateTo:0,duration:1});}r.data('rotateangle',0);}).on('click','.packup',function(){var e=$(this),t=e.parent().parent().parent();t.find('.comment-photo-player').hide(),t.find('.photo-item').removeClass('active');}).on('click','.sourse',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-item'),n=t.find('.active'),o=i.index(n),a=i.map(function(e,t){return{url:$(t).data('image'),title:$(t).data('name')};});new m({data:a,index:o});}).on('click','.left',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-wrapper'),n=i.data('rotateindex'),o=i.data('rotateangle'),a=o-90;v[n].rotate({animateTo:a,duration:1}),i.data('rotateangle',a);}).on('click','.right',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-wrapper'),n=i.data('rotateindex'),o=i.data('rotateangle'),a=o+90;v[n].rotate({animateTo:a,duration:1}),i.data('rotateangle',a);}).on('click','.photo-wrapper',function(){var e=$(this);e.parent().find('.packup').click();});};}),define('social/detail/groupInfo_2837996b46',['require','exports','common/service_9c322508d3'],function(require,exports){var e,t=require('common/service_9c322508d3');exports.init=function(i,n){e=$(this),e.on('click','.join-btn',function(){var e=$(this);t.joinGroup({groupId:n.groupId}).done(function(t){if(!t.code)e.removeClass('join-btn').addClass('join-status').html('已加入');});});};}),define('social/detail/tools_c25942eaeb',['require','exports'],function(require,exports){var e,t;exports.init=function(i){e=$(this),t=i,e.on('click','.tool',function(){var e=$(this),i='detail-'+e.data('tool');t.emit(i);});};}),define('teacherCenter/component/MultiplyFileUpload_bce97eae54',['require','exports','cobble/ui/Uploader','../netdisk/formatFiles_6a8cbc02aa'],function(require){function e(e){$.extend(this,{maxSize:10485760,accept:['jpg','png','jpeg']},e),this.init();}var t=require('cobble/ui/Uploader'),i=require('../netdisk/formatFiles_6a8cbc02aa'),n=function(e,t){for(var i=e.length-1;i>=0;i--)if(e[i].file.size>t)e.splice(i,1);for(i=e.length-1;i>=0;i--)e[i].index=i;},o=function(e,t){for(var i=t.join('#'),n=e.length-1;n>=0;n--)if(-1===i.indexOf(e[n].file.type))e.splice(n,1);for(n=e.length-1;n>=0;n--)e[n].index=n;};return e.prototype.init=function(){var e=this,a=e.data||{};if('photo'==e.watermark)a.watermark=1;else if('cert'==e.watermark)a.watermark=2;var r=function(e,t,n){if(o(e,n.accept),0===e.length)alert('图片格式非png\u3001jpg\u3001jpeg将无法上传成功','温馨提示'),n.uploader.reset();else if(t>e.length)alert({content:'图片格式非png\u3001jpg\u3001jpeg将无法上传成功',title:'温馨提示',buttons:[{text:'确定',type:'primary',handler:function(){if('function'==typeof n.onchange)n.onchange(i(e));this.hide();}}]});else if('function'==typeof n.onchange)n.onchange(i(e));};e.uploader=new t({element:e.element,multiple:!0,accept:e.accept,action:e.action,data:a,ignoreError:!0,xhrProps:e.xhrProps,fileName:e.fileName||'',onFileChange:function(){var t,i=this.getFiles(),o=i.length;if(n(i,e.maxSize),t=i.length,0===t)alert('图片大小超过'+Math.round(e.maxSize/1048576)+'M将无法上传成功','温馨提示'),e.uploader.reset();else if(o>t)alert({content:'图片大小超过'+Math.round(e.maxSize/1048576)+'M将无法上传成功',title:'温馨提示',buttons:[{text:'确定',type:'primary',handler:function(){r(i,t,e),this.hide();}}]});else r(i,t,e);}});},e.prototype.upload=function(){this.uploader.upload();},e.prototype.on=function(){return this.uploader.on.apply(this.uploader,arguments),this;},e.prototype.off=function(){return this.uploader.off.apply(this.uploader,arguments),this;},e.prototype.dispose=function(){this.uploader.reset(),this.uploader.dispose();},e.prototype.reset=function(){this.uploader.reset();},e;}),define('teacherCenter/netdisk/formatFileSize_fe93900919',['require','exports','cobble/function/divide'],function(require){'use strict';function e(e){var i;if(1024>e)i='B';else if(e<Math.pow(1024,2))e=t(e,1024),i='KB';else if(e<Math.pow(1024,3))e=t(e,Math.pow(1024,2)),i='MB';else e=t(e,Math.pow(1024,3)),i='GB';return e.toFixed(1)+i;}var t=require('cobble/function/divide');return e;}),define('teacherCenter/netdisk/formatFileType_0ac2d41d9b',['require','exports'],function(){'use strict';function e(e){if(-1!=$.inArray(e,t))return e;else return'other';}var t=['folder','other','txt','zip','rar','doc','docx','ppt','pptx','xls','xlsx','pdf','jpg','png','mp4','avi','flv','mkv','mp3','wav','all'];return e;}),define('teacherCenter/netdisk/formatFiles_6a8cbc02aa',['require','exports','./formatFileSize_fe93900919','./formatFileType_0ac2d41d9b'],function(require){'use strict';function e(e){return $.map(e,function(e){return{name:e.file.name,sizeStr:t(e.file.size),size:e.file.size,type:i(e.file.type)};});}var t=require('./formatFileSize_fe93900919'),i=require('./formatFileType_0ac2d41d9b');return e;});