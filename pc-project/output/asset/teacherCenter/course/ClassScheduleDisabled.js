define('cobble/form/Validator',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return i.init(this,e);}function t(e,t){if(e.length>0){var r=e[0].element;if(r.is(':hidden'))r=r.parent();var n=r.offset().top;if(t>0)n-=t;window.scrollTo(window.scrollX,n);}}function r(e){var t=$.Deferred();return $.when.apply($,e).done(function(){t.resolve(arguments);}),t;}var n=require('../function/jquerify'),i=require('../function/lifeCycle');e.prototype={constructor:e,type:'Validator',init:function(){var t=this,r=t.element,n='FORM'===r.prop('tagName')?r:r.find('form');if(n.length>0)n.attr('novalidate','novalidate').on('submit'+u,$.proxy(t.validate,t));$.each(t.fields,function(t,n){var i=r.find('[name="'+t+'"]'),u=n.type;if(!u)u=n.type=i.attr('type')||'text';var o=n.rules;if(!o)o=n.rules={};var s=e.type[u]||[];$.each(s,function(e,t){if(null==o[t]){var r=a[t];if($.isFunction(r))o[t]=r(i,n);}});});var i=t.groupSelector;if(r.on('focusin'+u,function(e){var r=$(e.target).closest(i),n=[t.successClass,t.errorClass,t.requiredClass].join(' ');r.removeClass($.trim(n));}),t.realtime)r.on('focusout'+u,function(e){var r=$(e.target),n=r.prop('name');if(!n)r=r.find('[name]'),n=r.prop('name');if(n)t.validate(n);});},validate:function(e,n){var i=this,a=i.emit('beforeValidate');if(!a.isDefaultPrevented()){var u,o=i.element,s=i.groupSelector;if('string'===$.type(e))e=[e];if($.isArray(e))u=$.map(e,function(e){return o.find('[name="'+e+'"]').closest(s);});else if(u=o.find(s),'boolean'===$.type(e))n=e;var f=[],l=[];$.each(u,function(e,t){var r=i.validateGroup($(t));if(r){if(r.promise)l.push(r),r=r.data;$.merge(f,r);}});var e=[],c=[],m=function(){if($.each(f,function(t,r){if(r.error)c.push(r);e.push(r.element.prop('name'));}),n)t(c,i.scrollGap);i.emit('afterValidate',{fields:e,errors:c});};if(l.length>0)return r(l).done(m);else return m(),0===c.length;}},validateGroup:function(t){if(t.is(':visible')){var n=this,i=[],a=[],u=[];if(t.find('[name]').each(function(t){var r,o,s=this,f=s.name,l=s.value,c=s.disabled,m=$(s);if(!c){var d=n.fields[f];if(d){r=!0,d=$.extend(!0,{},d),d.form=n.element,d.value=$.trim(l);var p;if($.each(e.type[d.type]||[],function(t,r){var n=e.rule[r](d);if(n===!1)return p=r,!1;else if(''===d.value&&'required'===r)return!1;}),p){var h=d.errors;if(h)o=h[p];if(!o)throw new Error(f+' 字段 '+p+' 类型错误信息未定义');}else if($.isFunction(d.custom)){var v=$.Deferred(),g=d.custom(m,function(e){v.resolve(e);});o=null==g||g.done?v:g;}}}if(r)if(t=i.push({element:m,error:o}),o&&o.promise)a.push(o),u.push(t-1);}),a.length>0){var o=r(a).done(function(e){$.each(e,function(e,t){i[u[e]].error=t;}),n.refreshGroup(t,i);});return o.data=i,o;}else return n.refreshGroup(t,i),i;}},refreshGroup:function(e,t){var r=this,n=r.successClass,i=r.errorClass;$.each(t,function(t,a){var u,o=a.element,s=a.error,f=r.errorSelector;if(f)u=e.find(f).eq(t);if(s&&'string'===$.type(s)){if(e.removeClass(n).addClass(i),u){var l=r.renderTemplate;if($.isFunction(l))s=l({text:s},r.errorTemplate);u.html(s).show();var c=r.errorPlacement;if($.isFunction(c))c(o,u);}}else if(a.error='',e.removeClass(i).addClass(n),u)u.html('').hide();});},dispose:function(){var e=this;i.dispose(e),e.element.off(u),e.element=null;}},n(e.prototype),e.defaultOptions={realtime:!1,scrollGap:100,groupSelector:'.form-group',successClass:'has-success',errorClass:'has-error',errorSelector:'.error',errorTemplate:'<i class="icon icon-times-circle"></i>&nbsp;${text}',requiredClass:'has-required',requiredSelector:'.required',requiredTemplate:'${text}',renderTemplate:function(e,t){return t.replace(/\${(\w+)}/g,function(t,r){return e[r]||'';});},errorPlacement:function(e,t){if('hidden'===e.prop('type'))e=e.parent();t.css({position:'static',width:'auto'});var r=t.outerWidth(!0)+5;t.css({position:'absolute',width:r});var n=e.parent();if(n.is('.placeholder-wrapper'))e=n;var i=e.position();t.css({left:i.left+e.outerWidth()-37,top:i.top-t.outerHeight()+8});}},e.type={text:['required','pattern','min','max','minlength','maxlength'],hidden:['required'],password:['required','pattern','minlength','maxlength','equals'],number:['required','pattern','min','max','step'],range:['required','pattern','min','max','step'],tel:['required','pattern'],url:['required','pattern'],email:['required','pattern'],mobile:['required','pattern'],money:['required','pattern','min','max'],idcard:['required','pattern'],'int':['required','pattern','min','max'],internationalMobile:['required','pattern']},e.rule={required:function(e){if(e.value.length>0)return!0;else if(e.rules.required)return!1;},pattern:function(e){var t=e.rules.pattern;if(t)return t.test(e.value);else return void 0;},minlength:function(e){var t=e.rules.minlength;if($.isNumeric(t))return e.value.length>=+t;else return void 0;},maxlength:function(e){var t=e.rules.maxlength;if($.isNumeric(t))return e.value.length<=+t;else return void 0;},min:function(e){var t=e.rules.min;if($.isNumeric(t))return e.value>=+t;else return void 0;},max:function(e){var t=e.rules.max;if($.isNumeric(t))return e.value<=+t;else return void 0;},step:function(e){var t=e.rules.step;if($.isNumeric(t)){var r=e.rules.min||1;return(e.value-r)%t===0;}},equals:function(e){var t=e.rules.equals;if(t){var r=e.form.find('[name="'+t+'"]');return e.value===$.trim(r.val());}}},e.pattern={number:/^[\d.]*$/,'int':/^\d+$/,url:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,tel:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,mobile:/^1[3-9]\d{9}$/,email:/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,money:/^[\d.]*$/,idcard:/(^\d{15}$)|(^\d{17}([0-9]|X)$)/i,internationalMobile:/^\d{7,20}$/};var a={required:function(e){return'required'===e.attr('required');},pattern:function(t,r){var n=t.attr('pattern')||e.pattern[r.type];if('string'===$.type(n))n=new RegExp(n);return n;},minlength:function(e){return e.attr('minlength');},maxlength:function(e){return e.attr('maxlength');},min:function(e){return e.attr('min');},max:function(e){return e.attr('max');},step:function(e){return e.attr('step');},equals:function(e){return e.attr('equals');}},u='.cobble_form_validator';return e;}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var t=$.prototype,r={on:function(){return t.on.apply(e(this),arguments),this;},off:function(){return t.off.apply(e(this),arguments),this;},emit:function(r,n){var i=this,a=e(i);if(a){if(!r[$.expando])r='string'===$.type(r)?$.Event(r):$.Event(null,r);r.cobble=i;var u=[r];if(n)u.push(n);var o=i[$.camelCase('on-'+r.type)];if($.isFunction(o)&&o.apply(i,u)===!1)r.preventDefault();if(!r.isPropagationStopped())t.trigger.apply(a,u);return r;}},before:function(t){e(this).before(t);},after:function(t){e(this).after(t);},appendTo:function(t){e(this).appendTo(t);},prependTo:function(t){e(this).prependTo(t);}};return function(e){$.each(r,function(t,r){if(null==e[t])e[t]=r;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,t){var r=e.constructor,n='__cobble__'+r.prototype.type,i=t.element;if(i&&i.data(n))e=i.data(n);else if($.extend(e,r.defaultOptions,t),e.init(),i)i.data(n,e);return e;},exports.dispose=function(e){var t='__cobble__'+e.constructor.prototype.type,r=e.element;if(r)r.removeData(t);};}),define('cobble/util/date',['require','exports','module'],function(require,exports){'use strict';exports.parse=function(e,t,r){var n=!1;if($.isNumeric(e)&&$.isNumeric(t)&&$.isNumeric(r))n=!0;else if(1===arguments.length)if(n=!0,$.isPlainObject(e))r=e.date,t=e.month,e=e.year;else if('string'===$.type(e)){var i=e.split('-');e=i[0],t=i[1],r=i[2];}if(n)if(t>=1&&12>=t&&r>=1&&31>=r)return new Date(e,t-1,r);},exports.stringify=function(e){if('number'===$.type(e))e=new Date(e);var t=e.getFullYear(),r=e.getMonth()+1,e=e.getDate();if(10>r)r='0'+r;if(10>e)e='0'+e;return[t,r,e].join('-');},exports.simplify=function(e){if('number'===$.type(e))e=new Date(e);return{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),day:e.getDay()};},exports.getWeekFirstDay=function(e,t){if('number'===$.type(e))e=new Date(e);var r=e.getDay();return r=r>=t?r:r+7,new Date(e.getTime()-(r-t)*exports.DAY);},exports.getWeekLastDay=function(e,t){return e=exports.getWeekFirstDay(e,t),e.setTime(e.getTime()+6*exports.DAY),e;},exports.getMonthFirstDay=function(e){var t='number'===$.type(e)?e:e.getTime();return e=new Date(t),e.setDate(1),e;},exports.getMonthLastDay=function(e){var t='number'===$.type(e)?e:e.getTime();return e=new Date(t),e.setDate(1),e.setMonth(e.getMonth()+1),e.setDate(0),e;},exports.prevMonth=function(e){var t='number'===$.type(e)?e:e.getTime();return e=new Date(t),e.setDate(1),e.setTime(e.getTime()-exports.WEEK),e;},exports.nextMonth=function(e){var t='number'===$.type(e)?e:e.getTime();return e=new Date(t),e.setDate(28),e.setTime(e.getTime()+exports.WEEK),e;},exports.prevWeek=function(e){return exports.subtract(e,7);},exports.nextWeek=function(e){return exports.add(e,7);},exports.add=function(e,t){if('date'===$.type(e))e=e.getTime();return new Date(e+t*exports.DAY);},exports.subtract=function(e,t){if('date'===$.type(e))e=e.getTime();return new Date(e-t*exports.DAY);},exports.DAY=86400000,exports.WEEK=7*exports.DAY;}),define('cobble/util/time',['require','exports','module'],function(require,exports){'use strict';exports.parse=function(e,t,r){var n=!1;if($.isNumeric(e)&&$.isNumeric(t)){if(n=!0,!$.isNumeric(r))r=0;}else if(1===arguments.length)if('string'===$.type(e)){var i=e.split(':');if(i.length>1&&i.length<4)n=!0,e=+$.trim(i[0]),t=+$.trim(i[1]),r=+$.trim(i[2]);}else if($.isPlainObject(e))n=!0,r=e.second||0,t=e.minute||0,e=e.hour;if(n)if(e>=0&&23>=e&&t>=0&&59>=t&&r>=0&&59>=r){var a=new Date();return a.setHours(e),a.setMinutes(t),a.setSeconds(r),a;}},exports.stringify=function(e,t){var r=e.getHours(),n=e.getMinutes(),i=e.getSeconds();if(10>r)r='0'+r;if(10>n)n='0'+n;if(10>i)i='0'+i;var a=[];if(!t)t={hour:!0,minute:!0};if(t.hour)a.push(r);if(t.minute)a.push(n);if(t.second)a.push(i);return a.join(':');},exports.simplify=function(e){return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()};},exports.add=function(e,t){var r=0;if('number'===$.type(t.hour))r+=exports.HOUR*t.hour;if('number'===$.type(t.minute))r+=exports.MINUTE*t.minute;if('number'===$.type(t.second))r+=exports.SECOND*t.second;return new Date(e.getTime()+r);},exports.subtract=function(e,t){var r=0;if('number'===$.type(t.hour))r+=exports.HOUR*t.hour;if('number'===$.type(t.minute))r+=exports.MINUTE*t.minute;if('number'===$.type(t.second))r+=exports.SECOND*t.second;return new Date(e.getTime()-r);},exports.SECOND=1000,exports.MINUTE=60*exports.SECOND,exports.HOUR=60*exports.MINUTE;}),define('common/form_2ef59f4d41',['require','exports','cobble/form/Validator'],function(require,exports){'use strict';function e(e){var t={},r=e.find('[name]');return r.each(function(){var e=this.name,r=this.value,n='radio'===this.type||'checkbox'===this.type;if(n){if(this.checked)t[e]=r;}else{var i=t[e];if(null==i)t[e]=r;else i=t[e]=[i],i.push(r);}}),$.each(t,function(e,r){t[e]=$.isArray(r)?r.join(','):$.trim(r);}),t;}function t(e,t){$.each(t,function(t,n){if(n){var i=e.find('[name="'+t+'"]'),a=i.closest('.form-group');a.removeClass('has-success').addClass('has-error');var u=a.find('.error');u.html(n),r.defaultOptions.errorPlacement(i,u);}});}var r=require('cobble/form/Validator');exports.parse=function(t){return e(t);},exports.get=function(r,n){return $.ajax({url:n,type:'get',dataType:'json',data:r.jquery?e(r):r}).done(function(e){if(e.code){var n=e.data;if(n)t(r,n);}return e;});},exports.post=function(r,n){return $.ajax({url:n,type:'post',dataType:'json',data:r.jquery?e(r):r}).done(function(e){if(e.code){var n=e.data;if(n)t(r,n);}return e;});};}),define('teacherCenter/course/ClassScheduleDisabled',['require','exports','common/form_2ef59f4d41','cobble/util/date','cobble/util/time'],function(require){'use strict';function e(e){$.extend(this,e),this.init();}var t=require('common/form_2ef59f4d41'),r=require('cobble/util/date'),n=require('cobble/util/time');return e.prototype={init:function(){{var e=this;e.element;}e.setIndex(e.index),e.refresh();},refresh:function(){var e=this.data,t=this.element;if(this.element.find('input[name]').each(function(t,r){var n=$(r).prop('name');$(r).val(e[n]);}),e.organization.is_organization)t.find('.is-org').show();var i=new Date(1000*e.begin_time),a=new Date(1000*e.end_time),u=r.stringify(i),o=n.stringify(i),s=n.stringify(a);if(t.find('.course-date').html(u),t.find('.begin-time').html(o),t.find('.end-time').html(s),t.find('.content').html(e.content),e.organization.is_organization)t.find('.teacher-name').html(e.teacher.display_name);},getData:function(){var e=t.parse(this.element.find('.schedule-form'));return{data:e};},setIndex:function(e){this.index=e,this.element.find('.label').html('第'+e+'节'),this.element.data('index',e);}},e;});