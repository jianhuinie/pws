define("cobble/util/etpl",function(){function t(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}function e(){this.raw=[],this.length=0}function n(){return"___"+A++}function r(t,e){var n=new Function;n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}function i(t){return D[t]}function o(t){return'"'+t.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function s(t){return t.replace(/[\^\[\]\$\(\)\{\}\?\*\.\+]/g,function(t){return"\\"+t})}function a(t){var e=arguments;return t.replace(/\{([0-9]+)\}/g,function(t,n){return e[n-0+1]})}function p(t){return t=t.replace(/^\s*\*/,""),a('gv({0},["{1}"])',o(t),t.replace(/\[['"]?([^'"]+)['"]?\]/g,function(t,e){return"."+e}).split(".").join('","'))}function c(t,e,n,r,i,o){for(var s=n.length,a=t.split(e),p=0,c=[],l=0,h=a.length;h>l;l++){var u=a[l];if(l){var f=1;for(p++;;){var d=u.indexOf(n);if(0>d){c.push(p>1&&f?e:"",u);break}if(p=r?p-1:0,c.push(p>0&&f?e:"",u.slice(0,d),p>0?n:""),u=u.slice(d+s),f=0,0===p)break}if(0===p)i(c.join("")),o(u),c=[]}else u&&o(u)}if(p>0&&c.length>0)o(e),o(c.join(""))}function l(t,e,n){var r,i=[],s=e.options,a="",h="",u="",f="";if(n)a="ts(",h=")",u=I,f=_,r=s.defaultFilter;return c(t,s.variableOpen,s.variableClose,1,function(t){if(n&&t.indexOf("|")<0&&r)t+="|"+r;var o=t.indexOf("|"),s=(o>0?t.slice(0,o):t).replace(/^\s+/,"").replace(/\s+$/,""),c=o>0?t.slice(o+1):"",d=0===s.indexOf("*"),g=[d?"":a,p(s),d?"":h];if(c){c=l(c,e);for(var y=c.split("|"),v=0,m=y.length;m>v;v++){var E=y[v];if(/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(E)){if(g.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3)g.push(",",RegExp.$3);g.push(")")}}}i.push(u,g.join(""),f)},function(t){i.push(u,n?o(t):t,f)}),i.join("")}function h(t,e){this.value=t,this.engine=e}function u(t,e){this.value=t,this.engine=e,this.children=[],this.cloneProps=[]}function f(t,e){var n=t.stack,r=e?n.find(function(t){return t instanceof e}):n.bottom();if(r){for(var i;(i=n.top())!==r;){if(!i.autoClose)throw new Error(i.type+" must be closed manually: "+i.value);i.autoClose(t)}r.close(t)}return r}function d(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*(\(\s*master\s*=\s*([a-z0-9\/_-]+)\s*\))?\s*/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.master=RegExp.$3,this.name=RegExp.$1,u.call(this,t,e),this.blocks={}}function g(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,u.call(this,t,e),this.cloneProps=["name"]}function y(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,u.call(this,t,e),this.cloneProps=["name","state","blocks"],this.blocks={}}function v(t,e){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.expr=RegExp.$2,u.call(this,t,e),this.cloneProps=["name","expr"]}function m(t,e){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.args=RegExp.$3,u.call(this,t,e),this.cloneProps=["name","args"]}function E(t,e){if(!/^\s*([a-z0-9\/_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.name=RegExp.$1,this.args=RegExp.$3,u.call(this,t,e),this.cloneProps=["name","args"]}function x(t,e){var n=new RegExp(a("^\\s*({0}[\\s\\S]+{1})\\s+as\\s+{0}([0-9a-z_]+){1}\\s*(,\\s*{0}([0-9a-z_]+){1})?\\s*$",s(e.options.variableOpen),s(e.options.variableClose)),"i");if(!n.test(t))throw new Error("Invalid "+this.type+" syntax: "+t);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,u.call(this,t,e),this.cloneProps=["list","item","index"]}function R(t,e){u.call(this,t,e)}function b(t,e){R.call(this,t,e)}function w(t,e){u.call(this,t,e)}function $(t,e){e.target=t;var n=e.engine,r=t.name;if(n.targets[r])switch(n.options.namingConflict){case"override":n.targets[r]=t,e.targets.push(r);case"ignore":break;default:throw new Error("Target exists: "+r)}else n.targets[r]=t,e.targets.push(r)}function k(t,e){F[t]=e,e.prototype.type=t}function P(e){this.options={commandOpen:"<!--",commandClose:"-->",commandSyntax:/^\s*(\/)?([a-z]+)\s*(?::([\s\S]*))?$/,variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.targets={},this.filters=t({},O)}function C(t,n){function r(){var t;if(d.length>0&&(t=d.join(""))){var e=new h(t,n);if(e.beforeAdd(l),p.top().addChild(e),d=[],n.options.strip&&l.current instanceof u)e.value=t.replace(/^[\x20\t\r]*\n/,"");l.current=e}}var i,o=n.options.commandOpen,s=n.options.commandClose,a=n.options.commandSyntax,p=new e,l={engine:n,targets:[],stack:p,target:null},d=[];return c(t,o,s,0,function(t){var e=a.exec(t);if(e&&(i=F[e[2].toLowerCase()])&&"function"==typeof i){r();var p=l.current;if(n.options.strip&&p instanceof h)p.value=p.value.replace(/\r?\n[\x20\t]*$/,"\n");if(e[1])p=f(l,i);else{if(p=new i(e[3],n),"function"==typeof p.beforeOpen)p.beforeOpen(l);p.open(l)}l.current=p}else if(!/^\s*\/\//.test(t))d.push(o,t,s);i=null},function(t){d.push(t)}),r(),f(l),l.targets}e.prototype={push:function(t){this.raw[this.length++]=t},pop:function(){if(this.length>0){var t=this.raw[--this.length];return this.raw.length=this.length,t}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(t){for(var e=this.length;e--;){var n=this.raw[e];if(t(n))return n}}};var A=178245,D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},O={html:function(t){return t.replace(/[&<>"']/g,i)},url:encodeURIComponent,raw:function(t){return t}},B='var r="";',I="r+=",_=";",z="return r;";if("undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8)B="var r=[],ri=0;",I="r[ri++]=",z='return r.join("");';h.prototype={getRendererBody:function(){var t=this.value,e=this.engine.options;if(!t||e.strip&&/^\s*$/.test(t))return"";else return l(t,this.engine,1)},clone:function(){return this}},u.prototype={addChild:function(t){this.children.push(t)},open:function(t){var e=t.stack.top();e&&e.addChild(this),t.stack.push(this)},close:function(t){if(t.stack.top()===this)t.stack.pop()},getRendererBody:function(){for(var t=[],e=this.children,n=0;n<e.length;n++)t.push(e[n].getRendererBody());return t.join("")},clone:function(){for(var t=new this.constructor(this.value,this.engine),e=0,n=this.children.length;n>e;e++)t.addChild(this.children[e].clone());for(var e=0,n=this.cloneProps.length;n>e;e++){var r=this.cloneProps[e];t[r]=this[r]}return t}};var L='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';r(d,u),r(g,u),r(y,u),r(v,u),r(m,u),r(E,u),r(x,u),r(R,u),r(b,R),r(w,R);var j={READING:1,READED:2,APPLIED:3,READY:4};y.prototype.applyMaster=d.prototype.applyMaster=function(t){function e(t){var r=t.children;if(r instanceof Array)for(var i=0,o=r.length;o>i;i++){var s=r[i];if(s instanceof g&&n[s.name])s=r[i]=n[s.name];e(s)}}if(this.state>=j.APPLIED)return 1;var n=this.blocks,r=this.engine.targets[t];if(r&&r.applyMaster(r.master))return this.children=r.clone().children,e(this),this.state=j.APPLIED,1;else return void 0},d.prototype.isReady=function(){function t(r){for(var i=0,o=r.children.length;o>i;i++){var s=r.children[i];if(s instanceof y){var a=e.targets[s.name];n=n&&a&&a.isReady(e)}else if(s instanceof u)t(s)}}if(this.state>=j.READY)return 1;var e=this.engine,n=1;if(this.applyMaster(this.master))return t(this),n&&(this.state=j.READY),n;else return void 0},d.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var t=new Function("data","engine",[L,B,this.getRendererBody(),z].join("\n")),e=this.engine;return this.renderer=function(n){return t(n,e)},this.renderer}return null},d.prototype.open=function(t){f(t),u.prototype.open.call(this,t),this.state=j.READING,$(this,t)},v.prototype.open=E.prototype.open=function(t){t.stack.top().addChild(this)},g.prototype.open=function(t){u.prototype.open.call(this,t),(t.imp||t.target).blocks[this.name]=this},b.prototype.open=function(t){var e=new w;e.open(t);var n=f(t,R);n.addChild(this),t.stack.push(this)},w.prototype.open=function(t){var e=f(t,R);e.addChild(this),t.stack.push(this)},y.prototype.open=function(t){this.parent=t.stack.top(),this.target=t.target,u.prototype.open.call(this,t),this.state=j.READING,t.imp=this},E.prototype.close=v.prototype.close=function(){},y.prototype.close=function(t){u.prototype.close.call(this,t),this.state=j.READED,t.imp=null},d.prototype.close=function(t){u.prototype.close.call(this,t),this.state=this.master?j.READED:j.APPLIED,t.target=null},y.prototype.autoClose=function(t){var e=this.parent.children;e.push.apply(e,this.children),this.children.length=0;for(var n in this.blocks)this.target.blocks[n]=this.blocks[n];this.blocks={},this.close(t)},E.prototype.beforeOpen=y.prototype.beforeOpen=v.prototype.beforeOpen=x.prototype.beforeOpen=m.prototype.beforeOpen=g.prototype.beforeOpen=R.prototype.beforeOpen=h.prototype.beforeAdd=function(t){if(!t.stack.bottom()){var e=new d(n(),t.engine);e.open(t)}},y.prototype.getRendererBody=function(){return this.applyMaster(this.name),u.prototype.getRendererBody.call(this)},E.prototype.getRendererBody=function(){return a("{0}engine.render({2},{{3}}){1}",I,_,o(this.name),l(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(t,e,n){return(e||"")+o(n)+":"}))},v.prototype.getRendererBody=function(){if(this.expr)return a("v[{0}]={1};",o(this.name),l(this.expr,this.engine));else return""},R.prototype.getRendererBody=function(){return a("if({0}){{1}}",l(this.value,this.engine),u.prototype.getRendererBody.call(this))},w.prototype.getRendererBody=function(){return a("}else{{0}",u.prototype.getRendererBody.call(this))},x.prototype.getRendererBody=function(){return a('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',n(),l(this.list,this.engine),o(this.index||n()),o(this.item),n(),n(),u.prototype.getRendererBody.call(this))},m.prototype.getRendererBody=function(){var t=this.args;return a("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",B,z,I,_,u.prototype.getRendererBody.call(this),o(this.name),t?","+l(t,this.engine):"")};var F={};k("target",d),k("block",g),k("import",y),k("use",E),k("var",v),k("for",x),k("if",R),k("elif",b),k("else",w),k("filter",m),P.prototype.config=function(e){t(this.options,e)},P.prototype.compile=P.prototype.parse=function(t){if(t){var e=C(t,this);if(e.length)return this.targets[e[0]].getRenderer()}return new Function('return ""')},P.prototype.getRenderer=function(t){var e=this.targets[t];if(e)return e.getRenderer();else return void 0},P.prototype.render=function(t,e){var n=this.getRenderer(t);if(n)return n(e);else return""},P.prototype.addFilter=function(t,e){if("function"==typeof e)this.filters[t]=e};var S=new P;return S.Engine=P,S}),define("teacher/component/CategoryEditor",["require","exports","cobble/util/etpl"],function(require){"use strict";function t(t){$.extend(this,t),this.init()}var e=require("cobble/util/etpl"),n='<div class="categry-editor"><div class="error-tip" style="display: none">名称已存在</div><div class="editor-wrapper"><input class="input-text" value="${data.name}" type="text" name="cateName" maxlength="20" placeholder="最多20个字"/><span class="sure-btn">确定</span><span class="cancel-btn">取消</span></div></div>';return t.prototype.init=function(){return this.renderFunc=e.compile(n),this},t.prototype.edit=function(t,e){var n=function(t){$(document).off("click",n),r.editorElement&&r.editorElement.remove(),r.cancel&&r.cancel(),t.stopPropagation()};if(this.data=$.extend({id:"",name:""},e),t)this.editorElement&&this.editorElement.remove(),this.editorElement=$(this.renderFunc({data:this.data})),t.append(this.editorElement);if(this.editorElement){var r=this;this.editorElement.on("click",function(t){return t.stopPropagation(),!1}).on("click",".sure-btn",function(t){if($(document).off("click",n),r.syncData(),r.validate())r.save&&r.save(r.data);return t.stopPropagation(),!1}).on("click",".cancel-btn",function(t){return $(document).off("click",n),r.editorElement&&r.editorElement.remove(),r.cancel&&r.cancel(),t.stopPropagation(),!1}).find(".input-text").focus().select(),$(document).on("click",n)}return this},t.prototype.onsave=function(t){return this.save=function(e){this.editorElement&&this.editorElement.remove(),t&&t(e)},this},t.prototype.oncancel=function(t){return this.cancel=function(){t&&t()},this},t.prototype.syncData=function(){return this.data.name=$.trim(this.editorElement.find(".input-text").val()),this.data},t.prototype.validate=function(){if(!this.data.name)return this.editorElement.find(".error-tip").text("请输入分类名称").show(),!1;if(this.categoryList)for(var t,e=0,n=this.categoryList.length;n>e;e++)if(t=this.categoryList[e],this.data.id!=t.id&&t.name==this.data.name)return this.editorElement.find(".error-tip").text("名称已存在").show(),!1;return!0},t.prototype.setAllCategory=function(t){this.categoryList=t},t.prototype.getId=function(t){if(this.categoryList)for(var e,n=0,r=this.categoryList.length;r>n;n++)if(e=this.categoryList[n],e.id==t)return e},t});