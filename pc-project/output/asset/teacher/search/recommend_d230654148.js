define('cobble/form/Validator',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return i.init(this,e);}function r(e,r){if(e.length>0){var t=e[0].element;if(t.is(':hidden'))t=t.parent();var n=t.offset().top;if(r>0)n-=r;window.scrollTo(window.scrollX,n);}}function t(e){var r=$.Deferred();return $.when.apply($,e).done(function(){r.resolve(arguments);}),r;}var n=require('../function/jquerify'),i=require('../function/lifeCycle');e.prototype={constructor:e,type:'Validator',init:function(){var r=this,t=r.element,n='FORM'===t.prop('tagName')?t:t.find('form');if(n.length>0)n.attr('novalidate','novalidate').on('submit'+a,$.proxy(r.validate,r));$.each(r.fields,function(r,n){var i=t.find('[name="'+r+'"]'),a=n.type;if(!a)a=n.type=i.attr('type')||'text';var u=n.rules;if(!u)u=n.rules={};var l=e.type[a]||[];$.each(l,function(e,r){if(null==u[r]){var t=o[r];if($.isFunction(t))u[r]=t(i,n);}});});var i=r.groupSelector;if(t.on('focusin'+a,function(e){var t=$(e.target).closest(i),n=[r.successClass,r.errorClass,r.requiredClass].join(' ');t.removeClass($.trim(n));}),r.realtime)t.on('focusout'+a,function(e){var t=$(e.target),n=t.prop('name');if(!n)t=t.find('[name]'),n=t.prop('name');if(n)r.validate(n);});},validate:function(e,n){var i=this,o=i.emit('beforeValidate');if(!o.isDefaultPrevented()){var a,u=i.element,l=i.groupSelector;if('string'===$.type(e))e=[e];if($.isArray(e))a=$.map(e,function(e){return u.find('[name="'+e+'"]').closest(l);});else if(a=u.find(l),'boolean'===$.type(e))n=e;var s=[],f=[];$.each(a,function(e,r){var t=i.validateGroup($(r));if(t){if(t.promise)f.push(t),t=t.data;$.merge(s,t);}});var e=[],c=[],p=function(){if($.each(s,function(r,t){if(t.error)c.push(t);e.push(t.element.prop('name'));}),n)r(c,i.scrollGap);i.emit('afterValidate',{fields:e,errors:c});};if(f.length>0)return t(f).done(p);else return p(),0===c.length;}},validateGroup:function(r){if(r.is(':visible')){var n=this,i=[],o=[],a=[];if(r.find('[name]').each(function(r){var t,u,l=this,s=l.name,f=l.value,c=l.disabled,p=$(l);if(!c){var d=n.fields[s];if(d){t=!0,d=$.extend(!0,{},d),d.form=n.element,d.value=$.trim(f);var m;if($.each(e.type[d.type]||[],function(r,t){var n=e.rule[t](d);if(n===!1)return m=t,!1;else if(''===d.value&&'required'===t)return!1;}),m){var v=d.errors;if(v)u=v[m];if(!u)throw new Error(s+' 字段 '+m+' 类型错误信息未定义');}else if($.isFunction(d.custom)){var h=$.Deferred(),b=d.custom(p,function(e){h.resolve(e);});u=null==b||b.done?h:b;}}}if(t)if(r=i.push({element:p,error:u}),u&&u.promise)o.push(u),a.push(r-1);}),o.length>0){var u=t(o).done(function(e){$.each(e,function(e,r){i[a[e]].error=r;}),n.refreshGroup(r,i);});return u.data=i,u;}else return n.refreshGroup(r,i),i;}},refreshGroup:function(e,r){var t=this,n=t.successClass,i=t.errorClass;$.each(r,function(r,o){var a,u=o.element,l=o.error,s=t.errorSelector;if(s)a=e.find(s).eq(r);if(l&&'string'===$.type(l)){if(e.removeClass(n).addClass(i),a){var f=t.renderTemplate;if($.isFunction(f))l=f({text:l},t.errorTemplate);a.html(l).show();var c=t.errorPlacement;if($.isFunction(c))c(u,a);}}else if(o.error='',e.removeClass(i).addClass(n),a)a.html('').hide();});},dispose:function(){var e=this;i.dispose(e),e.element.off(a),e.element=null;}},n(e.prototype),e.defaultOptions={realtime:!1,scrollGap:100,groupSelector:'.form-group',successClass:'has-success',errorClass:'has-error',errorSelector:'.error',errorTemplate:'<i class="icon icon-times-circle"></i>&nbsp;${text}',requiredClass:'has-required',requiredSelector:'.required',requiredTemplate:'${text}',renderTemplate:function(e,r){return r.replace(/\${(\w+)}/g,function(r,t){return e[t]||'';});},errorPlacement:function(e,r){if('hidden'===e.prop('type'))e=e.parent();r.css({position:'static',width:'auto'});var t=r.outerWidth(!0)+5;r.css({position:'absolute',width:t});var n=e.parent();if(n.is('.placeholder-wrapper'))e=n;var i=e.position();r.css({left:i.left+e.outerWidth()-37,top:i.top-r.outerHeight()+8});}},e.type={text:['required','pattern','min','max','minlength','maxlength'],hidden:['required'],password:['required','pattern','minlength','maxlength','equals'],number:['required','pattern','min','max','step'],range:['required','pattern','min','max','step'],tel:['required','pattern'],url:['required','pattern'],email:['required','pattern'],mobile:['required','pattern'],money:['required','pattern','min','max'],idcard:['required','pattern'],'int':['required','pattern','min','max'],internationalMobile:['required','pattern']},e.rule={required:function(e){if(e.value.length>0)return!0;else if(e.rules.required)return!1;},pattern:function(e){var r=e.rules.pattern;if(r)return r.test(e.value);else return void 0;},minlength:function(e){var r=e.rules.minlength;if($.isNumeric(r))return e.value.length>=+r;else return void 0;},maxlength:function(e){var r=e.rules.maxlength;if($.isNumeric(r))return e.value.length<=+r;else return void 0;},min:function(e){var r=e.rules.min;if($.isNumeric(r))return e.value>=+r;else return void 0;},max:function(e){var r=e.rules.max;if($.isNumeric(r))return e.value<=+r;else return void 0;},step:function(e){var r=e.rules.step;if($.isNumeric(r)){var t=e.rules.min||1;return(e.value-t)%r===0;}},equals:function(e){var r=e.rules.equals;if(r){var t=e.form.find('[name="'+r+'"]');return e.value===$.trim(t.val());}}},e.pattern={number:/^[\d.]*$/,'int':/^\d+$/,url:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,tel:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,mobile:/^1[3-9]\d{9}$/,email:/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,money:/^[\d.]*$/,idcard:/(^\d{15}$)|(^\d{17}([0-9]|X)$)/i,internationalMobile:/^\d{7,20}$/};var o={required:function(e){return'required'===e.attr('required');},pattern:function(r,t){var n=r.attr('pattern')||e.pattern[t.type];if('string'===$.type(n))n=new RegExp(n);return n;},minlength:function(e){return e.attr('minlength');},maxlength:function(e){return e.attr('maxlength');},min:function(e){return e.attr('min');},max:function(e){return e.attr('max');},step:function(e){return e.attr('step');},equals:function(e){return e.attr('equals');}},a='.cobble_form_validator';return e;}),define('cobble/function/around',['require','exports','module'],function(){'use strict';return function(e,r,t,n){var i='string'===$.type(r),o=i?e[r]:e;if(!i)n=t,t=r;var a=function(){var e,r=arguments;if($.isFunction(t))e=t.apply(this,r);if(e!==!1){if($.isFunction(o))e=o.apply(this,r);if($.isFunction(n)){var i=n.apply(this,r);if('undefined'!==$.type(i))e=i;}return e;}};return i?e[r]=a:a;};}),define('cobble/function/init',['require','exports','module'],function(){'use strict';return function(e){return function(r,t){var n=[];return r.each(function(){n.push(new e($.extend({element:$(this)},t)));}),n;};};}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var r=$.prototype,t={on:function(){return r.on.apply(e(this),arguments),this;},off:function(){return r.off.apply(e(this),arguments),this;},emit:function(t,n){var i=this,o=e(i);if(o){if(!t[$.expando])t='string'===$.type(t)?$.Event(t):$.Event(null,t);t.cobble=i;var a=[t];if(n)a.push(n);var u=i[$.camelCase('on-'+t.type)];if($.isFunction(u)&&u.apply(i,a)===!1)t.preventDefault();if(!t.isPropagationStopped())r.trigger.apply(o,a);return t;}},before:function(r){e(this).before(r);},after:function(r){e(this).after(r);},appendTo:function(r){e(this).appendTo(r);},prependTo:function(r){e(this).prependTo(r);}};return function(e){$.each(t,function(r,t){if(null==e[r])e[r]=t;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,r){var t=e.constructor,n='__cobble__'+t.prototype.type,i=r.element;if(i&&i.data(n))e=i.data(n);else if($.extend(e,t.defaultOptions,r),e.init(),i)i.data(n,e);return e;},exports.dispose=function(e){var r='__cobble__'+e.constructor.prototype.type,t=e.element;if(t)t.removeData(r);};}),define('cobble/function/replaceWith',['require'],function(){'use strict';return function(e,r){e=e[0],r=r[0],e.parentNode.replaceChild(r,e);};}),define('cobble/helper/Placeholder',['require','exports','module','../function/init','../function/jquerify','../function/lifeCycle','../function/replaceWith','../util/input'],function(require){'use strict';function e(e){return n.init(this,e);}var r=require('../function/init'),t=require('../function/jquerify'),n=require('../function/lifeCycle'),i=require('../function/replaceWith'),o=require('../util/input');e.prototype={constructor:e,type:'Placeholder',init:function(){var e=this,r=e.element,t=r.attr('placeholder');if(null==e.value)e.value=t||'';var n;if(l)if(e.nativeFirst)n='native';else if(t)r.removeAttr('placeholder');if(!n)n=e.simple?'simple':'complex';if(n=s[n],$.extend(e,n),n.init)e.init();if(e.refresh)e.refresh();}},t(e.prototype),e.defaultOptions={simple:!1,nativeFirst:!0,simpleClass:'placeholder-active',placeholderSelector:'.placeholder',template:'<div class="placeholder-wrapper"><div class="placeholder"></div></div>'},e.init=r(e);var a='.cobble_helper_placeholder',u=$('<input type="text" />')[0],l='placeholder'in u;u=null;var s={'native':{show:$.noop,hide:$.noop,refresh:$.noop,dispose:function(){var e=this;n.dispose(e),e.element=null;}},simple:{init:function(){var e=this,r=$.proxy(e.refresh,e);e.element.on('focus'+a,r).on('blur'+a,r);},show:function(){var e=this;e.element.addClass(e.simpleClass).val(e.value);},hide:function(){var e=this;e.element.removeClass(e.simpleClass).val('');},refresh:function(){var e=this,r=e.element;if(document.activeElement===r[0]){if(r.hasClass(e.simpleClass))e.hide();}else if(!r.val())e.show();},dispose:function(){var e=this;n.dispose(e),e.element.off(a),e.element=null;}},complex:{init:function(){var e=this,r=e.element,t=$(e.template);i(r,t),t.append(r),e.faker=t.find(e.placeholderSelector);var n=$.proxy(e.refresh,e);o.init(r),r.on('focus'+a,n).on('blur'+a,n).on('input'+a,n);},show:function(){var e=this;e.faker.html(e.value).show();},hide:function(){this.faker.hide();},refresh:function(){var e=this,r=e.element.val();if($.trim(r))e.hide();else e.show();},dispose:function(){var e=this;n.dispose(e);var r=e.element;o.dispose(r),r.off(a),e.faker=e.element=null;}}};return e;}),define('cobble/util/input',['require','exports','module','../function/around'],function(require,exports){'use strict';function e(){}function r(e){var r=e.val(),n=!1;e.on('propertychange'+o,function(t){if(n)return void(n=!1);if('value'===t.originalEvent.propertyName){var i=e.val();if(i!==r)e.trigger('input'),r=i;}}),t(e,'val',function(){if(0!==arguments.length)n=!0;});}var t=require('../function/around'),n=$('<input type="text" />')[0],i='oninput'in n;n=null;var o='.cobble_util_input';exports.init=i?e:r,exports.dispose=function(e){e.off(o);};}),define('teacher/search/recommend_d230654148',['require','exports','cobble/form/Validator','cobble/helper/Placeholder','common/service_9c322508d3','common/store_a1a35b3dfc'],function(require,exports){'use strict';var e=require('cobble/form/Validator'),r=require('cobble/helper/Placeholder'),t=require('common/service_9c322508d3'),n=$('#recommend'),i=require('common/store_a1a35b3dfc');exports.init=function(){if(0!=i.get('user').type)n.find('.find-teacher-container').show();r.init(n.find('.form-text'));var o=new e({element:$('#recommend-form'),fields:{mobile:{errors:{required:'请输入联系方式',pattern:'手机号码格式错误'}}}});n.on('click','.btn-service',function(){if(o.validate())t.recommendAddRecord({mobile:n.find('input[name="mobile"]').val()}).done(function(e){if(0===e.code)alert('跟谁学小秘书已经收到你需要的老师信息<br/>稍等片刻\uFF0C我们会马上与你联系哦~','温馨提示');});});};});