define("common/map/baiduTeacherAddress",["require","exports"],function(require,exports){"use strict";function e(e,t){this._point=e,this._avatar=t.avatar,this._name=t.name,this._school_age=t.school_age,this._location=t.location,this._url=t.url}function t(){var e=document.createElement("style");if(document.head)document.head.appendChild(e);else document.appendChild(e);var t=e.sheet;if(t)if(t.addRule)t.addRule(".teacher-box::before","border:7px solid transparent;content:' ';border-top-color:#dfdfdf;top:67px;left:112px;position:absolute;"),t.addRule(".teacher-box::after","border:7px solid transparent;content:' ';border-top-color:#fff;top:66px;left:112px;position:absolute;");else if(t.insertRule)t.insertRule(".teacher-box::before{border:7px solid transparent;content:' ';border-top-color:#dfdfdf;top:67px;left:112px;position:absolute;}",0),t.insertRule(".teacher-box::after{border:7px solid transparent;content:' ';border-top-color:#fff;top:66px;left:112px;position:absolute;}",0)}function o(){if(h)c("search");else if(s.removeControl(u),f)s.addControl(f);else l()}function n(){if(h)c("search");else if(s.removeControl(u),f)s.addControl(f);else l()}function i(){function e(){this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(80,10)}e.prototype=new BMap.Control,e.prototype.initialize=function(e){var t=document.createElement("div"),o=document.createElement("input"),n=document.createElement("label");return o.type="checkbox",o.checked=!0,o.style.position="relative",o.style.top="2px",o.style.marginRight="5px",o.style.cursor="pointer",m=o,n.style.cursor="pointer",n.appendChild(o),n.appendChild(document.createTextNode("移动地图时搜索")),t.appendChild(n),t.style.cursor="pointer",t.style.border="1px solid #B3B3B3",t.style.fontSize="12px",t.style.color="#6d6d6d",t.style.padding="6px 10px",t.style.backgroundColor="white",t.style.borderRadius="2px",o.onclick=function(){if(o.checked)h=!0;else h=!1},e.getContainer().appendChild(t),t},u=new e,s.addControl(u)}function l(){function e(){this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT,this.defaultOffset=new BMap.Size(80,10)}e.prototype=new BMap.Control,e.prototype.initialize=function(e){var t=document.createElement("div"),o=document.createElement("img");return o.src="http://cdn.gsxservice.com/asset/img/teacher/refresh.png",o.width=14,o.height=15,o.style.top="2px",o.style.position="relative",o.style.marginRight="5px",t.appendChild(o),t.appendChild(document.createTextNode("在此重新搜索")),t.style.cursor="pointer",t.style.border="1px solid #D53A48",t.style.fontSize="12px",t.style.color="#fff",t.style.padding="6px 10px",t.style.backgroundColor="#FF5666",t.style.borderRadius="2px",t.onclick=function(){c("search",null,function(){e.removeControl(f),e.addControl(u),m.checked=!1,h=!1})},t.onmouseover=function(){t.style.backgroundColor="#E54D5C"},t.onmouseout=function(){t.style.backgroundColor="#FF5666"},e.getContainer().appendChild(t),t},f=new e,s.addControl(f)}function a(t,o,n){var i=new BMap.Icon("http://cdn.gsxservice.com/asset/img/teacher/map/point"+(n+1)+".png",new BMap.Size(29,47)),l=new BMap.Icon("http://cdn.gsxservice.com/asset/img/teacher/map/point_hover"+(n+1)+".png",new BMap.Size(29,47)),a=new BMap.Marker(t,{icon:i});s.addOverlay(a);var r=-1==o.school_age?"30年以上教龄":o.school_age+"年教龄",d=o.location.length>10?o.location.substr(0,10)+"...":o.location,p=o.name.length>4?o.name.substr(0,4)+"...":o.name,u=new e(t,{avatar:o.avatar+"@1e_40w_40h_1c_0i_1o_90Q_1x.jpeg",name:p,school_age:r,location:d,url:o.detail_url});s.addOverlay(u),u.hide();var f=y--;a.setZIndex(f),a.addEventListener("click",function(){u.show(),window.open(o.detail_url)}),a.addEventListener("mouseover",function(){a.setIcon(l),a.setZIndex(-99999),c("mouseover",n),u.show()}),a.addEventListener("mouseout",function(){a.setIcon(i),a.setZIndex(99999),c("mouseout",n),u.hide()}),g[n]={marker:a,infoWindow:u,icon:i,icon_hover:l}}function r(e){p=[],g=[];for(var t=0;t<e.length;t++)p.push({name:e[t].name,avatar:e[t].avatar_url,school_age:e[t].school_age,location:e[t].location,detail_url:e[t].detail_url,lng:e[t].longitude,lat:e[t].latitude})}function d(e,t){if(e)if(r(e),!(p.length<1)){for(var o=[],n=0;n<p.length;n++){var i=new BMap.Point(p[n].lng,p[n].lat);o.push(i),a(i,p[n],n)}if(t)s.setViewport(o)}}var s,p=[],c=null,u=null,f=null,h=!0,m=null,g=[],y=99999;e.prototype=new BMap.Overlay,e.prototype.initialize=function(e){this._map=e;var t=this._div=document.createElement("a");t.href=this._url,t.target="_blank",t.style.display="block",t.style.position="absolute",t.style.backgroundColor="#fff",t.style.padding="12px",t.style.width="250px",t.style.boxShadow="0px 3px 10px #dfdfdf",t.style.borderRadius="5px",t.className="teacher-box";var o=document.createElement("img");o.src=this._avatar,o.width=40,o.height=40,o.title=this._name,o.style.display="inline-block",o.style.zoom=1,o.style["float"]="left",o.style.marginRight="12px",t.appendChild(o);var n=document.createElement("div");n.style["float"]="left",n.style.display="inline-block",n.style.zoom=1,t.appendChild(n);var i=document.createElement("span");n.appendChild(i),i.appendChild(document.createTextNode(this._name)),i.style.fontSize="14px",i.style.color="#3d3d3d",i.style.marginRight="10px",n.appendChild(i);var l=document.createElement("span");l.style.fontSize="12px",l.style.color="#6d6d6d";var a=document.createElement("img");a.src="http://cdn.gsxservice.com/asset/img/teacher/teach_time.png",a.width=17,a.height=17,a.style.top="3px",a.style.position="relative",a.style.marginRight="5px",l.appendChild(a),l.appendChild(document.createTextNode(this._school_age)),n.appendChild(l);var r=document.createElement("span");r.style.fontSize="12px",r.style.color="#6d6d6d",r.style.display="block";var d=document.createElement("img");return d.src="http://cdn.gsxservice.com/asset/img/teacher/location.png",d.width=14,d.height=16,d.style.top="3px",d.style.position="relative",d.style.marginRight="5px",r.appendChild(d),r.appendChild(document.createTextNode(this._location)),n.appendChild(r),e.getPanes().labelPane.appendChild(t),t},e.prototype.draw=function(){var e=this._map,t=e.pointToOverlayPixel(this._point);this._div.style.left=t.x-120+"px",this._div.style.top=t.y-100+"px"},exports.init=function(e,l,a){if(r(l),c=a,t(),s=new BMap.Map(e),l&&l[0]){for(var p=null,u=null,f=null,h=null,m=0;m<l.length;m++){if(!p)p=l[m].longitude;else if(p>l[m].longitude)p=l[m].longitude;if(!u)u=l[m].latitude;else if(u>l[m].latitude)u=l[m].latitude;if(!f)f=l[m].longitude;else if(f<l[m].longitude)f=l[m].longitude;if(!h)h=l[m].latitude;else if(h<l[m].latitude)h=l[m].latitude}var g=new BMap.Point(p,u),y=new BMap.Point(f,u),v=(s.getDistance(g,y)/1e3).toFixed(3),x=11;if(v>2e3)x=4;else if(v>1e3)x=5;else if(v>500)x=6;else if(v>200)x=7;else if(v>100)x=8;else if(v>50)x=9;else if(v>25)x=10;else if(v>20)x=11;else if(v>10)x=12;else if(v>5)x=13;else if(v>2)x=14;else if(v>1)x=15;else if(v>.5)x=16;else if(v>.2)x=17;else x=18;s.centerAndZoom(new BMap.Point((p+f)/2,(u+h)/2),x)}else s.centerAndZoom(new BMap.Point(116.404,39.915),11);var _=new BMap.NavigationControl;s.addControl(_),s.enableScrollWheelZoom(),i(),d(l,!0),s.addEventListener("dragend",o),s.addEventListener("zoomend",n)},exports.deletePoints=function(){for(var e=s.getOverlays(),t=0;t<e.length;t++)s.removeOverlay(e[t])},exports.addPoints=function(e){d(e)},exports.removeControl=function(){s.removeControl(u)},exports.getMapData=function(){var e={},t=s.getCenter(),o=s.getBounds(),n=o.getNorthEast(),i=o.getSouthWest(),l=new BMap.Point(i.lng,i.lat),a=new BMap.Point(n.lng,n.lat),r=new BMap.Point(i.lng,n.lat),d=(s.getDistance(l,r)/2e3).toFixed(3),p=(s.getDistance(a,r)/2e3).toFixed(3);return e.lng=t.lng,e.lat=t.lat,e.radius=Math.min(d,p),e},exports.openInfoWindow=function(e){var t=g[e];if(t)t.infoWindow.show(),t.marker.setIcon(t.icon_hover),t.marker.setZIndex(-99999)},exports.hideInfoWindow=function(e){var t=g[e];if(t)t.infoWindow.hide(),t.marker.setIcon(t.icon),t.marker.setZIndex(99999)}});