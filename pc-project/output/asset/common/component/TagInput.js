define("cobble/helper/Range",["require","exports","module"],function(){"use strict";function e(e){this.element=e}function t(){var e=this.element;return{start:e.selectionStart,end:e.selectionEnd}}function a(e,t){var a=this.element;a.focus(),a.setSelectionRange(e,t)}function n(){var e=this.element;e.focus();var t=document.selection.createRange().getBookmark(),a=e.createTextRange();a.moveToBookmark(t);var n=a.duplicate();n.setEndPoint("StartToStart",a);for(var i=e.value,r=0;0!==n.moveStart("character",-1);r++)if("\n"===i.charAt(r))r++;return{start:r,end:r+a.text.length}}function i(e,t){var a=this.element;if(!(a.value.length<t)){var n=a.createTextRange();n.collapse(!0),n.moveStart("character",e),n.moveEnd("character",t-1),n.select()}}var r=!window.getSelection;return e.prototype={constructor:e,getRange:r?n:t,setRange:r?i:a,getText:function(){var e=this.element.value,t=this.getRange();return e.substring(t.start,t.end)},setText:function(e){var t=this.element,a=t.value,n=this.getRange();t.value=a.substring(0,n.start)+e+a.substr(n.end)},dispose:function(){this.element=null}},r=null,e}),define("common/component/TagInput",["cobble/helper/Range"],function(){"use strict";function e(e){$.extend(this,e),this.init()}function t(e){return $('<label class="label label-primary small" data-value="'+e+'">'+e+'<i class="icon icon-times"></i></label>')}function a(e,t){var a=""!==t;if(a){if(e.tagList.find('[data-value="'+t+'"]').length>0)a=!1;if(a&&$.isFunction(e.validate))a=e.validate(t)}return a}var n=require("cobble/helper/Range");e.prototype={init:function(){var e=this,t=e.element,a=$(i);t.replaceWith(a),a.append(t);var r=t.prop("name");if(r)t.removeAttr("name");var l=$('<input type="hidden" name="'+r+'" />'),s=a.find(".tag-list");a.append(l),e.wrapper=a,e.tagList=s,e.input=l;var o=new n(t[0]);t.on("keydown",function(a){var n=a.keyCode,i=$.trim(t.val());if(i&&32===n)if(e.appendTag(i))t.val("");else return!1;else if(8===n){var r=o.getRange();if(r.start===r.end&&0===r.start)if(s.length>0){var l=s.find(".label").last();e.removeTag(l.data("value"))}}}).on("focus",function(){a.addClass("active")}).on("blur",function(){a.removeClass("active")}),a.on("click",".icon-times",function(t){var a=$(t.currentTarget).closest(".label");e.removeTag(a.data("value"))})},setValue:function(e){var t=this,a=t.tagList;a.find(".label").each(function(){t.removeTag($(this).data("value"))}),$.each(e.split(","),function(e,a){if(a)t.appendTag(a)})},getValue:function(){var e=this,t=e.getTags();if("number"!==$.type(e.max)||t.length<e.max){var n=$.trim(e.element.val());if(a(e,n))t.push(n)}return t.join(",")},getTags:function(){var e=[];return this.tagList.find(".label").each(function(){e.push($(this).data("value"))}),e},appendTag:function(e){var n=this,i=a(n,e);if(i){var r=n.getTags();if("number"===$.type(n.max))i=r.length<n.max;if(i)r.push(e),n.tagList.append(t(e)),n.input.val(r.join(","))}return i},removeTag:function(e){var t=this,a=t.tagList;a.find(".label").each(function(){var a=$(this);if(a.data("value")===e)return a.remove(),t.input.val(t.getTags().join(",")),!1;else return void 0})}};var i='<div class="tag-input"><div class="tag-list"></></div>';return e});