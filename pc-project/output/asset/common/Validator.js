!function(e,t){var i=t();if("function"==typeof define)define("common/Validator",function(){return i});else if("undefined"==typeof require)e.Validator=i}(this,function(){var e=/^validate([A-Z])/,t=/\s*\:\s*/,i=/\s*,\s*/,n=".for-validator",r=function(t){var i=$(t),n={element:i[0]};if(!i[0]){if("string"==typeof t)n.name=$.trim(t);return n}var r=i.data();return $.each(r,function(t,i){if(e.test(t))n[t.replace(e,function(e,t){return t.toLowerCase()})]=i}),n},o=function(e){$.extend(this,e),this.verifies={}};o.prototype.init=function(e){e=$(e||"body");var t=this,i=e.find("[data-validate-name]");return i.each(function(){t.add(this)}),t},o.prototype.add=function(e,t){var i=this,o=r(e),f=o.name,l={element:o.element,rules:i.elements[f],notifier:i.notifier[f]||i.notifier["*"]},s=i.vals&&i.vals[f];if(s)l.val=s;t=$.extend({},l,t,o);var u=this.verifies[f]=new a(t);if(u.element)$(u.element).on((u.trigger||"change")+n,function(){i.validate(f)})},o.prototype.remove=function(e){var t=this.verifies[e];if(t)delete this.verifies[e],delete this.elements[e],delete this.notifier[e],this.vals&&delete this.vals[e],$(t.element).off((t.trigger||"change")+n)},o.prototype.parseResponse=function(e){if("boolean"==typeof e)return e;else return!e.code&&e.data},o.prototype.validate=function(e){var n=$.Deferred(),r=this;if(!e){var o=[];$.each(this.verifies,function(e){o.push(r.validate(e))}),$.when.apply(null,o).done(function(){var e=!0;$.each(arguments,function(t,i){if(!i)return e=!1;else return void 0}),n.resolve(e)})}else{var a=r.verifies[e],f=a.rules;if(!f)return;var l=a.notifier,s=f.length,u=a.element,v=function(o){var c=f[o],d=null,p=null;if("string"==typeof c){var h=c.split(t);if(d=h[0],h[1])p=h[1].split(i);c=r.rules[d]}else for(d in c){c=c[d];break}var m=a.val(a.element),$=c.apply({element:a.element,value:m,args:p},p||[m]),y=function(t){if(o===s-1)n.resolve(t),l.call(u,t,d,e);else if(!t)n.resolve(!1),l.call(u,!1,d,e);else if(t.force)n.resolve(!0),l.call(u,!0,d,e);else v(o+1)};if($.done)$.done(function(t){y(r.parseResponse.call({element:u,methodName:d,name:e},t))});else y($)};v(0)}return n.promise()},o.prototype.dump=function(e){var t={};if(!e){for(var i in this.verifies)t[i]=this.verifies[i];return t}return $.each(e,function(e,i){t[i]=this.verifies[i]}),t};var a=function(e){$.extend(this,e)};return a.prototype.val=function(){return $.trim($(this.element).val())},o});