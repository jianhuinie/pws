define('cobble/form/Validator',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return o.init(this,e);}function n(e,n){if(e.length>0){var t=e[0].element;if(t.is(':hidden'))t=t.parent();var i=t.offset().top;if(n>0)i-=n;window.scrollTo(window.scrollX,i);}}function t(e){var n=$.Deferred();return $.when.apply($,e).done(function(){n.resolve(arguments);}),n;}var i=require('../function/jquerify'),o=require('../function/lifeCycle');e.prototype={constructor:e,type:'Validator',init:function(){var n=this,t=n.element,i='FORM'===t.prop('tagName')?t:t.find('form');if(i.length>0)i.attr('novalidate','novalidate').on('submit'+a,$.proxy(n.validate,n));$.each(n.fields,function(n,i){var o=t.find('[name="'+n+'"]'),a=i.type;if(!a)a=i.type=o.attr('type')||'text';var u=i.rules;if(!u)u=i.rules={};var c=e.type[a]||[];$.each(c,function(e,n){if(null==u[n]){var t=r[n];if($.isFunction(t))u[n]=t(o,i);}});});var o=n.groupSelector;if(t.on('focusin'+a,function(e){var t=$(e.target).closest(o),i=[n.successClass,n.errorClass,n.requiredClass].join(' ');t.removeClass($.trim(i));}),n.realtime)t.on('focusout'+a,function(e){var t=$(e.target),i=t.prop('name');if(!i)t=t.find('[name]'),i=t.prop('name');if(i)n.validate(i);});},validate:function(e,i){var o=this,r=o.emit('beforeValidate');if(!r.isDefaultPrevented()){var a,u=o.element,c=o.groupSelector;if('string'===$.type(e))e=[e];if($.isArray(e))a=$.map(e,function(e){return u.find('[name="'+e+'"]').closest(c);});else if(a=u.find(c),'boolean'===$.type(e))i=e;var l=[],s=[];$.each(a,function(e,n){var t=o.validateGroup($(n));if(t){if(t.promise)s.push(t),t=t.data;$.merge(l,t);}});var e=[],p=[],f=function(){if($.each(l,function(n,t){if(t.error)p.push(t);e.push(t.element.prop('name'));}),i)n(p,o.scrollGap);o.emit('afterValidate',{fields:e,errors:p});};if(s.length>0)return t(s).done(f);else return f(),0===p.length;}},validateGroup:function(n){if(n.is(':visible')){var i=this,o=[],r=[],a=[];if(n.find('[name]').each(function(n){var t,u,c=this,l=c.name,s=c.value,p=c.disabled,f=$(c);if(!p){var d=i.fields[l];if(d){t=!0,d=$.extend(!0,{},d),d.form=i.element,d.value=$.trim(s);var m;if($.each(e.type[d.type]||[],function(n,t){var i=e.rule[t](d);if(i===!1)return m=t,!1;else if(''===d.value&&'required'===t)return!1;}),m){var h=d.errors;if(h)u=h[m];if(!u)throw new Error(l+' 字段 '+m+' 类型错误信息未定义');}else if($.isFunction(d.custom)){var x=$.Deferred(),v=d.custom(f,function(e){x.resolve(e);});u=null==v||v.done?x:v;}}}if(t)if(n=o.push({element:f,error:u}),u&&u.promise)r.push(u),a.push(n-1);}),r.length>0){var u=t(r).done(function(e){$.each(e,function(e,n){o[a[e]].error=n;}),i.refreshGroup(n,o);});return u.data=o,u;}else return i.refreshGroup(n,o),o;}},refreshGroup:function(e,n){var t=this,i=t.successClass,o=t.errorClass;$.each(n,function(n,r){var a,u=r.element,c=r.error,l=t.errorSelector;if(l)a=e.find(l).eq(n);if(c&&'string'===$.type(c)){if(e.removeClass(i).addClass(o),a){var s=t.renderTemplate;if($.isFunction(s))c=s({text:c},t.errorTemplate);a.html(c).show();var p=t.errorPlacement;if($.isFunction(p))p(u,a);}}else if(r.error='',e.removeClass(o).addClass(i),a)a.html('').hide();});},dispose:function(){var e=this;o.dispose(e),e.element.off(a),e.element=null;}},i(e.prototype),e.defaultOptions={realtime:!1,scrollGap:100,groupSelector:'.form-group',successClass:'has-success',errorClass:'has-error',errorSelector:'.error',errorTemplate:'<i class="icon icon-times-circle"></i>&nbsp;${text}',requiredClass:'has-required',requiredSelector:'.required',requiredTemplate:'${text}',renderTemplate:function(e,n){return n.replace(/\${(\w+)}/g,function(n,t){return e[t]||'';});},errorPlacement:function(e,n){if('hidden'===e.prop('type'))e=e.parent();n.css({position:'static',width:'auto'});var t=n.outerWidth(!0)+5;n.css({position:'absolute',width:t});var i=e.parent();if(i.is('.placeholder-wrapper'))e=i;var o=e.position();n.css({left:o.left+e.outerWidth()-37,top:o.top-n.outerHeight()+8});}},e.type={text:['required','pattern','min','max','minlength','maxlength'],hidden:['required'],password:['required','pattern','minlength','maxlength','equals'],number:['required','pattern','min','max','step'],range:['required','pattern','min','max','step'],tel:['required','pattern'],url:['required','pattern'],email:['required','pattern'],mobile:['required','pattern'],money:['required','pattern','min','max'],idcard:['required','pattern'],'int':['required','pattern','min','max'],internationalMobile:['required','pattern']},e.rule={required:function(e){if(e.value.length>0)return!0;else if(e.rules.required)return!1;},pattern:function(e){var n=e.rules.pattern;if(n)return n.test(e.value);else return void 0;},minlength:function(e){var n=e.rules.minlength;if($.isNumeric(n))return e.value.length>=+n;else return void 0;},maxlength:function(e){var n=e.rules.maxlength;if($.isNumeric(n))return e.value.length<=+n;else return void 0;},min:function(e){var n=e.rules.min;if($.isNumeric(n))return e.value>=+n;else return void 0;},max:function(e){var n=e.rules.max;if($.isNumeric(n))return e.value<=+n;else return void 0;},step:function(e){var n=e.rules.step;if($.isNumeric(n)){var t=e.rules.min||1;return(e.value-t)%n===0;}},equals:function(e){var n=e.rules.equals;if(n){var t=e.form.find('[name="'+n+'"]');return e.value===$.trim(t.val());}}},e.pattern={number:/^[\d.]*$/,'int':/^\d+$/,url:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,tel:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,mobile:/^1[3-9]\d{9}$/,email:/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,money:/^[\d.]*$/,idcard:/(^\d{15}$)|(^\d{17}([0-9]|X)$)/i,internationalMobile:/^\d{7,20}$/};var r={required:function(e){return'required'===e.attr('required');},pattern:function(n,t){var i=n.attr('pattern')||e.pattern[t.type];if('string'===$.type(i))i=new RegExp(i);return i;},minlength:function(e){return e.attr('minlength');},maxlength:function(e){return e.attr('maxlength');},min:function(e){return e.attr('min');},max:function(e){return e.attr('max');},step:function(e){return e.attr('step');},equals:function(e){return e.attr('equals');}},a='.cobble_form_validator';return e;}),define('cobble/function/contains',['require','exports','module'],function(){'use strict';return function(e,n){if(e=e.jquery?e[0]:e,n=n.jquery?n[0]:n,!e||!n)return!1;if(e===n)return!0;else return $.contains(e,n);};}),define('cobble/function/isHidden',['require','exports','module'],function(){'use strict';return function(e){e.css('display');return'none'===e.css('display')||0==e.css('opacity')||'hidden'===e.css('visibility');};}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var n=$.prototype,t={on:function(){return n.on.apply(e(this),arguments),this;},off:function(){return n.off.apply(e(this),arguments),this;},emit:function(t,i){var o=this,r=e(o);if(r){if(!t[$.expando])t='string'===$.type(t)?$.Event(t):$.Event(null,t);t.cobble=o;var a=[t];if(i)a.push(i);var u=o[$.camelCase('on-'+t.type)];if($.isFunction(u)&&u.apply(o,a)===!1)t.preventDefault();if(!t.isPropagationStopped())n.trigger.apply(r,a);return t;}},before:function(n){e(this).before(n);},after:function(n){e(this).after(n);},appendTo:function(n){e(this).appendTo(n);},prependTo:function(n){e(this).prependTo(n);}};return function(e){$.each(t,function(n,t){if(null==e[n])e[n]=t;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,n){var t=e.constructor,i='__cobble__'+t.prototype.type,o=n.element;if(o&&o.data(i))e=o.data(i);else if($.extend(e,t.defaultOptions,n),e.init(),o)o.data(i,e);return e;},exports.dispose=function(e){var n='__cobble__'+e.constructor.prototype.type,t=e.element;if(t)t.removeData(n);};}),define('cobble/function/split',['require','exports','module'],function(){'use strict';return function(e,n){var t=[];return $.each(e.split(n),function(e,n){if(n=$.trim(n))t.push(n);}),t;};}),define('cobble/helper/Popup',['require','exports','module','../function/split','../function/isHidden','../function/contains','../function/jquerify','../function/lifeCycle','../util/instance'],function(require){'use strict';function e(e){return T.init(this,e);}function n(e,n){$.each(e.showConfigList,function(t,i){i[n](e);});}function t(e,n){$.each(e.hideConfigList,function(t,i){i[n](e);});}function i(e,n){if(e)e.type=n;else e=n;return e;}function o(e){var n=e.currentTarget;return n&&'HTML'===n.tagName?null:n;}function r(e,n){return e.emit(i(n,'beforeShow'));}function a(e,i){return e.layer.data(N,o(i)),n(e,'off'),t(e,'on'),e.emit('afterShow');}function u(e,n){return e.emit(i(n,'beforeHide'));}function c(e){return e.layer.removeData(N),t(e,'off'),n(e,'on'),e.emit('afterHide');}function l(){return $.now();}function s(e){return'__'+e+'Handler__';}function p(e,n){return null==e[n];}function f(e,n){return e.layer.data(N)!==o(n);}function d(e,n,t){return!n||n(e,t);}function m(e,n){return n-e[B]>50;}function h(n,t){return function(i){var o=i.data,r=l(i);if(p(o,S)&&f(o,i)&&d(o,t,i))o[B]=r,v({popup:o,delay:o.show.delay,toggle:e.trigger.show[n].delay,timer:S,success:function(){var e=function(){o.open(i);},n=o[q];if(n)n.done(e);else e();}});};}function x(n,t){return function(i){var o=i.data,r=l(i);if(p(o,V)&&d(o,t,i)&&m(o,r))o[B]=r,o[q]=$.Deferred(),v({popup:o,delay:o.hide.delay,toggle:e.trigger.hide[n].delay,timer:V,success:function(){o.close(i),o[q].resolve();},fail:function(){o[q]=null;}});};}function v(e){var n=e.delay,t=e.success;if(n>0){var i=e.popup,o=e.timer,r=e.toggle||{},a=r.on||$.noop,u=r.off||$.noop,c=e.fail||$.noop,l=function(){clearTimeout(i[o]),u(i,s),i[o]=null;},s=function(e){var n=i[o];if(n)l();if(n&&e===B)t();else c();};a(i,s),i[o]=setTimeout(function(){s(B);},n);}else t();}function g(e){var n=this,t=n.type,i=n.handler,o=s(t);if(e[o]!==i)e.element.on(t,e.selector,e,i),e[o]=i;}function b(e){var n=this;if(!e.selector){var t=n.type;e.element.off(t,n.handler),e[s(t)]=null;}}var y=require('../function/split'),C=require('../function/isHidden'),w=require('../function/contains'),_=require('../function/jquerify'),T=require('../function/lifeCycle'),M=require('../util/instance');e.prototype={constructor:e,type:'Popup',init:function(){var i=this,o=i.showConfigList=[],r=i.hideConfigList=[],a=i.show.trigger,u=i.hide.trigger;if(a)$.each(y(a,','),function(n,t){var i=e.trigger.show[t];if(i)o.push(i);});if(u)$.each(y(i.hide.trigger,','),function(n,t){var i=e.trigger.hide[t];if(i)r.push(i);});if(i.hidden=C(i.layer))n(i,'on');else t(i,'on');},open:function(){var e=this,n=arguments[0];if(!n)e[B]=l();if(n=r(e,n),!n.isDefaultPrevented()){var t=e.layer,i=e.show.animation;if($.isFunction(i))i.call(e,t);else t.show();e.hidden=!1,a(e,n);}},close:function(){var e=this;if(!e.hidden){var n=arguments[0];if(!n)e[B]=l();if(n=u(e,n),!n.isDefaultPrevented()){var t=e.layer,i=e.hide.animation;if($.isFunction(i))i.call(e,t);else t.hide();e.hidden=!0,c(e);}}},dispose:function(){var e=this;T.dispose(e),e.close(),n(e,'off'),e.element=e.layer=null;}},_(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var q='__hidePromise__',S='__showTimer__',V='__hideTimer__',B='__lastTriggerTime__',N='__sourceElement__',I=function(e,n){if(!n)return!1;else return w(e.layer,n);};return e.trigger={show:{focus:{type:'focusin',handler:h('focus'),on:g,off:b},click:{type:'click',handler:h('click'),on:g,off:b},over:{type:'mouseenter',handler:h('over'),on:g,off:b,delay:{on:function(e,n){e.element.on('mouseleave',e.selector,n);},off:function(e,n){e.element.off('mouseleave',n);}}},context:{type:'contextmenu',handler:h('context'),on:g,off:b}},hide:{blur:{type:'focusout',handler:x('blur'),on:g,off:b},click:{type:'click',handler:function(){return x(this.type,function(e,n){return!I(e,n.target);});},on:function(e){var n=this;M.document.on(n.type,e,e.clickHandler=n.handler());},off:function(e){M.document.off(this.type,e.clickHandler);}},out:{type:'mouseleave',handler:x('out'),on:function(e){var n=this.type,t=this.handler;e.layer.on(n,e,t),e.element.on(n,e.selector,e,t);},off:function(e){var n=this.type,t=this.handler;e.element.off(n,t),e.layer.off(n,t);},delay:{on:function(e,n){e.element.on('mouseenter',e.selector,n),e.layer.on('mouseenter',n);},off:function(e,n){e.element.off('mouseenter',n),e.layer.off('mouseenter',n);}}},context:{type:'contextmenu',handler:function(){return x('context',function(e,n){return!I(e,n.target);});},on:function(e){var n=this;M.document.on(n.type,e,e.contextHandler=n.handler());},off:function(e){M.document.off(this.type,e.contextHandler);}}}},e;}),define('cobble/ui/ComboBox',['require','exports','module','../function/jquerify','../function/lifeCycle','../helper/Popup'],function(require){'use strict';function e(e){return t.init(this,e);}var n=require('../function/jquerify'),t=require('../function/lifeCycle'),i=require('../helper/Popup');e.prototype={constructor:e,type:'ComboBox',init:function(){var e=this,n=e.button,t=e.menu,r=e.element||n,a=e.openClass,u=e.show,c=e.hide,l=u.animation;if($.isFunction(l))u.animation=$.proxy(l,e);if(l=c.animation,$.isFunction(l))c.animation=$.proxy(l,e);if(e.popup=new i({element:n,layer:t,show:u,hide:c,onBeforeShow:function(n){e.emit(n);},onBeforeHide:function(n){e.emit(n);},onAfterShow:function(n){if(a)r.addClass(a);e.emit(n);},onAfterHide:function(n){if(a)r.removeClass(a);e.emit(n);}}),null==e.value){var s=t.find('.'+e.activeClass);if(1===s.length)e.value=s.data('value');}if(e.data)t.html(e.renderTemplate(e.data,e.template));if(null!=e.value)e.setValue(e.value,{force:!0,silence:!0});t.on('click'+o,'[data-value]',function(){e.setValue($(this).data('value')),e.close();});},getValue:function(){return this.value;},setValue:function(e,n){var t,i=this,o=i.menu,r=o.find('[data-value="'+e+'"]');if(1===r.length){if(t=r.data(),null==t.text)t.text=r.html();}else t={};if(n=n||{},n.force||e!=i.value){var a=i.activeClass;if(a)o.find('.'+a).removeClass(a);if(1===r.length){if(i.value=e,a)r.addClass(a);}else i.value=null;if(!n.silence)i.emit('change',t);}if($.isFunction(i.setText))i.setText(t.text||i.defaultText);},refresh:function(e){var n=this,t=n.value,i={};if(e){var o=e.data;if(o)n.menu.html(n.renderTemplate(o,n.template));if('value'in e)t=e.value,i.force=!0;}n.setValue(t,i);},open:function(){this.popup.open();},close:function(){this.popup.close();},dispose:function(){var e=this;t.dispose(e),e.menu.off(o),e.popup.dispose(),e.popup=e.element=e.button=e.menu=null;}},n(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var o='.cobble_ui_combobox';return e;}),define('cobble/util/instance',['require','exports','module'],function(require,exports){exports.window=$(window),exports.document=$(document),exports.html=$(document.documentElement),exports.body=$(document.body);}),define('common/center/account/mobile',['require','exports','common/component/CodeButton_edf3c78096','common/component/Captcha_e804b20fed','cobble/form/Validator','common/component/SaveButton_b1f301d041','common/component/MobileInput_8f8e780d3d','common/service_9c322508d3','common/store_a1a35b3dfc'],function(require,exports){'use strict';function e(){if(n.is(':visible'))u=$.trim(n.find('[name="old_mobile"]').val());else if(t.is(':visible'))u=$.trim(t.find('[name="mobile"]').val());if(!u)alert('请输入手机号');else alert({title:'获取语音校验码',content:'校验码将以电话形式通知到你\uFF0C请注意接听',buttons:[{text:'获取',type:'primary',handler:function(){this.hide(),d.sendVoiceSMS({mobile:u});}},{text:'取消',handler:function(){this.hide();}}]});}var n,t,i,o,r,a,u,c=require('common/component/CodeButton_edf3c78096'),l=require('common/component/Captcha_e804b20fed'),s=require('cobble/form/Validator'),p=require('common/component/SaveButton_b1f301d041'),f=require('common/component/MobileInput_8f8e780d3d'),d=require('common/service_9c322508d3'),m=require('common/store_a1a35b3dfc'),h={verify_code:{errors:{required:'请输入校验码'}}},x={mobile:{errors:{required:'请输入新的手机号码',pattern:'请输入正确的手机号码'}},captcha:{errors:{required:'请输入验证码',minlength:'请输入 4 位验证码',maxlength:'请输入 4 位验证码'}},verify_code:{errors:{required:'请输入校验码'}}};exports.init=function(){var u=$('#content .item-mobile'),v=!1,g='http://www.genshuixue.com/auth/logout?next=';if(2===m.get('userType'))g+='/lesson/studentLessons';else g+='/teacher_center/index';var b='https://passport.genshuixue.com/view/pc/resetMobile.html?user_id='+m.get('userNumber')+'&user_role='+m.get('userType')+'&next_url='+encodeURIComponent(g);u.find('.passport').attr('href',b);var y=new c({element:u.find('#new-mobile-send'),send:function(){var e='mobile';if(w.validate(e)){var n=$.trim(i.getMobile()),t=$.Deferred();return d.checkMobileRegister({mobile:n}).done(function(e){if(0===e.code)if(1==e.data.exist)alert('该号码已绑定其他账号'),u.find('#new-mobile-send').prop('disabled',!1);else{if(0!=n.indexOf('00'))r.parent().show();return d.getSMSCode({mobile:$.trim(i.getMobile())}).done(function(e){if(0===e.code)t.resolve(e),success('校验码发送成功\uFF0C请注意查收');else u.find('#new-mobile-send').prop('disabled',!1);});}}),t.promise();}}});a=new l({element:u.find('.captcha-auth'),captchaName:'wyj',onBeforeValidate:function(){if(!y.isCounting)u.find('#new-mobile-send').prop('disabled',!0);},onValid:function(){if(!y.isCounting&&a.isValid)u.find('#new-mobile-send').prop('disabled',!1);},onInvalid:function(){if(!y.isCounting)u.find('#new-mobile-send').prop('disabled',!0);}}),n=u.find('#form-mobile');var C=new s({element:n,fields:h});o=n.find('.voice-code-link span'),o.on('click',e),t=u.find('#form-newMobile');var w=new s({realtime:!0,element:t,fields:x});r=t.find('.voice-code-link span'),r.on('click',e);new c({element:u.find('#mobile-send'),send:function(){var e='old_mobile',t=$.trim(n.find('[name="'+e+'"]').val());if(0!=t.indexOf('00'))o.parent().show();return d.getSMSCode({mobile:t}).done(function(e){if(0===e.code)success('校验码发送成功\uFF0C请注意查收');});}}),new p({element:u.find('#mobile-submit'),save:function(){var e=this.element,t=e.closest('.old-form'),o=t.next('.new-form');if(C.validate()){var r=$.trim(n.find('input[name="old_mobile"]').val()),a=n.find('input[name="verify_code"]').val();return d.checkNormalSMSCode({mobile:r,code:a}).done(function(e){if(0===e.code)u.find('#form-mobile')[0].reset(),t.hide(),o.show(),o.find('input[name="old_mobile"]').val(r),o.find('input[name="old_code"]').val(a),i=new f({element:u.find('#binding-mobile')});});}}}),new p({element:u.find('#new-mobile-submit'),save:function(){{var e=this.element,n=e.closest('.new-form');n.closest('.item-body');}if(w.validate()){{var t=$.trim(n.find('input[name="old_mobile"]').val()),o=n.find('input[name="old_code"]').val(),r=$.trim(i.getMobile()),a=n.find('input[name="captcha"]').val(),u=n.find('input[name="verify_code"]').val();r.substr(0,3)+'****'+r.substr(7,4);}return d.savePhone({oldMobile:t,oldVerifyCode:o,newMobile:r,captcha:a,newVerifyCode:u}).done(function(e){if(0===e.code)success('手机绑定成功',function(){location.reload();});});}}});u.on('click','.btn-change-captcha',function(){$('.captcha-image').prop('src','/captcha?captcha_name=wyj&'+$.now());}).on('click','#binding-mobile .switch-international',function(){if(v)v=!1,i.disableInternational(),$(this).text('非中国大陆手机号\uFF0C请点此进入');else r.parent().hide(),v=!0,i.enableInternational(),$(this).text('中国大陆手机号\uFF0C请点此进入');}).on('click','.btn-change',function(e){var n=$(e.currentTarget),t=n.closest('.item');t.find('.form-result').hide(),t.find('.old-form').show();});};}),define('common/component/Captcha_e804b20fed',['require','cobble/form/Validator','common/service_9c322508d3'],function(require){'use strict';function e(e){$.extend(this,e),this.init();}function n(){var e=this;return{captcha:{errors:{required:'请输入验证码',minlength:'请输入 4 位验证码',maxlength:'请输入 4 位验证码'},custom:function(n,t){if(e.skipAuth)t();var o={captcha:e.newCaptcha,captcha_name:e.captchaName};if($.isFunction(e.onBeforeValidate))e.onBeforeValidate();i.validateCaptcha(o,{errorHandler:{1:function(){}}}).done(function(e){if(0===e.code)t();else t('请输入正确的验证码');});}}};}var t=require('cobble/form/Validator'),i=require('common/service_9c322508d3');return e.prototype={init:function(){var e=this,i=e.element,o=i.find('input[name="captcha"]');e.input=o,e.captchaImage=e.element.find('.captcha-image'),e.captchaName=e.captchaName||'',e.newCaptcha='',e.isValid=!1,e.needAuth=!0,e.captchaValidator=new t({element:i,fields:n.call(e),onAfterValidate:function(n,t){if(0===t.errors.length){if(e.needAuth=!1,e.isValid=!0,$.isFunction(e.onValid))e.onValid();}else if(e.isValid=!1,$.isFunction(e.onInvalid))e.onInvalid();}});var r,a=function(n){var t=$(n.currentTarget),i=$.trim(t.val()),o=/^[0-9a-zA-Z]{4}$/g;if(o.test(i))e.newCaptcha=i,e.captchaValidator.validate();};if(e.element.on('click','.btn-change-captcha',function(){e.change();}),!e.skipAuth)if(o.on('blur',function(n){var t=$(n.currentTarget);if(e.newCaptcha=t.val(),r!=e.newCaptcha||e.needAuth)if(!e.autoValidate)e.captchaValidator.validate();return r=t.val(),!1;}),e.autoValidate)o.on('input',a).on('propertychange',a);},validate:function(){return this.captchaValidator.validate(),this.isValid;},getValue:function(){return this.input.val();},change:function(){var e=this;if(e.captchaName)e.captchaImage.prop('src','/captcha?captcha_name='+e.captchaName+'&'+$.now());else e.captchaImage.prop('src','/captcha?'+$.now());if($.isFunction(e.onBeforeValidate))e.onBeforeValidate();e.needAuth=!0,e.input.val('');},hide:function(){this.element.hide(),this.hidden=!0;},show:function(){this.element.show(),this.hidden=!1;},setCaptchaName:function(e){this.captchaName=e||'';}},e;}),define('common/component/CodeButton_edf3c78096',['require'],function(){'use strict';function e(e){$.extend(this,e),this.init();}return e.prototype={init:function(){var e=this,n=e.element;e.isCounting=!1,e.origin=n.html();var t=function(){e.sendCode();};if(e.container)e.container.on('click',function(e){if(e.target===n[0])t();});else n.click(t);},countDown:function(e){var n=this,t=this.element;n.isCounting=!0;var i=function(e){if(t.html(e+' 秒后再次发送'),$.isFunction(n.onTextChange))n.onTextChange();};t.prop('disabled',!0),n.timer=setInterval(function(){if(e--,e>0)i(e);else n.reset();},1000),i(e);},reset:function(){var e=this;e.isCounting=!1;var n=e.element;if(clearInterval(e.timer),n.html(e.origin),n.prop('disabled',!1),$.isFunction(e.onTextChange))e.onTextChange();if($.isFunction(e.onFinish))e.onFinish();},dispose:function(){if(this.element.off(),this.timer)clearInterval(this.timer);},sendCode:function(){var e=this,n=e.element;n.prop('disabled',!0);var t=e.send();if(t)t.done(function(t){if(0===t.code)e.countDown(60);else n.prop('disabled',!1);});else n.prop('disabled',!1);return t;}},e;}),define('common/component/MobileInput_8f8e780d3d',['require','exports','common/service_9c322508d3','cobble/ui/ComboBox','common/data/hotRegions_d442ddf09d','common/data/regionFlagPositions_e26d985ce0'],function(require){'use strict';function e(e){return'<li data-value="'+e.value+'" data-valuecode="'+e.valueCode+'" data-text="'+e.text+'" data-code="'+e.code+'" data-country-code="'+e.countryCode+'"><i class="icon icon-region-flag" style="background-position:0 '+l[e.countryCode]+'"></i>'+e.text+'</li>';}function n(n){return''+$.map(n,function(n){return e(n);}).join('')+'<li class="more">更多国家...</li>';}function t(n){return''+$.map(n,function(n){return'<li class="alphabet">'+n.text+'</li>'+$.map(n.list,function(n){return e(n);}).join('');}).join('');}function i(e,n,t){if('+86'!==e){var i=n.length;if(t)t.fields.mobile.rules.pattern=new RegExp('^\\d{'+(7-i)+','+(20-i)+'}$');}else if(t)t.fields.mobile.rules.pattern=/^1[3-9]\d{9}$/;}function o(e,n,t){var i=$.map(e,function(e,n){return{code:e.code,value:t?t+n:n,valueCode:e.value,text:e.text,countryCode:e.country_code};});return i.type=n,i;}function r(e){$.extend(this,e),this.init();}var a=require('common/service_9c322508d3'),u=require('cobble/ui/ComboBox'),c=require('common/data/hotRegions_d442ddf09d'),l=require('common/data/regionFlagPositions_e26d985ce0'),s=!1;return r.prototype={init:function(){var e=this,r=e.element;e.wrapper=r.find('.wrapper');var s=r.find('.flag'),p=r.find('.tel-code'),f=r.find('input[name="mobile"]');e.mobile=f;var d=new u({element:r.find('.tel-code-select'),button:r.find('.trigger'),menu:r.find('.dropdown-menu'),activeClass:'active',data:null,renderTemplate:function(e){if('hot'==e.type)return n(e);else return t(e);},onChange:function(n,t){if(s.css('background-position','0 '+l[t.countryCode]),e.value=t.valuecode,e.code=t.code,i(e.code,e.value,e.validator),p.text(t.code),$.isFunction(e.onChange))e.onChange();}});if(e.select=d,d.refresh({data:o(c,'hot')}),setTimeout(function(){d.setValue(0);}),d.element.on('click','.more',function(){a.getInternationalCode().done(function(e){if(0===e.code){var n=e.data,t=[],i=0;for(var r in n)t.push({text:r,list:o(n[r],'all',i)}),i+=n[r].length;d.refresh({data:t}),d.setValue(0),d.element.find('.dropdown-menu').animate({scrollTop:0},100,'linear');}});}),$.isFunction(e.onInputChange))f.on('change',e.onInputChange);if($.isFunction(e.onMobileChange))f.on('input',onMobileChange).on('propertychange',onMobileChange);},getValue:function(){return this.value;},getMobile:function(){var e;if(this.isInternational())e=this.value+this.mobile.val();else e=this.mobile.val();return $.trim(e);},isInternational:function(){return void 0===this.code?!1:'+86'!==this.code;},disableInternational:function(){this.wrapper.removeClass('enable-international'),this.wrapper.addClass('disable-international'),this.code='+86',i(this.code,'',this.validator),this.mobile.val('');},enableInternational:function(){if(this.wrapper.removeClass('disable-international'),this.wrapper.addClass('enable-international'),!s&&this.data)this.select.refresh({data:this.data.slice(1)}),s=!0;this.select.setValue(1,{force:!0}),this.mobile.val('');}},r;}),define('common/component/SaveButton_b1f301d041',['require'],function(){'use strict';function e(e){$.extend(this,e),this.init();}return e.prototype={init:function(){var e=this,n=e.element,t=n.html();if('BUTTON'!==n.prop('tagName'))throw new Error('SaveButton 必须使用 button 标签');var i=function(){var i=e.save();if(i)n.focus(),n.prop('disabled',!0),n.html(e.saveText||'正在保存...'),i.always(function(){setTimeout(function(){n.prop('disabled',!1),n.html(t);},10);});return!1;};if(n.click(i),e.form)e.form.submit(function(){return i(),!1;});}},e;}),define('common/data/hotRegions_d442ddf09d',['require','exports'],function(){return[{text:'中国',code:'+86',value:'',country_code:'CN'},{text:'中国香港',code:'+852',value:'00852',country_code:'HK'},{text:'中国澳门',code:'+853',value:'00853',country_code:'MO'},{text:'中国台湾',code:'+886',value:'00886',country_code:'TW'},{text:'美国',code:'+1',value:'001',country_code:'US'},{text:'加拿大',code:'+1',value:'001',country_code:'CA'},{text:'马来西亚',code:'+60',value:'0060',country_code:'MY'},{text:'澳大利亚',code:'+61',value:'0061',country_code:'AU'},{text:'日本',code:'+81',value:'0081',country_code:'JP'},{text:'韩国',code:'+82',value:'0082',country_code:'KR'},{text:'新加坡',code:'+65',value:'0065',country_code:'SG'},{text:'英国',code:'+44',value:'0044',country_code:'GB'},{text:'法国',code:'+33',value:'0033',country_code:'FR'},{text:'俄罗斯',code:'+7',value:'007',country_code:'RU'},{text:'印度',code:'+91',value:'0091',country_code:'IN'},{text:'泰国',code:'+66',value:'0066',country_code:'TH'},{text:'德国',code:'+49',value:'0049',country_code:'DE'}];}),define('common/data/regionFlagPositions_e26d985ce0',['require','exports'],function(){'use strict';return{AL:'-1034px',DZ:'-528px',AF:'-2311px',AR:'-2377px',AE:'-2223px',AW:'-792px',OM:'-2454px',AZ:'-1243px',AC:'-55px',EG:'-2201px',ET:'-2443px',IE:'-1969px',EE:'-2410px',AD:'-594px',AO:'-1947px',AI:'-1980px',AG:'-869px',AT:'-1331px',AU:'-1716px',MO:'-2597px',BB:'-1573px',PG:'-1485px',BS:'-363px',PK:'-2035px',PY:'-2344px',PS:'-1199px',BH:'-1496px',PA:'-847px',BR:'-770px',BY:'-1100px',BM:'-1914px',BG:'-2586px',MP:'-704px',BJ:'-1298px',BE:'0px',IS:'-1991px',BO:'-1650px',PR:'-473px',PL:'-1177px',BA:'-1584px',BW:'-2707px',BZ:'-484px',BT:'-1848px',BF:'-726px',BI:'-1892px',KP:'-1804px',GQ:'-1507px',DK:'-1386px',DE:'-2509px',TL:'-2784px',TG:'-605px',DO:'-1529px',DM:'-2432px',RU:'-660px',EC:'-1188px',ER:'-715px',FR:'-1012px',FO:'-1111px',PF:'-1705px',GF:'-2234px',MF:'-55px',PH:'-1815px',FI:'-1903px',CV:'-2652px',FK:'-2762px',GM:'-627px',CG:'-1793px',CD:'-1518px',CO:'-330px',CR:'-2090px',GD:'-2399px',GL:'-1760px',GE:'-858px',CU:'-748px',GP:'-407px',GU:'-2366px',GY:'-803px',KZ:'-1210px',HT:'-319px',KR:'-2245px',NL:'-1441px',BQ:'-2719px',SX:'-2773px',ME:'-2167px',HN:'-2156px',KI:'-374px',DJ:'-2101px',KG:'-1617px',GN:'-2575px',GW:'-1925px',CA:'-1375px',GH:'-2112px',GA:'-880px',KH:'-242px',CZ:'-2256px',ZW:'-2046px',CM:'-2057px',QA:'-462px',KY:'-308px',KM:'-1430px',CI:'-1661px',KW:'-2487px',HR:'-902px',KE:'-2630px',CK:'-2267px',CW:'-2729px',LV:'-1936px',LS:'-2190px',LA:'-451px',LB:'-1254px',LR:'-2068px',LY:'-132px',LT:'-1122px',LI:'-979px',RE:'-264px',LU:'-1474px',RW:'-2674px',RO:'-671px',MG:'-1287px',MT:'-1551px',MV:'-616px',MW:'-2145px',MY:'-1870px',ML:'-2520px',MK:'-1353px',MH:'-1144px',MQ:'-198px',MU:'-2179px',MR:'-253px',US:'-44px',AS:'-1562px',VI:'-1782px',MN:'-2553px',MS:'-583px',BD:'-1771px',PE:'-946px',FM:'-1738px',MM:'-11px',MD:'-2685px',MA:'-2333px',MC:'-913px',MZ:'-638px',MX:'-2024px',NA:'-1881px',ZA:'-2355px',SS:'-2741px',NP:'-110px',NI:'-154px',NE:'-550px',NG:'-2476px',NU:'-2079px',NO:'-836px',NF:'-209px',PW:'-231px',PT:'-517px',JP:'-429px',SE:'-385px',CH:'-1320px',SV:'-1639px',WS:'-2300px',RS:'-2465px',SL:'-737px',SN:'-2134px',CY:'-561px',SC:'-1045px',SA:'-33px',BL:'-1012px',ST:'-2388px',SH:'-495px',KN:'-99px',LC:'-1397px',SM:'-2123px',PM:'-1078px',VC:'-2619px',LK:'-2641px',SK:'-2212px',SI:'-1221px',SZ:'-2278px',SD:'-352px',SR:'-2663px',SO:'-1364px',SB:'-1067px',TJ:'-187px',TW:'-506px',TH:'-957px',TZ:'-2289px',TO:'-1089px',TC:'-1309px',TT:'-440px',TN:'-539px',TV:'-286px',TR:'-1606px',TM:'-2542px',TK:'-2751px',WF:'-1012px',VU:'-1265px',GT:'-935px',VE:'-1056px',BN:'-1683px',UG:'-1166px',UA:'-2002px',UY:'-2608px',UZ:'-1001px',ES:'-1155px',GR:'-165px',HK:'-2696px',SG:'-22px',NC:'-1276px',NZ:'-1540px',HU:'-682px',SY:'-1826px',JM:'-1727px',AM:'-176px',YE:'-1672px',IQ:'-649px',IR:'-2013px',IL:'-341px',IT:'-143px',IN:'-1694px',ID:'-1958px',GB:'-55px',VG:'-1408px',IO:'-55px',JO:'-1463px',VN:'-968px',ZM:'-1595px',TD:'-814px',GI:'-275px',CL:'-1342px',CF:'-1837px',CN:'-825px',NR:'-1749px',VA:'-2322px',FJ:'-1859px'};});