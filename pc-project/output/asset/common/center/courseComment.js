define('cobble/form/Select',['require','exports','module','../ui/ComboBox','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return n.init(this,e);}var t=require('../ui/ComboBox'),i=require('../function/jquerify'),n=require('../function/lifeCycle');return e.prototype={constructor:e,type:'Select',init:function(){var e=this,i=e.element,n='<input type="hidden" name="'+e.name+'"';if(null!=e.value)n+=' value="'+e.value+'"';if(i.attr('required'))n+=' required';n+=' />';var o=e.input=$(n);i.append(o),e.comboBox=new t({element:i,button:i.find(e.buttonSelector),menu:i.find(e.menuSelector),data:e.data,value:e.value,show:e.show,hide:e.hide,defaultText:e.defaultText,template:e.template,renderTemplate:e.renderTemplate,activeClass:e.activeClass,openClass:e.openClass,setText:$.proxy(e.setText,e),onChange:function(t,i){if(e.setValue(i.value),!e.silence)e.emit('change',i);},onAfterShow:function(){i.trigger('focusin');},onAfterHide:function(){i.trigger('focusout');}});},disable:function(){var e=this,t=e.element;t.find(e.buttonSelector).prop('disabled',!0);},enable:function(){var e=this,t=e.element;t.find(e.buttonSelector).prop('disabled',!1);},getValue:function(){return this.value;},setValue:function(e,t){var i=this;if(t=t||{},t.force||e!=i.value)i.value=e,i.input.val(null==e?'':e),i.silence=t.silence,i.comboBox.setValue(e),delete i.silence;},refresh:function(e){this.comboBox.refresh(e);},dispose:function(){var e=this;n.dispose(e),e.comboBox.dispose(),e.input=e.element=e.comboBox=null;}},i(e.prototype),e.defaultOptions={defaultText:'请选择',buttonSelector:'.btn-default',menuSelector:'.dropdown-menu',labelSelector:'.btn-default span',activeClass:'active',openClass:'open',renderTemplate:function(e){var t=[];return $.each(e,function(e,i){var n=[];$.each(i,function(e,t){if('text'!==e&&null!=t)n.push('data-'+e+'="'+t+'"');}),t.push('<li '+n.join(' ')+'>'+i.text+'</li>');}),t.join('');},setText:function(e){this.element.find(this.labelSelector).html(e);}},e;}),define('cobble/form/Text',['require','exports','../helper/Input','../helper/Placeholder','../function/init','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return r.init(this,e);}var t=require('../helper/Input'),i=require('../helper/Placeholder'),n=require('../function/init'),o=require('../function/jquerify'),r=require('../function/lifeCycle');return e.prototype={constructor:e,type:'Text',init:function(){var e=this,n=e.element;e.placeholder=new i({element:n,simple:e.placeholderSimple,nativeFirst:e.placeholderNativeFirst,placeholderSelector:e.placeholderSelector,template:e.template});var o=e.action;if(o)$.each(o,function(t,i){o[t]=$.proxy(i,e);});e.input=new t({element:n,onChange:function(t){e.emit(t);},onKeyDown:function(t){e.emit(t);},action:o});},getValue:function(){return $.trim(this.element.val());},setValue:function(e,t){var i=this;if(t=t||{},t.force||i.getValue()!==e){if(i.element.val(e),i.placeholder)i.placeholder.refresh();if(!t.silence)i.emit('change');}},dispose:function(){var e=this;r.dispose(e),e.input.dispose(),e.placeholder.dispose(),e.element=e.input=e.placeholder=null;}},o(e.prototype),e.defaultOptions={simple:!1,nativeFirst:!0,placeholderSelector:'.placeholder',template:'<div class="placeholder-wrapper"><div class="placeholder"></div></div>'},e.init=n(e),e;}),define('cobble/form/Validator',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return o.init(this,e);}function t(e,t){if(e.length>0){var i=e[0].element;if(i.is(':hidden'))i=i.parent();var n=i.offset().top;if(t>0)n-=t;window.scrollTo(window.scrollX,n);}}function i(e){var t=$.Deferred();return $.when.apply($,e).done(function(){t.resolve(arguments);}),t;}var n=require('../function/jquerify'),o=require('../function/lifeCycle');e.prototype={constructor:e,type:'Validator',init:function(){var t=this,i=t.element,n='FORM'===i.prop('tagName')?i:i.find('form');if(n.length>0)n.attr('novalidate','novalidate').on('submit'+a,$.proxy(t.validate,t));$.each(t.fields,function(t,n){var o=i.find('[name="'+t+'"]'),a=n.type;if(!a)a=n.type=o.attr('type')||'text';var s=n.rules;if(!s)s=n.rules={};var l=e.type[a]||[];$.each(l,function(e,t){if(null==s[t]){var i=r[t];if($.isFunction(i))s[t]=i(o,n);}});});var o=t.groupSelector;if(i.on('focusin'+a,function(e){var i=$(e.target).closest(o),n=[t.successClass,t.errorClass,t.requiredClass].join(' ');i.removeClass($.trim(n));}),t.realtime)i.on('focusout'+a,function(e){var i=$(e.target),n=i.prop('name');if(!n)i=i.find('[name]'),n=i.prop('name');if(n)t.validate(n);});},validate:function(e,n){var o=this,r=o.emit('beforeValidate');if(!r.isDefaultPrevented()){var a,s=o.element,l=o.groupSelector;if('string'===$.type(e))e=[e];if($.isArray(e))a=$.map(e,function(e){return s.find('[name="'+e+'"]').closest(l);});else if(a=s.find(l),'boolean'===$.type(e))n=e;var u=[],c=[];$.each(a,function(e,t){var i=o.validateGroup($(t));if(i){if(i.promise)c.push(i),i=i.data;$.merge(u,i);}});var e=[],f=[],p=function(){if($.each(u,function(t,i){if(i.error)f.push(i);e.push(i.element.prop('name'));}),n)t(f,o.scrollGap);o.emit('afterValidate',{fields:e,errors:f});};if(c.length>0)return i(c).done(p);else return p(),0===f.length;}},validateGroup:function(t){if(t.is(':visible')){var n=this,o=[],r=[],a=[];if(t.find('[name]').each(function(t){var i,s,l=this,u=l.name,c=l.value,f=l.disabled,p=$(l);if(!f){var d=n.fields[u];if(d){i=!0,d=$.extend(!0,{},d),d.form=n.element,d.value=$.trim(c);var h;if($.each(e.type[d.type]||[],function(t,i){var n=e.rule[i](d);if(n===!1)return h=i,!1;else if(''===d.value&&'required'===i)return!1;}),h){var m=d.errors;if(m)s=m[h];if(!s)throw new Error(u+' 字段 '+h+' 类型错误信息未定义');}else if($.isFunction(d.custom)){var v=$.Deferred(),g=d.custom(p,function(e){v.resolve(e);});s=null==g||g.done?v:g;}}}if(i)if(t=o.push({element:p,error:s}),s&&s.promise)r.push(s),a.push(t-1);}),r.length>0){var s=i(r).done(function(e){$.each(e,function(e,t){o[a[e]].error=t;}),n.refreshGroup(t,o);});return s.data=o,s;}else return n.refreshGroup(t,o),o;}},refreshGroup:function(e,t){var i=this,n=i.successClass,o=i.errorClass;$.each(t,function(t,r){var a,s=r.element,l=r.error,u=i.errorSelector;if(u)a=e.find(u).eq(t);if(l&&'string'===$.type(l)){if(e.removeClass(n).addClass(o),a){var c=i.renderTemplate;if($.isFunction(c))l=c({text:l},i.errorTemplate);a.html(l).show();var f=i.errorPlacement;if($.isFunction(f))f(s,a);}}else if(r.error='',e.removeClass(o).addClass(n),a)a.html('').hide();});},dispose:function(){var e=this;o.dispose(e),e.element.off(a),e.element=null;}},n(e.prototype),e.defaultOptions={realtime:!1,scrollGap:100,groupSelector:'.form-group',successClass:'has-success',errorClass:'has-error',errorSelector:'.error',errorTemplate:'<i class="icon icon-times-circle"></i>&nbsp;${text}',requiredClass:'has-required',requiredSelector:'.required',requiredTemplate:'${text}',renderTemplate:function(e,t){return t.replace(/\${(\w+)}/g,function(t,i){return e[i]||'';});},errorPlacement:function(e,t){if('hidden'===e.prop('type'))e=e.parent();t.css({position:'static',width:'auto'});var i=t.outerWidth(!0)+5;t.css({position:'absolute',width:i});var n=e.parent();if(n.is('.placeholder-wrapper'))e=n;var o=e.position();t.css({left:o.left+e.outerWidth()-37,top:o.top-t.outerHeight()+8});}},e.type={text:['required','pattern','min','max','minlength','maxlength'],hidden:['required'],password:['required','pattern','minlength','maxlength','equals'],number:['required','pattern','min','max','step'],range:['required','pattern','min','max','step'],tel:['required','pattern'],url:['required','pattern'],email:['required','pattern'],mobile:['required','pattern'],money:['required','pattern','min','max'],idcard:['required','pattern'],'int':['required','pattern','min','max'],internationalMobile:['required','pattern']},e.rule={required:function(e){if(e.value.length>0)return!0;else if(e.rules.required)return!1;},pattern:function(e){var t=e.rules.pattern;if(t)return t.test(e.value);else return void 0;},minlength:function(e){var t=e.rules.minlength;if($.isNumeric(t))return e.value.length>=+t;else return void 0;},maxlength:function(e){var t=e.rules.maxlength;if($.isNumeric(t))return e.value.length<=+t;else return void 0;},min:function(e){var t=e.rules.min;if($.isNumeric(t))return e.value>=+t;else return void 0;},max:function(e){var t=e.rules.max;if($.isNumeric(t))return e.value<=+t;else return void 0;},step:function(e){var t=e.rules.step;if($.isNumeric(t)){var i=e.rules.min||1;return(e.value-i)%t===0;}},equals:function(e){var t=e.rules.equals;if(t){var i=e.form.find('[name="'+t+'"]');return e.value===$.trim(i.val());}}},e.pattern={number:/^[\d.]*$/,'int':/^\d+$/,url:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,tel:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,mobile:/^1[3-9]\d{9}$/,email:/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,money:/^[\d.]*$/,idcard:/(^\d{15}$)|(^\d{17}([0-9]|X)$)/i,internationalMobile:/^\d{7,20}$/};var r={required:function(e){return'required'===e.attr('required');},pattern:function(t,i){var n=t.attr('pattern')||e.pattern[i.type];if('string'===$.type(n))n=new RegExp(n);return n;},minlength:function(e){return e.attr('minlength');},maxlength:function(e){return e.attr('maxlength');},min:function(e){return e.attr('min');},max:function(e){return e.attr('max');},step:function(e){return e.attr('step');},equals:function(e){return e.attr('equals');}},a='.cobble_form_validator';return e;}),define('cobble/function/around',['require','exports','module'],function(){'use strict';return function(e,t,i,n){var o='string'===$.type(t),r=o?e[t]:e;if(!o)n=i,i=t;var a=function(){var e,t=arguments;if($.isFunction(i))e=i.apply(this,t);if(e!==!1){if($.isFunction(r))e=r.apply(this,t);if($.isFunction(n)){var o=n.apply(this,t);if('undefined'!==$.type(o))e=o;}return e;}};return o?e[t]=a:a;};}),define('cobble/function/call',['require','exports','module'],function(){'use strict';return function(e,t,i){if($.isFunction(e)){var n=$.isArray(i)?'apply':'call';return e[n](t,i);}};}),define('cobble/function/contains',['require','exports','module'],function(){'use strict';return function(e,t){if(e=e.jquery?e[0]:e,t=t.jquery?t[0]:t,!e||!t)return!1;if(e===t)return!0;else return $.contains(e,t);};}),define('cobble/function/debounce',['require','exports','module'],function(){'use strict';return function(e,t){t='number'===$.type(t)?t:50;var i;return function(){if(!i){var n=arguments;i=setTimeout(function(){i=null,e.apply(null,$.makeArray(n));},t);}};};}),define('cobble/function/decimalLength',['require','exports','module'],function(){'use strict';return function(e){var t=(''+e).split('.');return 2===t.length?t[1].length:0;};}),define('cobble/function/disableSelection',['require','exports','module'],function(){'use strict';var e=$('<i></i>')[0],t='onselectstart'in e,i='MozUserSelect'in e.style;if(e=null,t)return function(e){e=e||document,e.onselectstart=function(){return!1;};};if(i)return function(e){e=e||document.body,e.style.MozUserSelect='none';};else return $.noop;}),define('cobble/function/divide',['require','exports','module','./decimalLength','./float2Int'],function(require){'use strict';var e=require('./decimalLength'),t=require('./float2Int');return function(i,n){var o=Math.max(e(i),e(n));return i=t(i,o),n=t(n,o),i/n;};}),define('cobble/function/dragGlobal',['require','exports','module','../helper/Draggable','../util/instance','../util/dimension','./pin'],function(require){'use strict';{var e=require('../helper/Draggable'),t=require('../util/instance'),i=require('../util/dimension');require('./pin');}return function(n){return new e({element:n.element,container:t.body,draggingClass:n.draggingClass,handleSelector:n.handleSelector,cancelSelector:n.cancelSelector,rect:function(){var e=n.fixed,t=n.scrollable;return{x:e||t?0:i.getPageScrollLeft(),y:e||t?0:i.getPageScrollTop(),width:e||!t?i.getViewportWidth():i.getPageWidth(),height:e||!t?i.getViewportHeight():i.getPageHeight()};}});};}),define('cobble/function/enableSelection',['require','exports','module'],function(){'use strict';var e=$('<i></i>')[0],t='onselectstart'in e,i='MozUserSelect'in e.style;if(e=null,t)return function(e){e=e||document,e.onselectstart=null;};if(i)return function(e){e=e||document.body,e.style.MozUserSelect='';};else return $.noop;}),define('cobble/function/float2Int',['require','exports','module'],function(){'use strict';return function(e,t){var i,n=(''+e).split('.');if(t>=0);else t=0;if(1===n.length)i=e+new Array(t+1).join('0');else t=Math.max(0,t-n[1].length),i=n.join('')+new Array(t+1).join('0');return+i;};}),define('cobble/function/imageDimension',['require','exports','module'],function(){'use strict';var e=[];return function(t,i){var n=new Image(),o=e.push(n);n.onload=function(){var t=n.height;if(null!=t&&t>0)i(n.width,t),delete e[o-1],n=null;else setTimeout(n.onload,10);},n.src=t;};}),define('cobble/function/init',['require','exports','module'],function(){'use strict';return function(e){return function(t,i){var n=[];return t.each(function(){n.push(new e($.extend({element:$(this)},i)));}),n;};};}),define('cobble/function/innerOffset',['require','exports','module','./toNumber'],function(require){'use strict';var e=require('./toNumber');return function(t){var i=t.offset(),n=t.css('border-left-width'),o=t.css('border-top-width');return{left:i.left+e(n,0,'int'),top:i.top+e(o,0,'int')};};}),define('cobble/function/isHidden',['require','exports','module'],function(){'use strict';return function(e){e.css('display');return'none'===e.css('display')||0==e.css('opacity')||'hidden'===e.css('visibility');};}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var t=$.prototype,i={on:function(){return t.on.apply(e(this),arguments),this;},off:function(){return t.off.apply(e(this),arguments),this;},emit:function(i,n){var o=this,r=e(o);if(r){if(!i[$.expando])i='string'===$.type(i)?$.Event(i):$.Event(null,i);i.cobble=o;var a=[i];if(n)a.push(n);var s=o[$.camelCase('on-'+i.type)];if($.isFunction(s)&&s.apply(o,a)===!1)i.preventDefault();if(!i.isPropagationStopped())t.trigger.apply(r,a);return i;}},before:function(t){e(this).before(t);},after:function(t){e(this).after(t);},appendTo:function(t){e(this).appendTo(t);},prependTo:function(t){e(this).prependTo(t);}};return function(e){$.each(i,function(t,i){if(null==e[t])e[t]=i;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,t){var i=e.constructor,n='__cobble__'+i.prototype.type,o=t.element;if(o&&o.data(n))e=o.data(n);else if($.extend(e,i.defaultOptions,t),e.init(),o)o.data(n,e);return e;},exports.dispose=function(e){var t='__cobble__'+e.constructor.prototype.type,i=e.element;if(i)i.removeData(t);};}),define('cobble/function/offsetParent',['require','exports','module'],function(){'use strict';function e(e){return e.is('body')||'static'!==e.css('position');}return function(t){if(t.is('body'))return t;for(var i=t.parent();!e(i);)i=i.parent();return i;};}),define('cobble/function/outerOffset',['require','exports','module','./toNumber'],function(require){'use strict';var e=require('./toNumber');return function(t){var i=t.offset(),n=e(t.css('margin-left'),0,'int'),o=e(t.css('margin-top'),0,'int');return{left:i.left-n,top:i.top-o};};}),define('cobble/function/page',['require','exports','module','../util/instance'],function(require){'use strict';var e=require('../util/instance');return function(){if(e.body.prop('clientHeight')<e.html.prop('clientHeight'))return e.html;else return e.body;};}),define('cobble/function/pageHeight',['require','exports','module','./page'],function(require){'use strict';var e=require('./page');return function(){var t=e()[0];return Math.max(t.scrollHeight,t.clientHeight);};}),define('cobble/function/pageScrollLeft',['require','exports','module'],function(){'use strict';return function(){return Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);};}),define('cobble/function/pageScrollTop',['require','exports','module'],function(){'use strict';return function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop);};}),define('cobble/function/pageWidth',['require','exports','module','./page'],function(require){'use strict';var e=require('./page');return function(){var t=e()[0];return Math.max(t.scrollWidth,t.clientWidth);};}),define('cobble/function/parsePercent',['require','exports','module','./divide'],function(require){'use strict';var e=require('./divide'),t=/(-?\d+(\.\d+)?)%/;return function(i){if(t.test(i))return e(RegExp.$1,100);else return void 0;};}),define('cobble/function/pin',['require','exports','module','../util/instance','./parsePercent'],function(require){'use strict';function e(e){var t=o[e.x];if(null==t)t=e.x;if('string'===$.type(t)){var i=n(t);if(null!=i)t=i*(e.width||e.element.outerWidth());}return t;}function t(e){var t=o[e.y];if(null==t)t=e.y;if('string'===$.type(t)){var i=n(t);if(null!=i)t=i*(e.height||e.element.outerHeight());}return t;}var i=require('../util/instance'),n=require('./parsePercent'),o={left:0,top:0,center:'50%',middle:'50%',right:'100%',bottom:'100%'};return function(n){var o=n.element,r=n.attachment||{};if(!r.element)r.element=i.body;var a=r.element.offset(),s=a.left+e(r),l=a.top+t(r),u=s-e(n),c=l-t(n),f=n.offset;if(f){if('number'===$.type(f.x))u+=f.x;if('number'===$.type(f.y))c+=f.y;}var p={left:u,top:c},d=o.css('position');if('absolute'!==d&&'fixed'!==d)p.position='absolute';if(n.silence)return p;else o.css(p);};}),define('cobble/function/pinGlobal',['require','exports','module','./pin','../util/dimension','../function/viewport'],function(require){'use strict';var e=require('./pin'),t=require('../util/dimension'),i=require('../function/viewport');return function(n){var o={silence:!0,element:n.element,x:'50%'===n.x?'50%':0,y:'50%'===n.y?'50%':0,attachment:{element:i(),width:t.getViewportWidth(),height:t.getViewportHeight(),x:n.x,y:n.y}};if(!n.fixed)o.offset={x:t.getPageScrollLeft(),y:t.getPageScrollTop()};return e(o);};}),define('cobble/function/position',['require','exports','module','./offsetParent'],function(require){'use strict';var e=require('./offsetParent');return function(t){var i=e(t),n=t.css('position'),o=parseInt(t.css('left'),10),r=parseInt(t.css('top'),10),a=isNaN(o),s=isNaN(r);if(a||s)if(1===i.length){var l=t.offset(),u=i.offset();if(a)o=l.left-u.left-(parseInt(i.css('border-left-width'),10)||0);if(s)r=l.top-u.top-(parseInt(i.css('border-top-width'),10)||0);}else o=r=0;if(!n||'static'===n)n='absolute';return{position:n,left:o,top:r};};}),define('cobble/function/replaceWith',['require'],function(){'use strict';return function(e,t){e=e[0],t=t[0],e.parentNode.replaceChild(t,e);};}),define('cobble/function/restrain',['require','exports','module'],function(){'use strict';return function(e,t,i){if(t>e)e=t;else if(e>i)e=i;return e;};}),define('cobble/function/split',['require','exports','module'],function(){'use strict';return function(e,t){var i=[];return $.each(e.split(t),function(e,t){if(t=$.trim(t))i.push(t);}),i;};}),define('cobble/function/toNumber',['require','exports','module'],function(){'use strict';var e={'int':parseInt,'float':parseFloat};return function(t,i,n){if('number'!==$.type(t)){var o=e[n];if(t=o?o(t,10):+t,isNaN(t))t=i;}return t;};}),define('cobble/function/viewport',['require','exports','module','../util/instance'],function(require){'use strict';var e=require('../util/instance');return function(){if(e.body.prop('clientHeight')>e.html.prop('clientHeight'))return e.html;else return e.body;};}),define('cobble/function/viewportHeight',['require','exports','module'],function(){'use strict';return function(){return window.innerHeight||document.documentElement.clientHeight;};}),define('cobble/function/viewportWidth',['require','exports','module'],function(){'use strict';return function(){return window.innerWidth||document.documentElement.clientWidth;};}),define('cobble/helper/AjaxUploader',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return u.init(this,e);}function t(e,t){var i=new FormData();$.each(e.data,function(e,t){i.append(e,t);}),i.append(e.fileName,t.nativeFile),t.xhr.send(i);}function i(t,i){var n=i.nativeFile,o=i.file.size,r=i.chunk;if(!r)r=i.chunk={index:0,uploaded:0};var a=r.index,s=t.chunkSize,l=s*a,u=s*(a+1);if(u>o)u=o;if(r.uploading=u-l,r.uploading<=0)return void setTimeout(function(){t.emit('uploadError',{fileItem:i,errorCode:e.ERROR_CHUNK_SIZE});});var c='bytes '+(l+1)+'-'+u+'/'+o,f=i.xhr;f.setRequestHeader('Content-Type',''),f.setRequestHeader('X_FILENAME',encodeURIComponent(n.name)),f.setRequestHeader('Content-Range',c),f.send(n.slice(l,u));}function n(t,i){var n=i.xhr;if(n)$.each(p,function(e,t){n['on'+t.type]=null;}),$.each(d,function(e,t){n.upload['on'+t.type]=null;}),delete i.xhr;if(t.emit('uploadComplete',{fileItem:i}),i.status===e.STATUS_UPLOAD_SUCCESS||i.status===e.STATUS_UPLOAD_ERROR&&t.ignoreError){var r=i.index+1;if(r<t.fileQueue.files.length)t.fileQueue.index=r,t.upload();else o(t,[]);}}function o(t,i){var n=t.fileQueue;n.index=0,n.files=$.map(i,function(t,i){return{index:i,file:s(t),nativeFile:t,status:e.STATUS_WAITING};});}function r(e){var t=e.fileQueue,i=t.index;if(t.files&&'number'===$.type(i))return t.files[i];else return void 0;}function a(e){var t=[];return $.each(e,function(e,i){if(f[i])t.push(f[i]);}),$.unique(t).join(',');}function s(e){var t=e.name,i=t.split('.'),n=i.length>0?i.pop().toLowerCase():'';return{name:t,type:n,size:e.size};}var l=require('../function/jquerify'),u=require('../function/lifeCycle');e.prototype={constructor:e,type:'AjaxUploader',init:function(){var e=this;e.fileQueue={};var t=e.element;if(!t.is(':file'))throw new Error('AjaxUploader element must be <input type="file" />');var i=e.faker=$('<form></form>');t.replaceWith(i),i.append(t);var n={};if(e.accept)n.accept=a(e.accept);if(e.multiple)n.multiple=!0;t.prop(n),t.on('change'+c,function(){o(e,t.prop('files')),e.emit('fileChange');}),e.emit('ready');},getFiles:function(){return this.fileQueue.files||[];},setAction:function(e){this.action=e;},setData:function(e){$.extend(this.data,e);},reset:function(){this.faker[0].reset();},upload:function(n){var o=this,a=o.useChunk?e.STATUS_UPLOADING:e.STATUS_WAITING;if(n=n||r(o),n&&!(n.status>a)){var s=new XMLHttpRequest();if(o.xhrProps)$.extend(s,o.xhrProps);n.xhr=s,$.each(p,function(e,t){s['on'+t.type]=function(e){t.handler(o,e);};}),$.each(d,function(e,t){s.upload['on'+t.type]=function(e){t.handler(o,e);};}),s.open('post',o.action,!0);var l=o.useChunk?i:t;l(o,n);}},stop:function(){var t=this,i=r(t);if(i&&i.status===e.STATUS_UPLOADING)i.xhr.abort();t.reset();},enable:function(){this.element.prop('disabled',!1);},disable:function(){this.element.prop('disabled',!0);},dispose:function(){var e=this;u.dispose(e),e.stop(),e.element.off(c),e.faker=e.element=e.fileQueue=null;}},l(e.prototype),e.defaultOptions={data:{},multiple:!1,fileName:'Filedata',ignoreError:!1},e.supportChunk='undefined'!=typeof FileReader,e.STATUS_WAITING=0,e.STATUS_UPLOADING=1,e.STATUS_UPLOAD_SUCCESS=2,e.STATUS_UPLOAD_ERROR=3,e.ERROR_CANCEL=0,e.ERROR_CHUNK_SIZE=-1;var c='.cobble_helper_ajaxuploader',f={html:'text/html',htm:'text/html',shtml:'text/html',xml:'text/xml',css:'text/css',js:'application/x-javascript',json:'application/json',atom:'application/atom+xml',rss:'application/rss+xml',mml:'text/mathml',txt:'text/plain',jad:'text/vnd.sun.j2me.app-descriptor',wml:'text/vnd.wap.wml',htc:'text/x-component',jpg:'image/jpeg',jpeg:'image/jpeg',png:'image/png',gif:'image/gif',tif:'image/tiff',tiff:'image/tiff',wbmp:'image/vnd.wap.wbmp',ico:'image/x-icon',jng:'image/x-jng',bmp:'image/x-ms-bmp',svg:'image/svg+xml',svgz:'image/svg+xml',webp:'image/webp',mp3:'audio/mpeg',wma:'audio/x-ms-wma',wav:'audio/x-wav',mid:'audio/midi',midd:'audio/midi',kar:'audio/midi',ogg:'audio/ogg',m4a:'audio/x-m4a',ra:'audio/x-realaudio',ram:'audio/x-pn-realaudio',mod:'audio/mod','3gp':'video/3gpp','3gpp':'video/3gpp',mp4:'video/mp4',mpeg:'video/mpeg',mpg:'video/mpeg',mov:'video/quicktime',webm:'video/webm',flv:'video/x-flv',m4v:'video/x-m4v',mng:'video/x-mng',asx:'video/x-ms-asf',asf:'video/x-ms-asf',wmv:'video/x-ms-wmv',avi:'video/x-msvideo',rm:'video/vnd.rn-realvideo',rmvb:'video/vnd.rn-realvideo',ts:'video/MP2T',dv:'video/x-dv',mkv:'video/x-matroska',jar:'application/java-archive',war:'application/java-archive',ear:'application/java-archive',hqx:'application/mac-binhex40',pdf:'application/pdf',ps:'application/postscript',eps:'application/postscript',ai:'application/postscript',rtf:'application/rtf',wmlc:'application/vnd.wap.wmlc',kml:'application/vnd.google-earth.kml+xml',kmz:'application/vnd.google-earth.kmz','7z':'application/x-7z-compressed',cco:'application/x-cocoa',jardiff:'application/x-java-archive-diff',jnlp:'application/x-java-jnlp-file',run:'application/x-makeself',pl:'application/x-perl',pm:'application/x-perl',prc:'application/x-pilot',pdb:'application/x-pilot',rar:'application/x-rar-compressed',rpm:'application/x-redhat-package-manager',sea:'application/x-sea',swf:'application/x-shockwave-flash',sit:'application/x-stuffit',tcl:'application/x-tcl',tk:'application/x-tcl',der:'application/x-x509-ca-cert',pem:'application/x-x509-ca-cert',crt:'application/x-x509-ca-cert',xpi:'application/x-xpinstall',xhtml:'application/xhtml+xml',zip:'application/zip',bin:'application/octet-stream',exe:'application/octet-stream',dll:'application/octet-stream',deb:'application/octet-stream',dmg:'application/octet-stream',eot:'application/octet-stream',iso:'application/octet-stream',img:'application/octet-stream',msi:'application/octet-stream',msp:'application/octet-stream',msm:'application/octet-stream',doc:'application/msword',xls:'application/vnd.ms-excel',ppt:'application/vnd.ms-powerpoint',docx:'application/vnd.openxmlformats-officedocument.wordprocessingml.document',xlsx:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',pptx:'application/vnd.openxmlformats-officedocument.presentationml.presentation'},p={uploadStart:{type:'loadstart',handler:function(t){var i=r(t);i.status=e.STATUS_UPLOADING,t.emit('uploadStart',{fileItem:i});}},uploadSuccess:{type:'load',handler:function(t,i){var o=r(t),a={fileItem:o,responseText:o.xhr.responseText},s=o.chunk;if(s){var l=s.uploaded;if(l<o.file.size){var i=t.emit('chunkUploadSuccess',a);if(!i.isDefaultPrevented())if(s.index++,s.uploaded=l+s.uploading,s.uploaded<o.file.size)t.upload();else return o.status=e.STATUS_UPLOAD_SUCCESS,t.emit('uploadSuccess',a),void n(t,o);return;}}o.status=e.STATUS_UPLOAD_SUCCESS,t.emit('uploadSuccess',a),n(t,o);}},uploadError:{type:'error',handler:function(t,i,o){var a=r(t);a.status=e.STATUS_UPLOAD_ERROR,t.emit('uploadError',{fileItem:a,errorCode:o}),n(t,a);}},uploadStop:{type:'abort',handler:function(t,i){p.uploadError.handler(t,i,e.ERROR_CANCEL);}}},d={uploadProgress:{type:'progress',handler:function(e,t){var i=r(e),n=i.file.size,o=t.loaded,a=i.chunk;if(a)o+=a.uploaded;var s=o/(n||1);if(s>=0&&1>=s);else if(0>s)s=0;else if(s>1)s=1;s=parseInt(100*s,10)+'%',e.emit('uploadProgress',{fileItem:i,uploaded:o,total:n,percent:s});}}};return e;}),define('cobble/helper/Draggable',['require','exports','module','../function/page','../function/toNumber','../function/restrain','../function/position','../function/contains','../function/jquerify','../function/lifeCycle','../function/innerOffset','../function/outerOffset','../function/pageScrollLeft','../function/pageScrollTop','../function/enableSelection','../function/disableSelection','../util/instance','../util/mouse'],function(require){'use strict';function e(e){return u.init(this,e);}function t(e){var t=b(e),i=y(e);if(w.left!==t||w.top!==i){w.left=t,w.top=i;var n=e.data;if(1===++x){var o=n.draggingClass;if(o)n.element.addClass(o);n.emit('beforeDrag');}if(!n.silence)n.element.css(w);n.emit('drag',w);}}function i(e){h(),v.document.off(_);var t=e.data,i=t.draggingClass;if(i)t.element.removeClass(i);if(x>0)t.emit('afterDrag',w);x=b=y=null;}function n(e,t,i){var n=!1;if($.isArray(t))t=t.join(',');return e.find(t).each(function(){if(n=s(this,i))return!1;else return void 0;}),n;}var o=require('../function/page'),r=(require('../function/toNumber'),require('../function/restrain')),a=require('../function/position'),s=require('../function/contains'),l=require('../function/jquerify'),u=require('../function/lifeCycle'),c=require('../function/innerOffset'),f=require('../function/outerOffset'),p=require('../function/pageScrollLeft'),d=require('../function/pageScrollTop'),h=require('../function/enableSelection'),m=require('../function/disableSelection'),v=require('../util/instance'),g=require('../util/mouse');e.prototype={constructor:e,type:'Draggable',init:function(){var e=this,r=e.element;if(!e.container)e.container=o();r.css(a(r)),$.each(g,function(o,l){if(l.support)r.on(l.mousedown+_,function(u){var p=u.target,d=e.handleSelector,h=e.cancelSelector;if(!(d&&!n(r,d,p)||h&&n(r,h,p))){var g=C[o],$=f(r),T=g.absoluteX(u)-$.left,q=g.absoluteY(u)-$.top,O=e.container;if(s(O,r)){var k=c(O);T+=k.left,q+=k.top;}var j=a(r),U=j.position;w.left=j.left,w.top=j.top;var A=e.axis,P=e.getRectange(!0);b='y'===A?S.constant(w.left):S.change(g[U+'X'],T,P.x,P.x+P.width),y='x'===A?S.constant(w.top):S.change(g[U+'Y'],q,P.y,P.y+P.height),x=0,m(),v.document.on(l.mousemove+_,e,t).on(l.mouseup+_,e,i);}});});},getRectange:function(e){var t=this,i=t.rect;if($.isFunction(i))i=t.rect();if(e){var n=t.element,o=i.width-n.outerWidth(!0),r=i.height-n.outerHeight(!0);i.width=Math.max(0,o),i.height=Math.max(0,r);}return i;},setRectange:function(e){this.rect=e;},dispose:function(){var e=this;u.dispose(e),e.element.off(_),e.element=e.container=null;}},l(e.prototype),e.defaultOptions={rect:function(){var e=this,t=e.container,i={x:0,y:0,width:t.innerWidth(),height:t.innerHeight()};if(!s(t,e.element)){var n=c(t);i.x=n.left,i.y=n.top;}return i;}};var b,y,x,_='.cobble_helper_draggable',w={},S={constant:function(e){return function(){return e;};},change:function(e,t,i,n){return function(o){return r(e(o)-t,i,n);};}},C={};return $.each(g,function(e,t){if(t.support)C[e]={absoluteX:function(e){return t.clientX(e)+p();},absoluteY:function(e){return t.clientY(e)+d();},fixedX:function(e){return t.clientX(e);},fixedY:function(e){return t.clientY(e);}};}),e;}),define('cobble/helper/FlashUploader',['require','exports','module','../util/supload/supload','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return n.init(this,e);}require('../util/supload/supload');var t=window.Supload,i=require('../function/jquerify'),n=require('../function/lifeCycle');e.prototype={constructor:e,type:'FlashUploader',init:function(){var e=this,i={flashUrl:e.flashUrl,element:e.element[0],action:e.action,accept:e.accept,multiple:e.multiple,data:e.data,fileName:e.fileName,ignoreError:e.ignoreError,customSettings:{uploader:e}};$.each(o,function(e,t){e=$.camelCase('on-'+e),i[e]=t;}),e.supload=new t(i);},getFiles:function(){return this.supload.getFiles();},setAction:function(e){this.supload.setAction(e);},setData:function(e){this.supload.setData(e);},reset:function(){this.supload.reset();},upload:function(){this.supload.upload();},stop:function(){this.supload.cancel();},enable:function(){this.supload.enable();},disable:function(){this.supload.disable();},dispose:function(){var e=this;n.dispose(e),e.supload.dispose(),e.supload=e.element=null;}},i(e.prototype),e.defaultOptions={multiple:!1,fileName:'Filedata',ignoreError:!1,flashUrl:require.toUrl('../util/supload/supload.swf')},e.STATUS_WAITING=t.STATUS_WAITING,e.STATUS_UPLOADING=t.STATUS_UPLOADING,e.STATUS_UPLOAD_SUCCESS=t.STATUS_UPLOAD_SUCCESS,e.STATUS_UPLOAD_ERROR=t.STATUS_UPLOAD_ERROR,e.ERROR_CANCEL=t.ERROR_CANCEL,e.ERROR_SECURITY=t.ERROR_SECURITY,e.ERROR_IO=t.ERROR_IO;var o={ready:function(){var e=this.customSettings.uploader;e.emit('ready');},fileChange:function(){var e=this.customSettings.uploader;e.emit('fileChange');},uploadStart:function(e){var t=this.customSettings.uploader;t.emit('uploadStart',e);},uploadProgress:function(e){var t=this.customSettings.uploader,i=e.uploaded/(e.total||1);if(i>=0&&1>=i);else i=0;e.percent=parseInt(100*i,10)+'%',t.emit('uploadProgress',e);},uploadSuccess:function(e){var t=this.customSettings.uploader;t.emit('uploadSuccess',e);},uploadError:function(e){var t=this.customSettings.uploader;t.emit('uploadError',e);},uploadComplete:function(e){var t=this.customSettings.uploader;t.emit('uploadComplete',e);}};return e;}),define('cobble/helper/Input',['require','exports','module','../function/around','../function/jquerify','../function/lifeCycle','../util/keyboard','../util/input','./Keyboard'],function(require){'use strict';function e(e){return i.init(this,e);}var t=(require('../function/around'),require('../function/jquerify')),i=require('../function/lifeCycle'),n=require('../util/keyboard'),o=require('../util/input'),r=require('./Keyboard');e.prototype={constructor:e,type:'Input',init:function(){var e=this,t=e.element;o.init(t);var i=e.action;if(i)$.each(i,function(t,n){i[t]=$.proxy(n,e);});var s,l;e.keyboard=new r({element:t,action:i,longPress:e.longPress,onKeyDown:function(t){e.emit(t);},onKeyUp:function(t){e.emit(t);},onBeforeLongPress:function(){s=t.val(),l=!0,e.emit('beforeLongPress');},onAfterLongPress:function(i){if(l=!1,e.emit('afterLongPress'),s!==t.val()&&(n.isCharKey(i.keyCode)||n.isDeleteKey()))e.emit('change');}}),t.on('input'+a,function(){if(!l||!e.smart)e.emit('change');});},autoWidth:function(){var e=this,t=e.element;e.on('change',function(){if(t.scrollLeft()>0)t.width(t.prop('scrollWidth'));});},autoHeight:function(){var e=this,t=e.element;if('hidden'!==t.css('overflow-y'))t.css('overflow-y','hidden');var i,n=t.height(),o=n,r=parseInt(t.css('font-size'),10),a=t.innerHeight()-n;e.on('change',function(){if(o!==n)o=n,t.height(n);if(i=t.prop('scrollHeight')-a,Math.abs(i-o)>r)t.height(i),o=i;});},dispose:function(){var e=this;i.dispose(e);var t=e.element;o.dispose(t),t.off(a),e.keyboard.dispose(),e.element=e.keyboard=null;}},t(e.prototype),e.defaultOptions={smart:!0,longPress:!1};var a='.cobble_helper_input';return e;}),define('cobble/helper/Keyboard',['require','exports','module','../function/call','../function/split','../function/jquerify','../util/keyboard'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}function t(e){var t=[];return $.each(e,function(e,i){var n=[],o='plus',a=r(e.replace(/\$\+/g,o),'+');if($.each(s.combinationKey,function(e){if($.inArray(e,a)<0)a.push('!'+e);}),$.each(a,function(e,t){var i=0===t.indexOf('!');if(i)t=t.substr(1);if(t===o)t='$+';if(s.combinationKey[t])n.push((i?'!':'')+'e.'+t+'Key');else if(s[t])n.push('e.keyCode==='+s[t]);else return n.length=0,!1;}),n.length>0)t.push({test:new Function('e','return '+n.join('&')),handler:i});}),t;}function i(e){var t=e.data,i=e.keyCode,n=t.cache,r=n.counter;if(n.keyCode===i&&r>0){if(1===r)t.emit({type:'beforeLongPress',keyCode:i});r++;}else n.keyCode=i,r=1;if(n.counter=r,t.longPress||1===r)$.each(n.action,function(i,n){if(n.test(e))o(n.handler,t,e);});e.type='keyDown',t.emit(e);}function n(e){var t=e.data,i=t.cache;if(i.keyCode=null,i.counter>1)t.emit({type:'afterLongPress',keyCode:e.keyCode}),i.counter=0;e.type='keyUp',t.emit(e);}var o=require('../function/call'),r=require('../function/split'),a=require('../function/jquerify'),s=require('../util/keyboard');e.prototype={constructor:e,type:'Keyboard',init:function(){var e=this;e.cache={counter:0,action:t(e.action||{})},e.element.on('keydown'+l,e,i).on('keyup'+l,e,n);},dispose:function(){var e=this;e.element.off(l),e.element=e.cache=null;}},a(e.prototype),e.defaultOptions={longPress:!1};var l='.cobble_helper_keyboard';return e;}),define('cobble/helper/Placeholder',['require','exports','module','../function/init','../function/jquerify','../function/lifeCycle','../function/replaceWith','../util/input'],function(require){'use strict';function e(e){return n.init(this,e);}var t=require('../function/init'),i=require('../function/jquerify'),n=require('../function/lifeCycle'),o=require('../function/replaceWith'),r=require('../util/input');e.prototype={constructor:e,type:'Placeholder',init:function(){var e=this,t=e.element,i=t.attr('placeholder');if(null==e.value)e.value=i||'';var n;if(l)if(e.nativeFirst)n='native';else if(i)t.removeAttr('placeholder');if(!n)n=e.simple?'simple':'complex';if(n=u[n],$.extend(e,n),n.init)e.init();if(e.refresh)e.refresh();}},i(e.prototype),e.defaultOptions={simple:!1,nativeFirst:!0,simpleClass:'placeholder-active',placeholderSelector:'.placeholder',template:'<div class="placeholder-wrapper"><div class="placeholder"></div></div>'},e.init=t(e);var a='.cobble_helper_placeholder',s=$('<input type="text" />')[0],l='placeholder'in s;s=null;var u={'native':{show:$.noop,hide:$.noop,refresh:$.noop,dispose:function(){var e=this;n.dispose(e),e.element=null;}},simple:{init:function(){var e=this,t=$.proxy(e.refresh,e);e.element.on('focus'+a,t).on('blur'+a,t);},show:function(){var e=this;e.element.addClass(e.simpleClass).val(e.value);},hide:function(){var e=this;e.element.removeClass(e.simpleClass).val('');},refresh:function(){var e=this,t=e.element;if(document.activeElement===t[0]){if(t.hasClass(e.simpleClass))e.hide();}else if(!t.val())e.show();},dispose:function(){var e=this;n.dispose(e),e.element.off(a),e.element=null;}},complex:{init:function(){var e=this,t=e.element,i=$(e.template);o(t,i),i.append(t),e.faker=i.find(e.placeholderSelector);var n=$.proxy(e.refresh,e);r.init(t),t.on('focus'+a,n).on('blur'+a,n).on('input'+a,n);},show:function(){var e=this;e.faker.html(e.value).show();},hide:function(){this.faker.hide();},refresh:function(){var e=this,t=e.element.val();if($.trim(t))e.hide();else e.show();},dispose:function(){var e=this;n.dispose(e);var t=e.element;r.dispose(t),t.off(a),e.faker=e.element=null;}}};return e;}),define('cobble/helper/Popup',['require','exports','module','../function/split','../function/isHidden','../function/contains','../function/jquerify','../function/lifeCycle','../util/instance'],function(require){'use strict';function e(e){return C.init(this,e);}function t(e,t){$.each(e.showConfigList,function(i,n){n[t](e);});}function i(e,t){$.each(e.hideConfigList,function(i,n){n[t](e);});}function n(e,t){if(e)e.type=t;else e=t;return e;}function o(e){var t=e.currentTarget;return t&&'HTML'===t.tagName?null:t;}function r(e,t){return e.emit(n(t,'beforeShow'));}function a(e,n){return e.layer.data(U,o(n)),t(e,'off'),i(e,'on'),e.emit('afterShow');}function s(e,t){return e.emit(n(t,'beforeHide'));}function l(e){return e.layer.removeData(U),i(e,'off'),t(e,'on'),e.emit('afterHide');}function u(){return $.now();}function c(e){return'__'+e+'Handler__';}function f(e,t){return null==e[t];}function p(e,t){return e.layer.data(U)!==o(t);}function d(e,t,i){return!t||t(e,i);}function h(e,t){return t-e[j]>50;}function m(t,i){return function(n){var o=n.data,r=u(n);if(f(o,O)&&p(o,n)&&d(o,i,n))o[j]=r,g({popup:o,delay:o.show.delay,toggle:e.trigger.show[t].delay,timer:O,success:function(){var e=function(){o.open(n);},t=o[q];if(t)t.done(e);else e();}});};}function v(t,i){return function(n){var o=n.data,r=u(n);if(f(o,k)&&d(o,i,n)&&h(o,r))o[j]=r,o[q]=$.Deferred(),g({popup:o,delay:o.hide.delay,toggle:e.trigger.hide[t].delay,timer:k,success:function(){o.close(n),o[q].resolve();},fail:function(){o[q]=null;}});};}function g(e){var t=e.delay,i=e.success;if(t>0){var n=e.popup,o=e.timer,r=e.toggle||{},a=r.on||$.noop,s=r.off||$.noop,l=e.fail||$.noop,u=function(){clearTimeout(n[o]),s(n,c),n[o]=null;},c=function(e){var t=n[o];if(t)u();if(t&&e===j)i();else l();};a(n,c),n[o]=setTimeout(function(){c(j);},t);}else i();}function b(e){var t=this,i=t.type,n=t.handler,o=c(i);if(e[o]!==n)e.element.on(i,e.selector,e,n),e[o]=n;}function y(e){var t=this;if(!e.selector){var i=t.type;e.element.off(i,t.handler),e[c(i)]=null;}}var x=require('../function/split'),_=require('../function/isHidden'),w=require('../function/contains'),S=require('../function/jquerify'),C=require('../function/lifeCycle'),T=require('../util/instance');e.prototype={constructor:e,type:'Popup',init:function(){var n=this,o=n.showConfigList=[],r=n.hideConfigList=[],a=n.show.trigger,s=n.hide.trigger;if(a)$.each(x(a,','),function(t,i){var n=e.trigger.show[i];if(n)o.push(n);});if(s)$.each(x(n.hide.trigger,','),function(t,i){var n=e.trigger.hide[i];if(n)r.push(n);});if(n.hidden=_(n.layer))t(n,'on');else i(n,'on');},open:function(){var e=this,t=arguments[0];if(!t)e[j]=u();if(t=r(e,t),!t.isDefaultPrevented()){var i=e.layer,n=e.show.animation;if($.isFunction(n))n.call(e,i);else i.show();e.hidden=!1,a(e,t);}},close:function(){var e=this;if(!e.hidden){var t=arguments[0];if(!t)e[j]=u();if(t=s(e,t),!t.isDefaultPrevented()){var i=e.layer,n=e.hide.animation;if($.isFunction(n))n.call(e,i);else i.hide();e.hidden=!0,l(e);}}},dispose:function(){var e=this;C.dispose(e),e.close(),t(e,'off'),e.element=e.layer=null;}},S(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var q='__hidePromise__',O='__showTimer__',k='__hideTimer__',j='__lastTriggerTime__',U='__sourceElement__',A=function(e,t){if(!t)return!1;else return w(e.layer,t);};return e.trigger={show:{focus:{type:'focusin',handler:m('focus'),on:b,off:y},click:{type:'click',handler:m('click'),on:b,off:y},over:{type:'mouseenter',handler:m('over'),on:b,off:y,delay:{on:function(e,t){e.element.on('mouseleave',e.selector,t);},off:function(e,t){e.element.off('mouseleave',t);}}},context:{type:'contextmenu',handler:m('context'),on:b,off:y}},hide:{blur:{type:'focusout',handler:v('blur'),on:b,off:y},click:{type:'click',handler:function(){return v(this.type,function(e,t){return!A(e,t.target);});},on:function(e){var t=this;T.document.on(t.type,e,e.clickHandler=t.handler());},off:function(e){T.document.off(this.type,e.clickHandler);}},out:{type:'mouseleave',handler:v('out'),on:function(e){var t=this.type,i=this.handler;e.layer.on(t,e,i),e.element.on(t,e.selector,e,i);},off:function(e){var t=this.type,i=this.handler;e.element.off(t,i),e.layer.off(t,i);},delay:{on:function(e,t){e.element.on('mouseenter',e.selector,t),e.layer.on('mouseenter',t);},off:function(e,t){e.element.off('mouseenter',t),e.layer.off('mouseenter',t);}}},context:{type:'contextmenu',handler:function(){return v('context',function(e,t){return!A(e,t.target);});},on:function(e){var t=this;T.document.on(t.type,e,e.contextHandler=t.handler());},off:function(e){T.document.off(this.type,e.contextHandler);}}}},e;}),define('cobble/ui/ComboBox',['require','exports','module','../function/jquerify','../function/lifeCycle','../helper/Popup'],function(require){'use strict';function e(e){return i.init(this,e);}var t=require('../function/jquerify'),i=require('../function/lifeCycle'),n=require('../helper/Popup');e.prototype={constructor:e,type:'ComboBox',init:function(){var e=this,t=e.button,i=e.menu,r=e.element||t,a=e.openClass,s=e.show,l=e.hide,u=s.animation;if($.isFunction(u))s.animation=$.proxy(u,e);if(u=l.animation,$.isFunction(u))l.animation=$.proxy(u,e);if(e.popup=new n({element:t,layer:i,show:s,hide:l,onBeforeShow:function(t){e.emit(t);},onBeforeHide:function(t){e.emit(t);},onAfterShow:function(t){if(a)r.addClass(a);e.emit(t);},onAfterHide:function(t){if(a)r.removeClass(a);e.emit(t);}}),null==e.value){var c=i.find('.'+e.activeClass);if(1===c.length)e.value=c.data('value');}if(e.data)i.html(e.renderTemplate(e.data,e.template));if(null!=e.value)e.setValue(e.value,{force:!0,silence:!0});i.on('click'+o,'[data-value]',function(){e.setValue($(this).data('value')),e.close();});},getValue:function(){return this.value;},setValue:function(e,t){var i,n=this,o=n.menu,r=o.find('[data-value="'+e+'"]');if(1===r.length){if(i=r.data(),null==i.text)i.text=r.html();}else i={};if(t=t||{},t.force||e!=n.value){var a=n.activeClass;if(a)o.find('.'+a).removeClass(a);if(1===r.length){if(n.value=e,a)r.addClass(a);}else n.value=null;if(!t.silence)n.emit('change',i);}if($.isFunction(n.setText))n.setText(i.text||n.defaultText);},refresh:function(e){var t=this,i=t.value,n={};if(e){var o=e.data;if(o)t.menu.html(t.renderTemplate(o,t.template));if('value'in e)i=e.value,n.force=!0;}t.setValue(i,n);},open:function(){this.popup.open();},close:function(){this.popup.close();},dispose:function(){var e=this;i.dispose(e),e.menu.off(o),e.popup.dispose(),e.popup=e.element=e.button=e.menu=null;}},t(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var o='.cobble_ui_combobox';return e;}),define('cobble/ui/Dialog',['require','exports','module','../util/instance','../util/dimension','../function/jquerify','../function/lifeCycle','../function/offsetParent','../function/debounce','../function/pinGlobal','../function/dragGlobal'],function(require){'use strict';function e(e){return o.init(this,e);}var t=require('../util/instance'),i=require('../util/dimension'),n=require('../function/jquerify'),o=require('../function/lifeCycle'),r=require('../function/offsetParent'),a=require('../function/debounce'),s=require('../function/pinGlobal'),l=require('../function/dragGlobal');e.prototype={constructor:e,type:'Dialog',init:function(){var e=this,i=e.element||(e.element=$(e.template)),n=[],o=e.skinClass;if(o)n.push(o);var a=e.draggableClass;if(e.draggable&&a)n.push(a);if(n.length>0)i.addClass(n.join(' '));var s=e.removeOnEmpty,l=e.title;if(l)i.find(e.titleSelector).html(l);else if(s)i.find(e.headerSelector).remove();var c=e.content,f=i.find(e.bodySelector);if(c)f.html(c);else if(s)f.remove();var p=e.closeSelector,d=$.proxy(e.hide,e);if(p)i.on('click'+u,p,d);var h={};if(e.width)h.width=e.width;var m=e.fixed?'fixed':'absolute';if(i.css('position')!==m)h.position=m;if(!r(i).is('body'))t.body.append(i);if(e.modal){var v=e.mask||(e.mask=$(e.maskTemplate));if(i.before(v),e.hideOnClickMask)v.on('click'+u,d);var g='zIndex',b=e[g];if(!$.isNumeric(b))if(b=v.css(g),!$.isNumeric(b))b='auto';var y={overflow:'hidden'};y[g]=b,v.css(y),h[g]=b;}if(i.css(h),!e.hidden)e.hidden=!0,e.show();},show:function(){var e=this;if(e.hidden!==!1){var i=e.emit('beforeShow');if(!i.isDefaultPrevented()){var n=e.element,o=e.scrollable;if(e.draggable)e.drager=l({element:n,handleSelector:e.draggableHandleSelector,cancelSelector:e.draggableCancelSelector,draggingClass:e.draggingClass,fixed:e.fixed,scrollable:o});if(e.refresh(),e.showAnimation(),e.mask)e.showMaskAnimation();e.hidden=!1,t.window.resize(e.resizer=a(function(){e.refresh(!0);},50)),e.emit('afterShow');}}},hide:function(){var e=this;if(e.hidden!==!0){var i=e.emit('beforeHide');if(!i.isDefaultPrevented()){if(e.resizer)t.window.off('resize',e.resizer),e.resizer=null;if(e.drager)e.drager.dispose(),e.drager=null;if(e.hideAnimation(),e.mask)e.hideMaskAnimation();if(e.hidden=!0,e.emit('afterHide'),e.disposeOnHide)e.dispose();}}},refresh:function(){var e=this,t=arguments[0];if(!t||e.positionOnResize){var n=e.element,o=s({element:n,x:e.x,y:e.y,fixed:e.fixed});if(t)e.resizeAnimation(o);else n.css(o);}var r=e.mask;if(r)r.css({width:i.getPageWidth(),height:i.getPageHeight()});},dispose:function(){var e=this;if(o.dispose(e),!e.hidden)e.disposeOnHide=!1,e.hide();var t=e.element,i=e.mask;if(t.off(u),i)i.off(u);if(e.removeOnDispose)if(t.remove(),i)i.remove();e.element=e.mask=null;}},n(e.prototype),e.defaultOptions={x:'50%',y:'50%',modal:!0,fixed:!0,hidden:!1,draggable:!0,scrollable:!0,removeOnEmpty:!0,disposeOnHide:!0,removeOnDispose:!0,hideOnClickMask:!1,positionOnResize:!0,draggableClass:'draggable',draggableHandleSelector:'.dialog-header',draggableCancelSelector:['.dialog-header h1','.dialog-close'],headerSelector:'.dialog-header',titleSelector:'.dialog-header h1',closeSelector:'.dialog-close',bodySelector:'.dialog-body',template:'<div class="dialog"><i class="dialog-close">&times;</i><div class="dialog-header"><h1></h1></div><div class="dialog-body"></div></div>',maskTemplate:'<div class="dialog-mask"></div>',showAnimation:function(){this.element.show();},hideAnimation:function(){this.element.hide();},showMaskAnimation:function(){this.mask.show();},hideMaskAnimation:function(){this.mask.hide();},resizeAnimation:function(e){this.element.css(e);}};{var u='.cobble_ui_dialog';t.html.css('overflow'),t.body.css('overflow');}return e;}),define('cobble/ui/Uploader',['require','exports','module','../helper/AjaxUploader','../helper/FlashUploader'],function(require){'use strict';function e(){return'files'in $('<input type="file" />')[0];}function t(){if(!XMLHttpRequest)return!1;var e=new XMLHttpRequest();return'upload'in e&&'onprogress'in e.upload;}return e()&&t()?require('../helper/AjaxUploader'):require('../helper/FlashUploader');}),define('cobble/ui/Zoom',['require','exports','module','../function/jquerify','../function/lifeCycle','../function/offsetParent','../function/imageDimension','../util/instance'],function(require){'use strict';function e(e){return i.init(this,e);}var t=require('../function/jquerify'),i=require('../function/lifeCycle'),n=require('../function/offsetParent'),o=require('../function/imageDimension'),r=require('../util/instance');e.prototype={constructor:e,type:'Zoom',init:function(){var e=this,t=e.element;if(t.is(':hidden'))throw new Error('Zoom element must be visible!');var i=t.width(),s=t.height(),l=e.viewport,u=e.finder,c=u.outerWidth(!0),f=u.outerHeight(!0);u.hide(),l.hide();var p=e.url;o(p,function(e,o){var d=i/e,h=s/o,m=c/d,v=f/h;l.css({width:m,height:v,background:'url('+p+') no-repeat'});var g=t.offset(),b={left:0,top:0},y=g.left,x=g.top,_=y+i,w=x+s,$=n(t);if($.is('body'))g=b;var S=n(u),C=g;if($[0]!==S[0]){if(!S.is('body'))u.appendTo('body');C=b;}var T='mouseenter'+a,q='mousemove'+a;t.on(T,function(){u.show(),l.show(),r.document.on(q,function(t){var i=t.pageX,n=t.pageY;if(y>i||i>_||x>n||n>w)return u.hide(),l.hide(),void r.document.off(q);if(i-=0.5*c,n-=0.5*f,y>i)i=y;else if(i>_-c)i=_-c;if(x>n)n=x;else if(n>w-f)n=w-f;if(u.css({left:i-C.left,top:n-C.top}),i=(i-g.left)/d,n=(n-g.top)/h,i>e-m)i=e-m;if(n>o-v)n=o-v;l.css({'background-position':'-'+i+'px -'+n+'px'});});});});},dispose:function(){var e=this;i.dispose(e),r.document.off(a),e.element.off(a),e.element=e.finder=e.viewport=null;}},t(e.prototype),e.defaultOptions={};var a='.cobble_ui_zoom';return e;}),define('cobble/util/browser',['require','exports','module'],function(){'use strict';function e(e){var a,s=t(e)||n.exec(e)||o.exec(e)||i(e)||r.exec(e)||[];if(/Android/i.test(e))a='android';else if(/iPhone/i.test(e)||/iPad/i.test(e)||/iTouch/i.test(e))a='ios';else if(/Windows/i.test(e))a='windows';else if(/Macintosh/i.test(e))a='mac';else if(/Linux/i.test(e))a='linux';return{name:s[1]||'',version:s[2]||'0',os:a||''};}function t(e){var t,i=s.exec(e);if(i)t=i[1];else if(i=l.exec(e))t=parseInt(i[1],10)+4+'.0';if(t)return['','ie',t];else return void 0;}function i(e){var t=a.exec(e);if(t)return['','safari',t[1]];else return void 0;}var n=/(chrome)[ \/]([\w.]+)/,o=/(firefox)[ \/]([\w.]+)/,r=/(opera)(?:.*version)?[ \/]([\w.]+)/,a=/version[ \/]([\w.]+) safari/,s=/msie ([\w.]+)/,l=/trident[ \/]([\w.]+)/,u=e(navigator.userAgent.toLowerCase());if(u.name)u[u.name]=!0;return u;}),define('cobble/util/cookie',['require','exports','module'],function(require,exports){'use strict';function e(e){if(0===e.indexOf('"'))e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');var t={};try{e=decodeURIComponent(e.replace(/\+/g,' ')),$.each(e.split(';'),function(e,i){var n=i.split('='),o=$.trim(n[0]),r=$.trim(n[1]);if(o)t[o]=r;});}catch(i){}return t;}function t(e,t,n){var o=n.expires;if($.isNumeric(o)){var r=o;o=new Date(),o.setTime(o.getTime()+r*i);}document.cookie=[encodeURIComponent(e),'=',encodeURIComponent(t),o?';expires='+o.toUTCString():'',n.path?';path='+n.path:'',n.domain?';domain='+n.domain:'',n.secure?';secure':''].join('');}var i=3600000;exports.get=function(t){var i=e(document.cookie);return'string'===$.type(t)?i[t]:i;},exports.set=function(e,i,n){if($.isPlainObject(e))n=i,i=null;if(n=$.extend({},exports.defaultOptions,n),null===i)$.each(e,function(e,i){t(e,i,n);});else t(e,i,n);},exports.remove=function(e,i){if(null!=e)i=i||{},i.expires=-1,t(e,'',$.extend({},exports.defaultOptions,i));},exports.defaultOptions={path:'/'};}),define('cobble/util/dimension',['require','exports','module','../function/pageScrollTop','../function/pageScrollLeft','../function/pageWidth','../function/pageHeight','../function/viewportWidth','../function/viewportHeight'],function(require,exports){'use strict';var e=require('../function/pageScrollTop'),t=require('../function/pageScrollLeft'),i=require('../function/pageWidth'),n=require('../function/pageHeight'),o=require('../function/viewportWidth'),r=require('../function/viewportHeight');exports.getPageScrollTop=e,exports.getPageScrollLeft=t,exports.getPageWidth=i,exports.getPageHeight=n,exports.getViewportWidth=o,exports.getViewportHeight=r;}),define('cobble/util/input',['require','exports','module','../function/around'],function(require,exports){'use strict';function e(){}function t(e){var t=e.val(),n=!1;e.on('propertychange'+r,function(i){if(n)return void(n=!1);if('value'===i.originalEvent.propertyName){var o=e.val();if(o!==t)e.trigger('input'),t=o;}}),i(e,'val',function(){if(0!==arguments.length)n=!0;});}var i=require('../function/around'),n=$('<input type="text" />')[0],o='oninput'in n;n=null;var r='.cobble_util_input';exports.init=o?e:t,exports.dispose=function(e){e.off(r);};}),define('cobble/util/instance',['require','exports','module'],function(require,exports){exports.window=$(window),exports.document=$(document),exports.html=$(document.documentElement),exports.body=$(document.body);}),define('cobble/util/json',['require','exports','module'],function(require,exports,module){if('object'!=typeof JSON)JSON={};return function(){'use strict';function f(e){return 10>e?'0'+e:e;}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return'string'==typeof t?t:'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+e+'"';}function str(e,t){var i,n,o,r,a,s=gap,l=t[e];if(l&&'object'==typeof l&&'function'==typeof l.toJSON)l=l.toJSON(e);if('function'==typeof rep)l=rep.call(t,e,l);switch(typeof l){case'string':return quote(l);case'number':return isFinite(l)?String(l):'null';case'boolean':case'null':return String(l);case'object':if(!l)return'null';if(gap+=indent,a=[],'[object Array]'===Object.prototype.toString.apply(l)){for(r=l.length,i=0;r>i;i+=1)a[i]=str(i,l)||'null';return o=0===a.length?'[]':gap?'[\n'+gap+a.join(',\n'+gap)+'\n'+s+']':'['+a.join(',')+']',gap=s,o;}if(rep&&'object'==typeof rep){for(r=rep.length,i=0;r>i;i+=1)if('string'==typeof rep[i])if(n=rep[i],o=str(n,l))a.push(quote(n)+(gap?': ':':')+o);}else for(n in l)if(Object.prototype.hasOwnProperty.call(l,n))if(o=str(n,l))a.push(quote(n)+(gap?': ':':')+o);return o=0===a.length?'{}':gap?'{\n'+gap+a.join(',\n'+gap)+'\n'+s+'}':'{'+a.join(',')+'}',gap=s,o;}}if('function'!=typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null;},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf();};var cx,escapable,gap,indent,meta,rep;if('function'!=typeof JSON.stringify)escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},JSON.stringify=function(e,t,i){var n;if(gap='',indent='','number'==typeof i)for(n=0;i>n;n+=1)indent+=' ';else if('string'==typeof i)indent=i;if(rep=t,t&&'function'!=typeof t&&('object'!=typeof t||'number'!=typeof t.length))throw new Error('JSON.stringify');return str('',{'':e});};if('function'!=typeof JSON.parse)cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var i,n,o=e[t];if(o&&'object'==typeof o)for(i in o)if(Object.prototype.hasOwnProperty.call(o,i))if(n=walk(o,i),void 0!==n)o[i]=n;else delete o[i];return reviver.call(e,t,o);}var j;if(text=String(text),cx.lastIndex=0,cx.test(text))text=text.replace(cx,function(e){return'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4);});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'')))return j=eval('('+text+')'),'function'==typeof reviver?walk({'':j},''):j;throw new SyntaxError('JSON.parse');};}(),JSON;}),define('cobble/util/keyboard',['require','exports','module'],function(require,exports){'use strict';function e(e){var t={};return $.each(e,function(e,i){t[i]=e;}),t;}var t={a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,'`':192,'-':173,'=':61,'[':219,']':221,'\\':220,';':59,"'":222,',':188,'.':190,'/':191,$0:96,$1:97,$2:98,$3:99,$4:100,$5:101,$6:102,$7:103,$8:104,$9:105,'$.':110,'$+':107,'$-':109,'$*':106,'$/':111,space:32,tab:9},i={backspace:8,'delete':46},n={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,enter:13,esc:27,capslock:20,insert:45,home:36,end:35,pageup:33,pagedown:34,left:37,right:39,up:38,down:40},o={shift:16,ctrl:17,meta:91,alt:18};$.extend(exports,t,n,o),exports.charKey=t,exports.deleteKey=i,exports.functionKey=n,exports.combinationKey=o,exports.isCharKey=function(i){return i in e(t);},exports.isDeleteKey=function(t){return t in e(i);},exports.isFunctionKey=function(t){return t in e(n);},exports.isCombinationKey=function(t){return t in e(o);};}),define('cobble/util/mouse',['require','exports','module'],function(){'use strict';function e(e){return e.originalEvent.changedTouches[0];}var t=document.createElement('div'),i={support:'ontouchend'in t,click:'touchstart',mousedown:'touchstart',mousemove:'touchmove',mouseup:'touchend',pageX:function(t){return e(t).pageX;},pageY:function(t){return e(t).pageY;},clientX:function(t){return e(t).clientX;},clientY:function(t){return e(t).clientY;}},n={support:'onclick'in t,click:'click',mousedown:'mousedown',mousemove:'mousemove',mouseup:'mouseup',pageX:function(e){return e.pageX;},pageY:function(e){return e.pageY;},clientX:function(e){return e.clientX;},clientY:function(e){return e.clientY;}};return t=null,{touch:i,mouse:n};}),define('cobble/util/string',['require','exports','module'],function(require,exports){'use strict';function e(e){var t=e.charCodeAt(0);if(0===(-128&t))return 1;if(0===(-2048&t))return 2;if(0===(-65536&t))return 3;else return 4;}function t(t,i){for(var n=0,o=0,r=t.length;r>o&&(n+=Math.floor((e(t.charAt(o))+1)/2),i(n,o+1)!==!1);o++);}exports.getLength=function(e){var i=0;if('string'===$.type(e))t(e,function(e){i=e;});return i;},exports.truncate=function(e,i,n){if('number'!==$.type(i)||exports.getLength(e)<=i)return e;var o='';return t(e,function(t,n){if(t>i)return!1;else return void(o=e.substr(0,n));}),n='string'===$.type(n)?n:'...',o+n;},exports.encodeHTML=function(e){return String(e).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');},exports.decodeHTML=function(e){var t=String(e).replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"').replace(/&#39;/g,"'");return t.replace(/&#([\d]+);/g,function(e,t){return String.fromCharCode(parseInt(t,10));});};}),define('cobble/util/supload/supload',['require','exports','module','../cookie','../json'],function(require){function e(e){$.extend(this,e),this.init();}function t(){return'_Supload_'+o++;}if(window.Supload===e)return window.Supload;var i=require('../cookie'),n=require('../json');e.prototype={constructor:e,init:function(){var n=t();this.movieName=n;var o=this.element;if('string'===$.type(o))o=document.getElementById(o);var r=this.data||(this.data={});$.each(i.get(),function(e,t){if('undefined'===$.type(r[e]))r[e]=t;});var a=e.createSWF(n,this.flashUrl,this.getFlashVars());o.parentNode.replaceChild(a,o),this.element=a,this.onLog=function(e){console.log(e);},e.instances[n]=this;},getFlashVars:function(){var t=this,i=[];return $.each(['movieName','action','accept','multiple','fileName','data','ignoreError'],function(e,o){var r=t[o];if(null!=r){if($.isPlainObject(r))r=n.stringify(r);else if($.isArray(r))r=r.join(',');i.push(o+'='+encodeURIComponent(r));}}),i.push('projectName='+e.projectName),i.join('&amp;');},getFiles:function(){return this.element.getFiles&&this.element.getFiles()||[];},setAction:function(e){this.element.setAction&&this.element.setAction(e);},setData:function(e){this.element.setData&&this.element.setData(e);},reset:function(){this.element.reset&&this.element.reset();},upload:function(){this.element.upload&&this.element.upload();},cancel:function(){this.element.cancel&&this.element.cancel();},enable:function(){this.element.enable&&this.element.enable();},disable:function(){this.element.disable&&this.element.disable();},dispose:function(){this.element.dispose&&this.element.dispose(),e.instances[this.movieName]=null,window[this.movieName]=null;}},e.projectName='Supload',e.createSWF=function(t,i,n){var o='<object id="'+t+'" class="'+e.projectName.toLowerCase()+'" type="application/x-shockwave-flash" data="'+i+'"><param name="movie" value="'+i+'" /><param name="allowscriptaccess" value="always" /><param name="wmode" value="transparent" /><param name="flashvars" value="'+n+'" /></object>';return $(o)[0];},e.instances={},e.STATUS_WAITING=0,e.STATUS_UPLOADING=1,e.STATUS_UPLOAD_SUCCESS=2,e.STATUS_UPLOAD_ERROR=3,e.ERROR_CANCEL=0,e.ERROR_SECURITY=1,e.ERROR_IO=2;var o=178245;return window.Supload=e,e;}),define('common/center/courseComment',['require','exports','common/store_a1a35b3dfc','common/component/Editor_c19cafc60f','cobble/form/Text','common/form_2ef59f4d41','cobble/form/Validator','../service_9c322508d3','common/component/SaveButton_b1f301d041','common/component/CancelOrderDialog_35e9ea68ef','common/component/MoreImageUploader_749f9cc2b2','common/component/Rotatable_2030c1ef8f','common/component/ImageDialog_992ca63b0f'],function(require,exports){'use strict';var e=require('common/store_a1a35b3dfc'),t=require('common/component/Editor_c19cafc60f'),i=(require('cobble/form/Text'),require('common/form_2ef59f4d41'),require('cobble/form/Validator')),n=require('../service_9c322508d3'),o=require('common/component/SaveButton_b1f301d041'),r=require('common/component/CancelOrderDialog_35e9ea68ef'),a=require('common/component/MoreImageUploader_749f9cc2b2'),s={},l={},u=require('common/component/Rotatable_2030c1ef8f'),c=require('common/component/ImageDialog_992ca63b0f'),f=1,p={};exports.init=function(){function d(){$(window).on('beforeunload',function(){if(!m)return'评价内容尚未保存是否确定要离开\uFF1F';else return void 0;});}var h=$('#content'),m=!1;Tooltip.init(h.find('[data-title]'));var v=h.find('.form-editor'),g=h.find('.action'),b=h.find('.btn-comment'),y=0===e.get('user').type?'teacher':'student',x=h.find('.upload-pics');x.each(function(e,t){$(t).data('no',e),l[e]=new a({element:$(t),watermark:'photo',previewWidth:90,previewHeight:70,maxCount:5,onUploadStart:function(){b.prop('disabled',!0);},onUploadSuccess:function(){},onUploadComplete:function(){b.prop('disabled',!1);}});}),v.each(function(e,i){var n=$(i);new t({element:n,maxLength:200});}),h.find('.icon-star').addClass('scored'),g.each(function(e,t){s[e]=new i({realtime:!0,element:$(t),fields:{info:{rules:{required:!0,maxlength:200},errors:{required:'请输入评价信息',maxlength:'请将字数控制在 200 字以内'}}}});}),h.on('click','.icon',function(){var e=$(this),t=e.parent(),i=t.parent().parent();if(!i.hasClass('reviewed')){for(var n=e.index(),o=0;n>=o;o++)t.find('.icon:eq('+o+')').addClass('star-shine').addClass('scored');for(var r=4;r>n;r--)t.find('.icon:eq('+r+')').removeClass('star-shine').removeClass('scored');}}).on('mouseenter','.icon-star',function(){var e=$(this),t=e.parent(),i=t.parent().parent();if(!i.hasClass('reviewed')){for(var n=e.index(),o=0;n>=o;o++)t.find('.icon:eq('+o+')').addClass('star-shine');for(var r=4;r>n;r--)t.find('.icon:eq('+r+')').removeClass('star-shine');}}).on('mouseleave','.star-score',function(){var e=$(this),t=e.parent().parent();if(!t.hasClass('reviewed'))e.find('.icon').each(function(e,t){var i=$(t);if(!i.hasClass('scored'))i.removeClass('star-shine');else i.addClass('star-shine');});}).on('click','.appeal-order',function(e){var t=$(e.currentTarget);new r({userType:y,type:'appeal',url:t.data('url')});}).on('click','.comment',function(){var e=$(this),t=e.parent().parent();h.find('.action').hide(),h.find('.comment').show(),t.find('.action').show(),e.hide();}).on('click','.photo-item',function(){var e=$(this),t=e.parent().parent();t.find('.photo-item').removeClass('active'),e.addClass('active');var i=(e.data('vertical'),e.data('vheight'),e.data('horizontal')),n=e.data('hheight'),o=e.data('name'),r=t.find('.photo-wrapper'),a=r.find('.floater'),s=r.find('.rotate-img'),l=t.find('.photo-name');s.attr('src',i),r.css({width:400,height:300}),a.css({'margin-bottom':'-'+Math.floor(n/2)+'px'}),l.text(o),t.find('.comment-photo-player').show();h.find('.photo-wrapper').find('img');if(!r.data('rotateindex'))p[f]=new u({element:r.find('.rotate-img'),callback:function(){}}),r.data('rotateindex',f),f++;else{var c=r.data('rotateindex');p[c].rotate({animateTo:0,duration:1});}r.data('rotateangle',0);}).on('click','.packup',function(){var e=$(this),t=e.parent().parent().parent();t.find('.comment-photo-player').hide(),t.find('.photo-item').removeClass('active');}).on('click','.sourse',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-item'),n=t.find('.active'),o=i.index(n),r=i.map(function(e,t){return{url:$(t).data('image'),title:$(t).data('name')};});new c({data:r,index:o});}).on('click','.left',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-wrapper'),n=i.data('rotateindex'),o=i.data('rotateangle'),r=o-90;p[n].rotate({animateTo:r,duration:1}),i.data('rotateangle',r);}).on('click','.right',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-wrapper'),n=i.data('rotateindex'),o=i.data('rotateangle'),r=o+90;p[n].rotate({animateTo:r,duration:1}),i.data('rotateangle',r);}).on('click','.photo-wrapper',function(){var e=$(this);e.parent().find('.packup').click();}),b.each(function(e,t){{var i=$(t),r=$(t).data('tid'),a=$(t).data('pid');i.parent().parent().parent().parent();}new o({element:$(t),saveText:'正在发送...',save:function(){if(s[e].validate()){var t=h.find('.star-score:eq(0)').find('.scored').length;if(!t)return alert('请进行评分\uFF01'),!1;var i={purchase_id:a,info:info,total_score:t,teacher_user_id:r},o='/comment/addStudent';if('student'==y){o='/comment/addTeacher';var l=[],u=h.find('.show-images li');u.each(function(){var e=$(this).find('.form-group'),t=e.find('input[name="id"]').val(),i=e.find('.caption').text();l.push({storage_id:t,title:i});}),i.photo_list=l;}return n.sendComment(o,i,{errorHandler:{100061:function(e){var t={info:'评价信息'},i=e.data,n='你';$.each(i,function(e,i){if(i.length)n+='<span class="sensitive">在<em>'+t[e]+'</em>中输入的内容包含',$.each(i,function(e,t){n+='\u201C<em>'+t+'</em>\u201D';}),n+='\uFF1B</span><br />';}),n+='请删除后重新输入',alert({title:'温馨提示',content:n,width:450,buttons:[{text:'确定',type:'primary',handler:function(){this.hide();}}]});}}}).done(function(e){if(0===e.code)m=!0,success('评价成功\uFF01',function(){var t=e.data&&e.data.extra;if(t){if(t.coupon){var i=(t.coupon,$('<div class="comment-act"><div class="comment-act-mask"></div><div></div></div>').appendTo('body'));i.fadeIn(1000),setTimeout(function(){location.reload();},3000);}}else location.reload();});});}}});}),d();};}),define('common/component/CancelOrderDialog_35e9ea68ef',['require','exports','cobble/ui/Dialog','cobble/form/Select','common/component/Editor_c19cafc60f','common/service_9c322508d3','cobble/form/Validator','common/component/SaveButton_b1f301d041','common/store_a1a35b3dfc','cobble/util/json'],function(require){'use strict';function e(e){if($.extend(this,e),i=this.pageType||'orderList',this.price&&0!==+this.price)f='退款',p='申请退款';else f='取消',p='取消订单';t={teacher:{appeal:{title:'我要申诉',message:'',reason:'<li data-value="1">学生无故取消课程</li><li data-value="2">对学生学习态度不满意</li><li data-value="3">已自动支付\uFF0C但课程未按原计划进行</li><li data-value="4">对学生的评价不满意</li><li data-value="100">其他</li>',texrareaContent:['申诉原因\uFF1A','请选择申诉原因','请填写您的申诉原因']},order:{title:'取消订单',reason:'<li data-value="1">学生无真实上课意愿</li><li data-value="2">对学生不满意</li><li data-value="5">双方协商后取消</li><li data-value="100">其他</li>',message:'<div class="message-error"><i class="icon icon-info-circle"></i>您确认取消订单吗\uFF1F',texrareaContent:['取消原因\uFF1A','请选择取消原因','请填写您的取消原因']},lesson:{title:'取消课程',reason:'<li data-value="1">学生时间不合适</li><li data-value="2">我的时间不合适</li><li data-value="3">对学生不满意</li><li data-value="100">其他</li>',message:'<div class="message-primary"><i style="margin-right:6px;" class="icon icon-info-circle"></i>您确定取消该课程么\uFF1F 课程取消后\uFF0C将不能恢复\u3002</div>',texrareaContent:['取消原因\uFF1A','请选择取消原因','请填写您的取消原因']}},student:{appeal:{title:'我要申诉',message:'',reason:'<li data-value="1">无法与老师联系取消课程</li><li data-value="2">老师无故取消课程</li><li data-value="3">对老师授课态度不满意</li><li data-value="4">已自动支付\uFF0C但课程未按原计划进行</li><li data-value="100">其他</li>',texrareaContent:['申诉原因\uFF1A','请选择申诉原因','请填写您的申诉原因']},order:{title:p,reason:'<li data-value="1">与老师无法达成一致</li><li data-value="2">下错单了</li><li data-value="3">对老师不满意</li><li data-value="100">其他</li>',message:'<div class="message-error"><i class="icon icon-info-circle"></i>您确认'+p+'吗\uFF1F',texrareaContent:[f+'原因\uFF1A','请选择'+f+'原因','请填写您的'+f+'原因']},lesson:{title:'取消课程',reason:'<li data-value="1">老师时间不合适</li><li data-value="2">我的时间不合适</li><li data-value="3">对老师不满意</li><li data-value="100">其他</li>',message:'<div class="message-primary"><i style="margin-right:6px;" class="icon icon-info-circle"></i>您确定取消该课程么\uFF1F课程取消后\uFF0C将不能恢复\u3002</div>',texrareaContent:['取消原因\uFF1A','请选择取消原因','请填写您的取消原因']}}},this.init();}var t,i,n=require('cobble/ui/Dialog'),o=require('cobble/form/Select'),r=require('common/component/Editor_c19cafc60f'),a=require('common/service_9c322508d3'),s=require('cobble/form/Validator'),l=require('common/component/SaveButton_b1f301d041'),u=require('common/store_a1a35b3dfc'),c=require('cobble/util/json'),f='',p='';e.prototype={getPrice:function(){return this.price;},init:function(){var e='',f=Number(this.price);if(0==f)e=t[this.userType][this.type].message+'取消订单后将不能恢复\uFF0C直播课如果有回放则仅可看确认课酬部分的回放\u3002</div>';else if(this.price){if(e=t[this.userType][this.type].message,'student'==this.userType)e+='申请退款后直播课如果有回放则仅可看确认课酬部分的回放\u3002剩余金额将退回至原支付渠道\u3002退至其它支付渠道预计3-5个工作日到账\uFF0C退至跟谁学钱包实时到账\u3002';else e+='该订单还有未确认课酬'+this.price+'\uFF0C取消订单后\uFF0C未确认课酬将一并退还给学生\u3002';e+='</div>';}else e=t[this.userType][this.type].message+'</div>';var p=''+e+'<div class="reason"><i class="form-required"></i>'+t[this.userType][this.type].texrareaContent[0]+'<div class="dropdown"><button class="btn-default"><i class="caret"></i><span>'+t[this.userType][this.type].texrareaContent[1]+'</span></button><ul class="dropdown-menu" style="display: none;">'+t[this.userType][this.type].reason+'</ul></div></div><div class="form-group"><div class="form-editor"><div class="wrapper"><textarea class="form-text" name="remark" placeholder="'+t[this.userType][this.type].texrareaContent[2]+'"></textarea><div class="form-hint">还可以输入 <strong>200</strong> 个字</div></div></div></div>'+d,h=new n({title:t[this.userType][this.type].title,content:p,disposeOnHide:!0,width:450,skinClass:'cancel-order-dialog'}),m=h.element,v=(new o({element:m.find('.dropdown'),onChange:function(){m.find('.btn-primary').prop('disabled',!1);}}),new r({element:m.find('.form-editor'),maxLength:200}),this.url),g=this.postData,b=new s({element:m,realtime:!0,fields:{remark:{rules:{require:!0,maxlength:200},errors:{require:'必填',maxlength:'请将字数控制在 200 字以内'}}}});new l({element:m.find('.btn-confirm'),save:function(){m.find('.btn-confirm').prop('disabled',!0);var e=m.find('.dropdown-menu .active').first().data('value'),t=m.find('.form-text').first().val();if('100'==e&&t.length<1)alert({title:'温馨提示',content:'输入内容不能为空',buttons:[{text:'确定',type:'primary',handler:function(){m.find('.btn-confirm').prop('disabled',!1),this.hide();}}]});else{var n=$.extend({url:v,reason:e,reason_text:t},g||{});if(b.validate())if('orderDetail'===i&&0===u.get('user').type&&2===+u.get('courseType'))a.teacherCancelOrder({purchaseId:u.get('purchaseId'),action:'seller_cancel_order',args:c.stringify({reason:e,reason_text:t})}).done(function(e){if(0===e.code)m.find('.btn-confirm').prop('disabled',!1),success('提交成功',function(){location.reload();});});else a.cancelOrderByUrl(n).done(function(e){if(0===e.code)m.find('.btn-confirm').prop('disabled',!1),success('提交成功',function(){location.reload();});});}}}),m.on('click','.btn-cancel',function(){h.hide();});}};var d='<div class="dialog-action"><button class="btn btn-primary btn-confirm" disabled>确定</button><button class="btn btn-default btn-cancel">取消</button></div>';return e;}),define('common/component/Editor_c19cafc60f',['require','cobble/form/Text'],function(require){'use strict';function e(e){$.extend(this,e),this.init();}var t=require('cobble/form/Text');e.prototype={constructor:e,init:function(){var e=this,i=this.element,n=this.minLength||0,o=this.maxLength,r=(this.flexHeight||!1,this.autoHint||!1),a=i.find('.form-hint');if(n)a.html('还需要输入<strong>'+n+'</strong>个字');else if(!r)a.html('还可以输入<strong>'+o+'</strong>个字');var s=this.textarea=i.find('textarea'),l=function(){var t,i=s.val();if(i.length<n)t=n-i.length,a.html('还需要输入<strong>'+t+'</strong>个字');else if(i.length>=n&&i.length<=o)if(!r||i.length>=r)t=o-i.length,a.html('还可以输入<strong>'+t+'</strong>个字');else a.html('');else if(o<i.length)t=i.length-o,a.html('<span class="text-error">已超出<strong>'+t+'</strong>个字</span>');e.autoHeight();};this.textInput=new t({element:s,placeholderNativeFirst:!1,placeholderSimple:!1,onChange:l}),l();},getValue:function(){return this.textarea.val();},setValue:function(e){this.textInput.setValue(e),this.autoHeight();},autoHeight:function(){if(this.flexHeight){var e=this.textarea[0].scrollHeight+'px';this.textarea.css('height',e);}},validate:function(){return this.maxLength>=this.getValue().length;}};return e;}),define('common/component/ImageDialog_992ca63b0f',['require','cobble/ui/Dialog','../function/compressImage_1539d29a96','cobble/function/imageDimension','cobble/function/viewportHeight','../function/scale_330792fa50'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}var t=require('cobble/ui/Dialog'),i=require('../function/compressImage_1539d29a96'),n=require('cobble/function/imageDimension'),o=require('cobble/function/viewportHeight'),r=require('../function/scale_330792fa50');return e.prototype={init:function(){var e=this,i=e.dialog=new t({skinClass:'image-dialog',removeOnEmpty:!1,hideOnClickMask:!0,hidden:!0}),n=i.element,r=n.find('.dialog-header').outerHeight(),a=e.imageHeight=e.imageHeight?e.imageHeight:o()-r-20,s=e.imageWidth=e.imageWidth?e.imageWidth:4/3*a;n.width(s);var l=n.find('.dialog-body');l.height(a);var u='<i class="icon icon-chevron-left"></i><i class="icon icon-chevron-right"></i>';l.after(u),n.on('click','.icon-chevron-left',function(){e.setImage(e.index-1);}).on('click','.icon-chevron-right',function(){e.setImage(e.index+1);}),e.setImage(e.index);},setImage:function(e){var t=this,o=t.data[e],a=t.dialog,s=a.element;if(s.find(a.titleSelector).html(o.title),o.noCompress)var l=o.url;else var l=i({url:o.url,width:t.imageWidth,height:t.imageHeight,noCrop:!0});var u=s.find(a.bodySelector);o=$('<img src="'+l+'" />'),u.html(''),u.append(o),n(l,function(e,i){var n=r({width:e,height:i},{width:t.imageWidth,height:t.imageHeight});i*=n,o.css({width:e*n,height:i,position:'relative',top:(t.imageHeight-i)/2}),a.show();}),t.index=e;var c=s.find('.icon-chevron-left'),f=s.find('.icon-chevron-right');if(c.show(),f.show(),0===e)c.hide();if(e===t.data.length-1)f.hide();}},e.defaultOptions={},e;}),define('common/component/MoreImageUploader_749f9cc2b2',['require','cobble/ui/Uploader','../function/compressImage_1539d29a96','cobble/ui/Zoom','common/service_9c322508d3','cobble/util/string'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}{var t=require('cobble/ui/Uploader'),i=require('../function/compressImage_1539d29a96'),n=require('cobble/ui/Zoom'),o=require('common/service_9c322508d3');require('cobble/util/string');}e.prototype={constructor:e,init:function(){var e=this,a=e.element,s=e.maxSize,l=a.find('.btn-upload'),u=$('<input type="file" />');l.append(u);var c,f=a.find('.show-images'),p={};if('photo'==e.watermark)p.watermark=1;else if('cert'==e.watermark)p.watermark=2;e.status='waiting';var d=0,h=0;if(e.uploader=new t({element:u,multiple:!0,ignoreError:!0,accept:['jpg','png','jpeg'],action:e.action,data:p,fileName:'attachment',onFileChange:function(){var t=this,i=this.getFiles(),n=[];if($.each(i,function(i,o){if(o){var a=o.file,l=$.inArray(a.type,t.accept);if(-1===l)return e.uploader.reset(),void alert({title:'温馨提示',content:'文件格式错误\uFF0C请上传 '+t.accept.join('\u3001')+' 等格式的图片',buttons:[{text:'确定',type:'primary',action:function(){this.hide();}}]});if(s&&a.size/r>s)return e.uploader.reset(),void alert({title:'温馨提示',content:'请不要上传超过 '+s+'M 的图片',buttons:[{text:'确定',type:'primary',action:function(){this.hide();}}]});n.push(o);}}),h>=e.maxCount)i='',alert({title:'温馨提示',content:'最多只可上传5张照片哦~',buttons:[{text:'确定',type:'primary',action:function(){this.hide();}}]});else{var o=e.maxCount-h;if(n.length>o)i=n.slice(0,o);else i=n;}t.fileQueue.files=i,d=i.length,t.upload();},onUploadStart:function(){this.disable(),e.status='uploading';var t=$('<li data-no=""><span class="status">正在上传</span><span class="progress"><span class="progress-bar"></span></span></li>');if(f.append(t),$.isFunction(e.onUploadStart))e.onUploadStart();},onUploadProgress:function(t,i){var n=i.total,o=n>0?i.uploaded/n:1;if(c=f.find('.progress-bar').last(),c.width(100*o+'%'),$.isFunction(e.onUploadProgress))e.onUploadProgress();},onUploadSuccess:function(t,o){e.status='success',c.width(0);var r=c.closest('.progress');if(r.prev('.status').remove(),r.remove(),o.responseText){var s=$.parseJSON(o.responseText),u=f.find('li:last-child');if(0===s.code){var p=s.data.url,m=$('<div class="mask"></div><img src="'+i({url:p,width:e.previewWidth,height:e.previewHeight})+'" />'),v='<div class="action"><span class="rename"><i class="icon icon-edit-o"></i></span><span class="del"><i class="icon icon-close"></i></span></div>',g='<div class="form-group"><input type="hidden" name="id" value="'+s.data.id+'"><input class="form-text caption-input" type="text" name="caption" maxlength="14" placeholder="点击输入标题"><span class="error"></span></div>';if(u.append(m).append(v).append(g),e.zoomable)new n({element:m,finder:a.find('.image-finder'),viewport:a.find('.image-viewport'),url:p});if(e.data=s.data,d--,0===d)this.enable();if(h++,h>=5)this.disable(),l.removeClass('btn-primary').addClass('btn-gray');}else if(error('该张图片上传失败\uFF0C重新选择上传'),u.remove(),d--,0===d)this.enable();}if($.isFunction(e.onUploadSuccess))e.onUploadSuccess();},onUploadError:function(){if(e.status='error',error('预览失败'),e.data=null,$.isFunction(e.onUploadError))e.onUploadError();},onUploadComplete:function(){if(e.status='waiting',this.reset(),$.isFunction(e.onUploadComplete))e.onUploadComplete();}}),0===l.find('input[type="file"]').length)l.find('.supload').remove();else if(l.find('input[type="file"]').length>1)l.find('form').eq(0).remove();a.on('click','.btn-upload',function(e){var t=$(e.currentTarget);if(0===t.find('input[type="file"]').length)alert({title:'温馨提示',content:'该功能暂不支持低版本浏览器',buttons:[{text:'确定',type:'primary',action:function(){this.hide();}}]});}).on('mouseenter','.show-images li',function(){var e=$(this),t=e.find('.action');t.show();}).on('mouseleave','.show-images li',function(){var e=$(this),t=e.find('.action');t.hide();}).on('click','.rename',function(e){var t=$(e.currentTarget),i=t.closest('.action'),n=i.next('.form-group'),o=n.find('.caption'),r=o.html(),a=n.find('.caption-input');if(o.length)o.hide(),a.show(),a.val(r);a.focus();}).on('focusout','.caption-input',function(){var e=$(this),t=e.closest('.form-group'),i=t.find('.caption'),n=$.trim(e.val());if(0==i.length){if(n)i=$('<span class="caption"></span>'),t.prepend(i),i.text(n),e.hide();}else i.text(n),i.show(),e.hide();}).on('click','.del',function(t){var i=$(t.currentTarget),n=i.closest('.action'),r=n.next('.form-group'),a=r.find('input[name="id"]').val();if(0==d)o.delCommentImg({storageId:a}).done(function(t){if(0===t.code)if(i.closest('.upload-pics').find('.button').prop('disabled',!1),i.closest('li').remove(),h=f.find('li').length,5>h)l.removeClass('btn-gray').addClass('btn-primary'),e.uploader.enable();});});}},e.defaultOptions={maxSize:5,action:'/user/previewImage'};var r=1048576;return e;}),define('common/component/Rotatable_2030c1ef8f',['require','exports','cobble/util/browser'],function(require){function e(e){$.extend(this,e),this.init();}for(var t,n,o=require('cobble/util/browser'),r=document.getElementsByTagName('head')[0].style,a='transformProperty WebkitTransform OTransform msTransform MozTransform'.split(' '),s=0,l=a.length;l>s;s++)if(void 0!==r[a[s]])t=a[s];if(t)if(n=t.replace(/[tT]ransform/,'TransformOrigin'),'T'==n[0])n[0]='t';var u=1==o.ie&&'8.0'==o.version,c={};if(c.PhotoEffect=function(){if(t)return function(e,t){e.Wilq32={PhotoEffect:this},this._img=this._rootObj=this._eventObj=e,this._handleRotation(t);};else return function(e,t){if(this._img=e,this._onLoadDelegate=[t],this._rootObj=document.createElement('span'),this._rootObj.style.display='inline-block',this._rootObj.Wilq32={PhotoEffect:this},e.parentNode.insertBefore(this._rootObj,e),e.complete)this._Loader();else{var i=this;jQuery(this._img).bind('load',function(){i._Loader();});}};}(),c.PhotoEffect.prototype={_setupParameters:function(e){if(this._parameters=this._parameters||{},'number'!=typeof this._angle)this._angle=0;if('number'==typeof e.angle)this._angle=e.angle;if(this._parameters.animateTo='number'==typeof e.animateTo?e.animateTo:this._angle,this._parameters.step=e.step||this._parameters.step||null,this._parameters.easing=e.easing||this._parameters.easing||this._defaultEasing,this._parameters.duration=e.duration||this._parameters.duration||1000,this._parameters.callback=e.callback||this._parameters.callback||this._emptyFunction,this._parameters.center=e.center||this._parameters.center||['50%','50%'],'string'==typeof this._parameters.center[0])this._rotationCenterX=parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW;else this._rotationCenterX=this._parameters.center[0];if('string'==typeof this._parameters.center[1])this._rotationCenterY=parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH;else this._rotationCenterY=this._parameters.center[1];if(e.bind&&e.bind!=this._parameters.bind)this._BindEvents(e.bind);},_emptyFunction:function(){},_defaultEasing:function(e,t,i,n,o){return-n*((t=t/o-1)*t*t*t-1)+i;},_handleRotation:function(e,i){if(!t&&!this._img.complete&&!i)return void this._onLoadDelegate.push(e);if(this._setupParameters(e),this._angle==this._parameters.animateTo)this._rotate(this._angle);else this._animateStart();},_BindEvents:function(e){if(e&&this._eventObj){if(this._parameters.bind){var t=this._parameters.bind;for(var i in t)if(t.hasOwnProperty(i))jQuery(this._eventObj).unbind(i,t[i]);}this._parameters.bind=e;for(var i in e)if(e.hasOwnProperty(i))jQuery(this._eventObj).bind(i,e[i]);}},_Loader:function(){if(u)return function(){var e=this._img.width,t=this._img.height;this._imgWidth=e,this._imgHeight=t,this._img.parentNode.removeChild(this._img),this._vimage=this.createVMLNode('image'),this._vimage.src=this._img.src,this._vimage.style.height=t+'px',this._vimage.style.width=e+'px',this._vimage.style.position='absolute',this._vimage.style.top='0px',this._vimage.style.left='0px',this._aspectW=this._aspectH=1,this._container=this.createVMLNode('group'),this._container.style.width=e,this._container.style.height=t,this._container.style.position='absolute',this._container.style.top='0px',this._container.style.left='0px',this._container.setAttribute('coordsize',e-1+','+(t-1)),this._container.appendChild(this._vimage),this._rootObj.appendChild(this._container),this._rootObj.style.position='relative',this._rootObj.style.width=e+'px',this._rootObj.style.height=t+'px',this._rootObj.setAttribute('id',this._img.getAttribute('id')),this._rootObj.className=this._img.className,this._eventObj=this._rootObj;for(var i;i=this._onLoadDelegate.shift();)this._handleRotation(i,!0);};else return function(){this._rootObj.setAttribute('id',this._img.getAttribute('id')),this._rootObj.className=this._img.className,this._imgWidth=this._img.naturalWidth,this._imgHeight=this._img.naturalHeight;var e=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*e,this._height=3*e,this._aspectW=this._img.offsetWidth/this._img.naturalWidth,this._aspectH=this._img.offsetHeight/this._img.naturalHeight,this._img.parentNode.removeChild(this._img),this._canvas=document.createElement('canvas'),this._canvas.setAttribute('width',this._width),this._canvas.style.position='relative',this._canvas.style.left=-this._img.height*this._aspectW+'px',this._canvas.style.top=-this._img.width*this._aspectH+'px',this._canvas.Wilq32=this._rootObj.Wilq32,this._rootObj.appendChild(this._canvas),this._rootObj.style.width=this._img.width*this._aspectW+'px',this._rootObj.style.height=this._img.height*this._aspectH+'px',this._eventObj=this._canvas,this._cnv=this._canvas.getContext('2d');for(var t;t=this._onLoadDelegate.shift();)this._handleRotation(t,!0);};}(),_animateStart:function(){if(this._timer)clearTimeout(this._timer);this._animateStartTime=+new Date(),this._animateStartAngle=this._angle,this._animate();},_animate:function(){var e=+new Date(),t=e-this._animateStartTime>this._parameters.duration;if(t&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img){var i=this._parameters.easing(0,e-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate(~~(10*i)/10);}if(this._parameters.step)this._parameters.step(this._angle);var n=this;this._timer=setTimeout(function(){n._animate.call(n);},10);}if(this._parameters.callback&&t)this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj);},_rotate:function(){var e=Math.PI/180;if(u)return function(e){this._angle=e,this._container.style.rotation=e%360+'deg',this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+'px',this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+'px',this._container.style.top=this._rotationCenterY-this._imgHeight/2+'px',this._container.style.left=this._rotationCenterX-this._imgWidth/2+'px';};else if(t)return function(e){this._angle=e,this._img.style[t]='rotate('+e%360+'deg)',this._img.style[n]=this._parameters.center.join(' ');};else return function(t){this._angle=t,t=t%360*e,this._canvas.width=this._width,this._canvas.height=this._height,this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH),this._cnv.translate(this._rotationCenterX,this._rotationCenterY),this._cnv.rotate(t),this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY),this._cnv.scale(this._aspectW,this._aspectH),this._cnv.drawImage(this._img,0,0);};}()},u)c.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule('.rvml','behavior:url(#default#VML)');try{return!document.namespaces.rvml&&document.namespaces.add('rvml','urn:schemas-microsoft-com:vml'),function(e){return document.createElement('<rvml:'+e+' class="rvml">');};}catch(e){return function(e){return document.createElement('<'+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">');};}}();return e.prototype={constructor:e,init:function(){},rotate:function(e){if('undefined'!=typeof e)this.element.each(function(){if('number'==typeof e)e={angle:e};var t=[];if(!this.Wilq32||!this.Wilq32.PhotoEffect){var i=$.extend(!0,{},e),n=new c.PhotoEffect(this,i)._rootObj;t.push($(n));}else this.Wilq32.PhotoEffect._handleRotation(e);});},getRotateAngle:function(){var e=[];return this.element.each(function(){if(this.Wilq32&&this.Wilq32.PhotoEffect)e[i]=this.Wilq32.PhotoEffect._angle;}),e;},stopRotate:function(){this.element.each(function(){if(this.Wilq32&&this.Wilq32.PhotoEffect)clearTimeout(this.Wilq32.PhotoEffect._timer);});}},e;}),define('common/component/SaveButton_b1f301d041',['require'],function(){'use strict';function e(e){$.extend(this,e),this.init();}return e.prototype={init:function(){var e=this,t=e.element,i=t.html();if('BUTTON'!==t.prop('tagName'))throw new Error('SaveButton 必须使用 button 标签');var n=function(){var n=e.save();if(n)t.focus(),t.prop('disabled',!0),t.html(e.saveText||'正在保存...'),n.always(function(){setTimeout(function(){t.prop('disabled',!1),t.html(i);},10);});return!1;};if(t.click(n),e.form)e.form.submit(function(){return n(),!1;});}},e;}),define('common/form_2ef59f4d41',['require','exports','cobble/form/Validator'],function(require,exports){'use strict';function e(e){var t={},i=e.find('[name]');return i.each(function(){var e=this.name,i=this.value,n='radio'===this.type||'checkbox'===this.type;if(n){if(this.checked)t[e]=i;}else{var o=t[e];if(null==o)t[e]=i;else o=t[e]=[o],o.push(i);}}),$.each(t,function(e,i){t[e]=$.isArray(i)?i.join(','):$.trim(i);}),t;}function t(e,t){$.each(t,function(t,n){if(n){var o=e.find('[name="'+t+'"]'),r=o.closest('.form-group');r.removeClass('has-success').addClass('has-error');var a=r.find('.error');a.html(n),i.defaultOptions.errorPlacement(o,a);}});}var i=require('cobble/form/Validator');exports.parse=function(t){return e(t);},exports.get=function(i,n){return $.ajax({url:n,type:'get',dataType:'json',data:i.jquery?e(i):i}).done(function(e){if(e.code){var n=e.data;if(n)t(i,n);}return e;});},exports.post=function(i,n){return $.ajax({url:n,type:'post',dataType:'json',data:i.jquery?e(i):i}).done(function(e){if(e.code){var n=e.data;if(n)t(i,n);}return e;});};}),define('common/function/compressImage_1539d29a96',function(){function e(e,i,n,o,r){var a=0.05;if(o/r/(n/ i)>1+2*a)return'@1e_'+i+'w_1c_0i_1o_90Q_1x.'+e+'%7C0-'+a*i*r/o+'-'+i+'-'+n+'a.'+e.toLowerCase();else return t(e,i,n);}function t(e,t,i,n){return'@'+(n?0:1)+'e_'+t+'w_'+i+'h_1c_0i_1o_90Q_1x.'+e.toLowerCase();}return function(i){var n=i.url,o=n.split('.').pop();if('gif'===o)o='jpg';var r=i.width,a=i.height,s=i.rawWidth,l=i.rawHeight;if(r=Math.floor(r),a=Math.floor(a),null!=s&&null!=l)return s=Math.floor(s),l=Math.floor(l),n+e(o,r,a,s,l);else return n+t(o,r,a,i.noCrop);};}),define('common/function/scale_330792fa50',function(){'use strict';return function(e,t){var i=e.width,n=e.height,o=t.width/ i;if(i=t.width,n*=o,n>t.height)o=t.height/n,n=t.height,i*=o;return i/e.width;};});