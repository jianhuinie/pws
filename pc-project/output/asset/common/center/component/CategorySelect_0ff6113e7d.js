define('cobble/form/Select',['require','exports','module','../ui/ComboBox','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return o.init(this,e);}var t=require('../ui/ComboBox'),n=require('../function/jquerify'),o=require('../function/lifeCycle');return e.prototype={constructor:e,type:'Select',init:function(){var e=this,n=e.element,o='<input type="hidden" name="'+e.name+'"';if(null!=e.value)o+=' value="'+e.value+'"';if(n.attr('required'))o+=' required';o+=' />';var i=e.input=$(o);n.append(i),e.comboBox=new t({element:n,button:n.find(e.buttonSelector),menu:n.find(e.menuSelector),data:e.data,value:e.value,show:e.show,hide:e.hide,defaultText:e.defaultText,template:e.template,renderTemplate:e.renderTemplate,activeClass:e.activeClass,openClass:e.openClass,setText:$.proxy(e.setText,e),onChange:function(t,n){if(e.setValue(n.value),!e.silence)e.emit('change',n);},onAfterShow:function(){n.trigger('focusin');},onAfterHide:function(){n.trigger('focusout');}});},disable:function(){var e=this,t=e.element;t.find(e.buttonSelector).prop('disabled',!0);},enable:function(){var e=this,t=e.element;t.find(e.buttonSelector).prop('disabled',!1);},getValue:function(){return this.value;},setValue:function(e,t){var n=this;if(t=t||{},t.force||e!=n.value)n.value=e,n.input.val(null==e?'':e),n.silence=t.silence,n.comboBox.setValue(e),delete n.silence;},refresh:function(e){this.comboBox.refresh(e);},dispose:function(){var e=this;o.dispose(e),e.comboBox.dispose(),e.input=e.element=e.comboBox=null;}},n(e.prototype),e.defaultOptions={defaultText:'请选择',buttonSelector:'.btn-default',menuSelector:'.dropdown-menu',labelSelector:'.btn-default span',activeClass:'active',openClass:'open',renderTemplate:function(e){var t=[];return $.each(e,function(e,n){var o=[];$.each(n,function(e,t){if('text'!==e&&null!=t)o.push('data-'+e+'="'+t+'"');}),t.push('<li '+o.join(' ')+'>'+n.text+'</li>');}),t.join('');},setText:function(e){this.element.find(this.labelSelector).html(e);}},e;}),define('cobble/function/contains',['require','exports','module'],function(){'use strict';return function(e,t){if(e=e.jquery?e[0]:e,t=t.jquery?t[0]:t,!e||!t)return!1;if(e===t)return!0;else return $.contains(e,t);};}),define('cobble/function/isHidden',['require','exports','module'],function(){'use strict';return function(e){e.css('display');return'none'===e.css('display')||0==e.css('opacity')||'hidden'===e.css('visibility');};}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var t=$.prototype,n={on:function(){return t.on.apply(e(this),arguments),this;},off:function(){return t.off.apply(e(this),arguments),this;},emit:function(n,o){var i=this,r=e(i);if(r){if(!n[$.expando])n='string'===$.type(n)?$.Event(n):$.Event(null,n);n.cobble=i;var u=[n];if(o)u.push(o);var c=i[$.camelCase('on-'+n.type)];if($.isFunction(c)&&c.apply(i,u)===!1)n.preventDefault();if(!n.isPropagationStopped())t.trigger.apply(r,u);return n;}},before:function(t){e(this).before(t);},after:function(t){e(this).after(t);},appendTo:function(t){e(this).appendTo(t);},prependTo:function(t){e(this).prependTo(t);}};return function(e){$.each(n,function(t,n){if(null==e[t])e[t]=n;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,t){var n=e.constructor,o='__cobble__'+n.prototype.type,i=t.element;if(i&&i.data(o))e=i.data(o);else if($.extend(e,n.defaultOptions,t),e.init(),i)i.data(o,e);return e;},exports.dispose=function(e){var t='__cobble__'+e.constructor.prototype.type,n=e.element;if(n)n.removeData(t);};}),define('cobble/function/split',['require','exports','module'],function(){'use strict';return function(e,t){var n=[];return $.each(e.split(t),function(e,t){if(t=$.trim(t))n.push(t);}),n;};}),define('cobble/helper/Popup',['require','exports','module','../function/split','../function/isHidden','../function/contains','../function/jquerify','../function/lifeCycle','../util/instance'],function(require){'use strict';function e(e){return w.init(this,e);}function t(e,t){$.each(e.showConfigList,function(n,o){o[t](e);});}function n(e,t){$.each(e.hideConfigList,function(n,o){o[t](e);});}function o(e,t){if(e)e.type=t;else e=t;return e;}function i(e){var t=e.currentTarget;return t&&'HTML'===t.tagName?null:t;}function r(e,t){return e.emit(o(t,'beforeShow'));}function u(e,o){return e.layer.data(j,i(o)),t(e,'off'),n(e,'on'),e.emit('afterShow');}function c(e,t){return e.emit(o(t,'beforeHide'));}function a(e){return e.layer.removeData(j),n(e,'off'),t(e,'on'),e.emit('afterHide');}function l(){return $.now();}function f(e){return'__'+e+'Handler__';}function s(e,t){return null==e[t];}function d(e,t){return e.layer.data(j)!==i(t);}function p(e,t,n){return!t||t(e,n);}function m(e,t){return t-e[k]>50;}function h(t,n){return function(o){var i=o.data,r=l(o);if(s(i,V)&&d(i,o)&&p(i,n,o))i[k]=r,v({popup:i,delay:i.show.delay,toggle:e.trigger.show[t].delay,timer:V,success:function(){var e=function(){i.open(o);},t=i[q];if(t)t.done(e);else e();}});};}function y(t,n){return function(o){var i=o.data,r=l(o);if(s(i,H)&&p(i,n,o)&&m(i,r))i[k]=r,i[q]=$.Deferred(),v({popup:i,delay:i.hide.delay,toggle:e.trigger.hide[t].delay,timer:H,success:function(){i.close(o),i[q].resolve();},fail:function(){i[q]=null;}});};}function v(e){var t=e.delay,n=e.success;if(t>0){var o=e.popup,i=e.timer,r=e.toggle||{},u=r.on||$.noop,c=r.off||$.noop,a=e.fail||$.noop,l=function(){clearTimeout(o[i]),c(o,f),o[i]=null;},f=function(e){var t=o[i];if(t)l();if(t&&e===k)n();else a();};u(o,f),o[i]=setTimeout(function(){f(k);},t);}else n();}function g(e){var t=this,n=t.type,o=t.handler,i=f(n);if(e[i]!==o)e.element.on(n,e.selector,e,o),e[i]=o;}function b(e){var t=this;if(!e.selector){var n=t.type;e.element.off(n,t.handler),e[f(n)]=null;}}var x=require('../function/split'),S=require('../function/isHidden'),C=require('../function/contains'),_=require('../function/jquerify'),w=require('../function/lifeCycle'),T=require('../util/instance');e.prototype={constructor:e,type:'Popup',init:function(){var o=this,i=o.showConfigList=[],r=o.hideConfigList=[],u=o.show.trigger,c=o.hide.trigger;if(u)$.each(x(u,','),function(t,n){var o=e.trigger.show[n];if(o)i.push(o);});if(c)$.each(x(o.hide.trigger,','),function(t,n){var o=e.trigger.hide[n];if(o)r.push(o);});if(o.hidden=S(o.layer))t(o,'on');else n(o,'on');},open:function(){var e=this,t=arguments[0];if(!t)e[k]=l();if(t=r(e,t),!t.isDefaultPrevented()){var n=e.layer,o=e.show.animation;if($.isFunction(o))o.call(e,n);else n.show();e.hidden=!1,u(e,t);}},close:function(){var e=this;if(!e.hidden){var t=arguments[0];if(!t)e[k]=l();if(t=c(e,t),!t.isDefaultPrevented()){var n=e.layer,o=e.hide.animation;if($.isFunction(o))o.call(e,n);else n.hide();e.hidden=!0,a(e);}}},dispose:function(){var e=this;w.dispose(e),e.close(),t(e,'off'),e.element=e.layer=null;}},_(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var q='__hidePromise__',V='__showTimer__',H='__hideTimer__',k='__lastTriggerTime__',j='__sourceElement__',P=function(e,t){if(!t)return!1;else return C(e.layer,t);};return e.trigger={show:{focus:{type:'focusin',handler:h('focus'),on:g,off:b},click:{type:'click',handler:h('click'),on:g,off:b},over:{type:'mouseenter',handler:h('over'),on:g,off:b,delay:{on:function(e,t){e.element.on('mouseleave',e.selector,t);},off:function(e,t){e.element.off('mouseleave',t);}}},context:{type:'contextmenu',handler:h('context'),on:g,off:b}},hide:{blur:{type:'focusout',handler:y('blur'),on:g,off:b},click:{type:'click',handler:function(){return y(this.type,function(e,t){return!P(e,t.target);});},on:function(e){var t=this;T.document.on(t.type,e,e.clickHandler=t.handler());},off:function(e){T.document.off(this.type,e.clickHandler);}},out:{type:'mouseleave',handler:y('out'),on:function(e){var t=this.type,n=this.handler;e.layer.on(t,e,n),e.element.on(t,e.selector,e,n);},off:function(e){var t=this.type,n=this.handler;e.element.off(t,n),e.layer.off(t,n);},delay:{on:function(e,t){e.element.on('mouseenter',e.selector,t),e.layer.on('mouseenter',t);},off:function(e,t){e.element.off('mouseenter',t),e.layer.off('mouseenter',t);}}},context:{type:'contextmenu',handler:function(){return y('context',function(e,t){return!P(e,t.target);});},on:function(e){var t=this;T.document.on(t.type,e,e.contextHandler=t.handler());},off:function(e){T.document.off(this.type,e.contextHandler);}}}},e;}),define('cobble/ui/ComboBox',['require','exports','module','../function/jquerify','../function/lifeCycle','../helper/Popup'],function(require){'use strict';function e(e){return n.init(this,e);}var t=require('../function/jquerify'),n=require('../function/lifeCycle'),o=require('../helper/Popup');e.prototype={constructor:e,type:'ComboBox',init:function(){var e=this,t=e.button,n=e.menu,r=e.element||t,u=e.openClass,c=e.show,a=e.hide,l=c.animation;if($.isFunction(l))c.animation=$.proxy(l,e);if(l=a.animation,$.isFunction(l))a.animation=$.proxy(l,e);if(e.popup=new o({element:t,layer:n,show:c,hide:a,onBeforeShow:function(t){e.emit(t);},onBeforeHide:function(t){e.emit(t);},onAfterShow:function(t){if(u)r.addClass(u);e.emit(t);},onAfterHide:function(t){if(u)r.removeClass(u);e.emit(t);}}),null==e.value){var f=n.find('.'+e.activeClass);if(1===f.length)e.value=f.data('value');}if(e.data)n.html(e.renderTemplate(e.data,e.template));if(null!=e.value)e.setValue(e.value,{force:!0,silence:!0});n.on('click'+i,'[data-value]',function(){e.setValue($(this).data('value')),e.close();});},getValue:function(){return this.value;},setValue:function(e,t){var n,o=this,i=o.menu,r=i.find('[data-value="'+e+'"]');if(1===r.length){if(n=r.data(),null==n.text)n.text=r.html();}else n={};if(t=t||{},t.force||e!=o.value){var u=o.activeClass;if(u)i.find('.'+u).removeClass(u);if(1===r.length){if(o.value=e,u)r.addClass(u);}else o.value=null;if(!t.silence)o.emit('change',n);}if($.isFunction(o.setText))o.setText(n.text||o.defaultText);},refresh:function(e){var t=this,n=t.value,o={};if(e){var i=e.data;if(i)t.menu.html(t.renderTemplate(i,t.template));if('value'in e)n=e.value,o.force=!0;}t.setValue(n,o);},open:function(){this.popup.open();},close:function(){this.popup.close();},dispose:function(){var e=this;n.dispose(e),e.menu.off(i),e.popup.dispose(),e.popup=e.element=e.button=e.menu=null;}},t(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var i='.cobble_ui_combobox';return e;}),define('cobble/util/instance',['require','exports','module'],function(require,exports){exports.window=$(window),exports.document=$(document),exports.html=$(document.documentElement),exports.body=$(document.body);}),define('common/center/component/CategorySelect_0ff6113e7d',['require','exports','cobble/form/Select','common/service_9c322508d3'],function(require){'use strict';function e(e){$.extend(this,u,e),this.init();}function t(e){if(c[e]){var t=$.Deferred();return setTimeout(function(){t.resolve(c[e]);},0),t.promise();}return r.getSubjectList({id:e}).done(function(t){if(0===t.code)c[e]=t;return t;});}function n(e,n){var i=this;e.changePromise=$.Deferred();var r=e.value;if('category1'==e.name)i.categorySelect3.setValue(''),i.categorySelect2.setValue('');if('category2'==e.name)i.categorySelect3.setValue('');if(r)t(r).done(function(t){if(0===t.code){var i=t.data;n.refresh({data:o(i.list)}),e.changePromise.resolve();}});}function o(e){return $.map(e,function(e){return{text:e.name,value:e.id};});}var i=require('cobble/form/Select'),r=require('common/service_9c322508d3'),u={category1Selector:'.category1',category2Selector:'.category2',category3Selector:'.category3',category1Name:'category1',category2Name:'category2',category3Name:'category3'},c={};return e.prototype={init:function(){var e=this,r=e.element;e.categorySelect1=new i({element:r.find(e.category1Selector),name:e.category1Name,onChange:function(){$.proxy(n,e)(e.categorySelect1,e.categorySelect2);}}),e.categorySelect2=new i({element:r.find(e.category2Selector),name:e.category2Name,onChange:function(){$.proxy(n,e)(e.categorySelect2,e.categorySelect3);}}),e.categorySelect3=new i({element:r.find(e.category3Selector),name:e.category3Name,onChange:e.onChange}),t().done(function(t){if(0===t.code)e.categorySelect1.refresh({data:o(t.data.list)}),e.onloadData();});},setValue:function(e){var t=$.Deferred(),n=this.categorySelect1,o=this.categorySelect2,i=this.categorySelect3;if(e&&3===e.length)return n.setValue(e[0].id),n.changePromise.done(function(){o.setValue(e[1].id),i.setValue(''),o.changePromise.done(function(){i.setValue(e[2].id),t.resolve();});}),t.promise();else return void 0;},getValue:function(){if(this.categorySelect2.getValue()&&this.categorySelect1.getValue())return this.categorySelect3.getValue();else return void 0;},onloadData:function(){}},e;});