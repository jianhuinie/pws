define('cobble/form/Validator',['require','exports','module','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return n.init(this,e);}function t(e,t){if(e.length>0){var r=e[0].element;if(r.is(':hidden'))r=r.parent();var i=r.offset().top;if(t>0)i-=t;window.scrollTo(window.scrollX,i);}}function r(e){var t=$.Deferred();return $.when.apply($,e).done(function(){t.resolve(arguments);}),t;}var i=require('../function/jquerify'),n=require('../function/lifeCycle');e.prototype={constructor:e,type:'Validator',init:function(){var t=this,r=t.element,i='FORM'===r.prop('tagName')?r:r.find('form');if(i.length>0)i.attr('novalidate','novalidate').on('submit'+a,$.proxy(t.validate,t));$.each(t.fields,function(t,i){var n=r.find('[name="'+t+'"]'),a=i.type;if(!a)a=i.type=n.attr('type')||'text';var u=i.rules;if(!u)u=i.rules={};var l=e.type[a]||[];$.each(l,function(e,t){if(null==u[t]){var r=o[t];if($.isFunction(r))u[t]=r(n,i);}});});var n=t.groupSelector;if(r.on('focusin'+a,function(e){var r=$(e.target).closest(n),i=[t.successClass,t.errorClass,t.requiredClass].join(' ');r.removeClass($.trim(i));}),t.realtime)r.on('focusout'+a,function(e){var r=$(e.target),i=r.prop('name');if(!i)r=r.find('[name]'),i=r.prop('name');if(i)t.validate(i);});},validate:function(e,i){var n=this,o=n.emit('beforeValidate');if(!o.isDefaultPrevented()){var a,u=n.element,l=n.groupSelector;if('string'===$.type(e))e=[e];if($.isArray(e))a=$.map(e,function(e){return u.find('[name="'+e+'"]').closest(l);});else if(a=u.find(l),'boolean'===$.type(e))i=e;var s=[],c=[];$.each(a,function(e,t){var r=n.validateGroup($(t));if(r){if(r.promise)c.push(r),r=r.data;$.merge(s,r);}});var e=[],f=[],p=function(){if($.each(s,function(t,r){if(r.error)f.push(r);e.push(r.element.prop('name'));}),i)t(f,n.scrollGap);n.emit('afterValidate',{fields:e,errors:f});};if(c.length>0)return r(c).done(p);else return p(),0===f.length;}},validateGroup:function(t){if(t.is(':visible')){var i=this,n=[],o=[],a=[];if(t.find('[name]').each(function(t){var r,u,l=this,s=l.name,c=l.value,f=l.disabled,p=$(l);if(!f){var m=i.fields[s];if(m){r=!0,m=$.extend(!0,{},m),m.form=i.element,m.value=$.trim(c);var d;if($.each(e.type[m.type]||[],function(t,r){var i=e.rule[r](m);if(i===!1)return d=r,!1;else if(''===m.value&&'required'===r)return!1;}),d){var v=m.errors;if(v)u=v[d];if(!u)throw new Error(s+' 字段 '+d+' 类型错误信息未定义');}else if($.isFunction(m.custom)){var h=$.Deferred(),y=m.custom(p,function(e){h.resolve(e);});u=null==y||y.done?h:y;}}}if(r)if(t=n.push({element:p,error:u}),u&&u.promise)o.push(u),a.push(t-1);}),o.length>0){var u=r(o).done(function(e){$.each(e,function(e,t){n[a[e]].error=t;}),i.refreshGroup(t,n);});return u.data=n,u;}else return i.refreshGroup(t,n),n;}},refreshGroup:function(e,t){var r=this,i=r.successClass,n=r.errorClass;$.each(t,function(t,o){var a,u=o.element,l=o.error,s=r.errorSelector;if(s)a=e.find(s).eq(t);if(l&&'string'===$.type(l)){if(e.removeClass(i).addClass(n),a){var c=r.renderTemplate;if($.isFunction(c))l=c({text:l},r.errorTemplate);a.html(l).show();var f=r.errorPlacement;if($.isFunction(f))f(u,a);}}else if(o.error='',e.removeClass(n).addClass(i),a)a.html('').hide();});},dispose:function(){var e=this;n.dispose(e),e.element.off(a),e.element=null;}},i(e.prototype),e.defaultOptions={realtime:!1,scrollGap:100,groupSelector:'.form-group',successClass:'has-success',errorClass:'has-error',errorSelector:'.error',errorTemplate:'<i class="icon icon-times-circle"></i>&nbsp;${text}',requiredClass:'has-required',requiredSelector:'.required',requiredTemplate:'${text}',renderTemplate:function(e,t){return t.replace(/\${(\w+)}/g,function(t,r){return e[r]||'';});},errorPlacement:function(e,t){if('hidden'===e.prop('type'))e=e.parent();t.css({position:'static',width:'auto'});var r=t.outerWidth(!0)+5;t.css({position:'absolute',width:r});var i=e.parent();if(i.is('.placeholder-wrapper'))e=i;var n=e.position();t.css({left:n.left+e.outerWidth()-37,top:n.top-t.outerHeight()+8});}},e.type={text:['required','pattern','min','max','minlength','maxlength'],hidden:['required'],password:['required','pattern','minlength','maxlength','equals'],number:['required','pattern','min','max','step'],range:['required','pattern','min','max','step'],tel:['required','pattern'],url:['required','pattern'],email:['required','pattern'],mobile:['required','pattern'],money:['required','pattern','min','max'],idcard:['required','pattern'],'int':['required','pattern','min','max'],internationalMobile:['required','pattern']},e.rule={required:function(e){if(e.value.length>0)return!0;else if(e.rules.required)return!1;},pattern:function(e){var t=e.rules.pattern;if(t)return t.test(e.value);else return void 0;},minlength:function(e){var t=e.rules.minlength;if($.isNumeric(t))return e.value.length>=+t;else return void 0;},maxlength:function(e){var t=e.rules.maxlength;if($.isNumeric(t))return e.value.length<=+t;else return void 0;},min:function(e){var t=e.rules.min;if($.isNumeric(t))return e.value>=+t;else return void 0;},max:function(e){var t=e.rules.max;if($.isNumeric(t))return e.value<=+t;else return void 0;},step:function(e){var t=e.rules.step;if($.isNumeric(t)){var r=e.rules.min||1;return(e.value-r)%t===0;}},equals:function(e){var t=e.rules.equals;if(t){var r=e.form.find('[name="'+t+'"]');return e.value===$.trim(r.val());}}},e.pattern={number:/^[\d.]*$/,'int':/^\d+$/,url:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,tel:/^(?:(?:0\d{2,3}[- ]?[1-9]\d{6,7})|(?:[48]00[- ]?[1-9]\d{6}))$/,mobile:/^1[3-9]\d{9}$/,email:/^(?:[a-z0-9]+[_\-+.]+)*[a-z0-9]+@(?:([a-z0-9]+-?)*[a-z0-9]+.)+([a-z]{2,})+$/i,money:/^[\d.]*$/,idcard:/(^\d{15}$)|(^\d{17}([0-9]|X)$)/i,internationalMobile:/^\d{7,20}$/};var o={required:function(e){return'required'===e.attr('required');},pattern:function(t,r){var i=t.attr('pattern')||e.pattern[r.type];if('string'===$.type(i))i=new RegExp(i);return i;},minlength:function(e){return e.attr('minlength');},maxlength:function(e){return e.attr('maxlength');},min:function(e){return e.attr('min');},max:function(e){return e.attr('max');},step:function(e){return e.attr('step');},equals:function(e){return e.attr('equals');}},a='.cobble_form_validator';return e;}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var t=$.prototype,r={on:function(){return t.on.apply(e(this),arguments),this;},off:function(){return t.off.apply(e(this),arguments),this;},emit:function(r,i){var n=this,o=e(n);if(o){if(!r[$.expando])r='string'===$.type(r)?$.Event(r):$.Event(null,r);r.cobble=n;var a=[r];if(i)a.push(i);var u=n[$.camelCase('on-'+r.type)];if($.isFunction(u)&&u.apply(n,a)===!1)r.preventDefault();if(!r.isPropagationStopped())t.trigger.apply(o,a);return r;}},before:function(t){e(this).before(t);},after:function(t){e(this).after(t);},appendTo:function(t){e(this).appendTo(t);},prependTo:function(t){e(this).prependTo(t);}};return function(e){$.each(r,function(t,r){if(null==e[t])e[t]=r;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,t){var r=e.constructor,i='__cobble__'+r.prototype.type,n=t.element;if(n&&n.data(i))e=n.data(i);else if($.extend(e,r.defaultOptions,t),e.init(),n)n.data(i,e);return e;},exports.dispose=function(e){var t='__cobble__'+e.constructor.prototype.type,r=e.element;if(r)r.removeData(t);};}),define('cobble/function/toNumber',['require','exports','module'],function(){'use strict';var e={'int':parseInt,'float':parseFloat};return function(t,r,i){if('number'!==$.type(t)){var n=e[i];if(t=n?n(t,10):+t,isNaN(t))t=r;}return t;};}),define('cobble/helper/Switchable',['require','exports','module','../function/jquerify','../function/lifeCycle','../function/toNumber'],function(require){'use strict';function e(e){return r.init(this,e);}var t=require('../function/jquerify'),r=require('../function/lifeCycle'),i=require('../function/toNumber');e.prototype={constructor:e,type:'Switchable',init:function(){var e=this,t=e.element,r=e.selector,a=e.items=t.find(r),u=i(e.index,o),l=e.activeClass;if(u===o&&l)u=a.index(t.find('.'+l));if(r){var s=e.trigger;if('click'===s)t.on('click'+n,r,function(){e.to(a.index(this));});else if('over'===s)t.on('mouseenter'+n,r,function(){var t=this;e.timer=setTimeout(function(){if(e.element)e.to(a.index(t));},150);}),t.on('mouseleave'+n,r,function(){if(e.timer)clearTimeout(e.timer),e.timer=null;});}if(e.index=o,u>=0)e.to(u);},to:function(e){var t=this;e=i(e,o);var r=t.index;if(e!==r){var n=t.activeClass,a=t.items;if(n){if(r>=0)a.eq(r).removeClass(n);if(e>=0)a.eq(e).addClass(n);}t.index=e,t.change({from:r,to:e});}},dispose:function(){var e=this;r.dispose(e),e.element.off(n),e.element=e.items=null;}},t(e.prototype),e.defaultOptions={index:0,trigger:'click'};var n='.cobble_helper_switchable',o=-1;return e;}),define('cobble/ui/Carousel',['require','exports','module','../function/jquerify','../function/lifeCycle','../helper/Switchable'],function(require){'use strict';function e(e){return r.init(this,e);}var t=require('../function/jquerify'),r=require('../function/lifeCycle'),i=require('../helper/Switchable');e.prototype={constructor:e,type:'Carousel',init:function(){var e=this,t=e.element,r='click'+n,o='mouseenter'+n,a='mouseleave'+n,u=e.prevSelector;if(u)t.on(r,u,$.proxy(e.prev,e));var l=e.nextSelector;if(l)t.on(r,l,$.proxy(e.next,e));var s=e.autoPlay,c=e.itemSelector;if(s&&e.pauseOnHover)t.on(o,c,$.proxy(e.pause,e)).on(a,c,$.proxy(e.play,e));if(e.minIndex=0,e.maxIndex=t.find(c).length-1-(e.showCount-1),e.switcher=new i({element:t,index:e.index,trigger:e.trigger,selector:e.iconSelector,activeClass:e.activeClass,change:function(t){e.index=t.to,e.animation(t),e.emit('change',t);}}),s)e.play();},prev:function(){var e=this,t=e.index-e.step;if(t<e.minIndex)if(e.loop)t=e.maxIndex;else return;e.to(t);},next:function(){var e=this,t=e.index+e.step;if(t>e.maxIndex)if(e.loop)t=e.minIndex;else return;e.to(t);},to:function(e){var t=this;if(t.autoPlay)t.play(e);else t.switcher.to(e);},play:function(e){var t=this;if(t.autoPlay){if(t.playing)t.pause();if(t.playing=!0,t.playTimer=setTimeout($.proxy(t.next,t),t.delay),e!==t.index&&$.isNumeric(e))t.switcher.to(e);}},pause:function(){var e=this;if(e.autoPlay)if(e.playing=!1,e.playTimer)clearTimeout(e.playTimer),e.playTimer=null;},dispose:function(){var e=this;if(r.dispose(e),e.playing)e.pause();e.element.off(n),e.switcher.dispose(),e.element=e.switcher=null;}},t(e.prototype),e.defaultOptions={index:0,step:1,delay:5000,showCount:1,trigger:'over',loop:!0,autoPlay:!0,pauseOnHover:!0};var n='.cobble_ui_carousel';return e;}),define('activity/ceremony',['require','exports','cobble/form/Validator','common/component/SaveButton_b1f301d041','common/service_9c322508d3','common/component/Slider_e976f1c044'],function(require,exports){'use strict';function e(e){var r=$('.promotion-slider-container',e);return new t({element:r,itemSelector:'.promotion-slider-item',iconSelector:'.navitem',prevSelector:'.promotion-slider-left',nextSelector:'.promotion-slider-right',duration:1500});}var t=(require('cobble/form/Validator'),require('common/component/SaveButton_b1f301d041'),require('common/service_9c322508d3'),require('common/component/Slider_e976f1c044'));exports.init=function(){var t=$('.main'),r=t.find('.banner-wrapper');e(r);};}),define('common/component/SaveButton_b1f301d041',['require'],function(){'use strict';function e(e){$.extend(this,e),this.init();}return e.prototype={init:function(){var e=this,t=e.element,r=t.html();if('BUTTON'!==t.prop('tagName'))throw new Error('SaveButton 必须使用 button 标签');var i=function(){var i=e.save();if(i)t.focus(),t.prop('disabled',!0),t.html(e.saveText||'正在保存...'),i.always(function(){setTimeout(function(){t.prop('disabled',!1),t.html(r);},10);});return!1;};if(t.click(i),e.form)e.form.submit(function(){return i(),!1;});}},e;}),define('common/component/Slider_e976f1c044',['require','exports','module','cobble/ui/Carousel'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}var t=require('cobble/ui/Carousel');return e.prototype={constructor:e,init:function(){{var e,r=this,i=r.element,n=r.itemSelector,o=i.find(n),a=o.parent(),u=o.length,l=2,s=u+l,c=o.eq(0),f=o.eq(u-1),p=c.width(),m=c.height(),d=0,v=!r.isVertical?function(){a.css('left',-1*e*p);}:function(){a.css('top',-1*e*m);};new t({element:i,itemSelector:n,iconSelector:r.iconSelector,prevSelector:r.prevSelector,nextSelector:r.nextSelector,activeClass:'active',trigger:r.trigger,loop:r.loop,delay:r.delay,autoPlay:r.autoPlay,pauseOnHover:!0,onChange:r.onChange,animation:function(t){var i=t.to,n=t.from;if(!(0>n)){if(d>0)if(a.stop(),e>-1)v();{var o;this.element;}if(0===i&&n===u-1)o=s-1,e=1;else if(!r.scrollOneDirection&&i===u-1&&0===n)o=0,e=s-l;else o=i+1,e=-1;d++,a.animate(r.isVertical?{top:-1*o*m}:{left:-1*o*p},this.duration,'easeOutQuad',function(){if(d--,e>-1)v();});}}});}if(c=c.clone(),f=f.clone(),a.prepend(f),a.append(c),!r.isVertical)a.css({width:s*p,left:-1*p});else a.css({height:s*m,top:-1*m});}},e.defaultOptions={duration:300,trigger:'click',isVertical:!1,scrollOneDirection:!1,loop:!0,delay:5000},e;});