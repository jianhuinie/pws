define('cobble/form/Select',['require','exports','module','../ui/ComboBox','../function/jquerify','../function/lifeCycle'],function(require){'use strict';function e(e){return n.init(this,e);}var t=require('../ui/ComboBox'),i=require('../function/jquerify'),n=require('../function/lifeCycle');return e.prototype={constructor:e,type:'Select',init:function(){var e=this,i=e.element,n='<input type="hidden" name="'+e.name+'"';if(null!=e.value)n+=' value="'+e.value+'"';if(i.attr('required'))n+=' required';n+=' />';var o=e.input=$(n);i.append(o),e.comboBox=new t({element:i,button:i.find(e.buttonSelector),menu:i.find(e.menuSelector),data:e.data,value:e.value,show:e.show,hide:e.hide,defaultText:e.defaultText,template:e.template,renderTemplate:e.renderTemplate,activeClass:e.activeClass,openClass:e.openClass,setText:$.proxy(e.setText,e),onChange:function(t,i){if(e.setValue(i.value),!e.silence)e.emit('change',i);},onAfterShow:function(){i.trigger('focusin');},onAfterHide:function(){i.trigger('focusout');}});},disable:function(){var e=this,t=e.element;t.find(e.buttonSelector).prop('disabled',!0);},enable:function(){var e=this,t=e.element;t.find(e.buttonSelector).prop('disabled',!1);},getValue:function(){return this.value;},setValue:function(e,t){var i=this;if(t=t||{},t.force||e!=i.value)i.value=e,i.input.val(null==e?'':e),i.silence=t.silence,i.comboBox.setValue(e),delete i.silence;},refresh:function(e){this.comboBox.refresh(e);},dispose:function(){var e=this;n.dispose(e),e.comboBox.dispose(),e.input=e.element=e.comboBox=null;}},i(e.prototype),e.defaultOptions={defaultText:'请选择',buttonSelector:'.btn-default',menuSelector:'.dropdown-menu',labelSelector:'.btn-default span',activeClass:'active',openClass:'open',renderTemplate:function(e){var t=[];return $.each(e,function(e,i){var n=[];$.each(i,function(e,t){if('text'!==e&&null!=t)n.push('data-'+e+'="'+t+'"');}),t.push('<li '+n.join(' ')+'>'+i.text+'</li>');}),t.join('');},setText:function(e){this.element.find(this.labelSelector).html(e);}},e;}),define('cobble/function/contains',['require','exports','module'],function(){'use strict';return function(e,t){if(e=e.jquery?e[0]:e,t=t.jquery?t[0]:t,!e||!t)return!1;if(e===t)return!0;else return $.contains(e,t);};}),define('cobble/function/debounce',['require','exports','module'],function(){'use strict';return function(e,t){t='number'===$.type(t)?t:50;var i;return function(){if(!i){var n=arguments;i=setTimeout(function(){i=null,e.apply(null,$.makeArray(n));},t);}};};}),define('cobble/function/decimalLength',['require','exports','module'],function(){'use strict';return function(e){var t=(''+e).split('.');return 2===t.length?t[1].length:0;};}),define('cobble/function/disableSelection',['require','exports','module'],function(){'use strict';var e=$('<i></i>')[0],t='onselectstart'in e,i='MozUserSelect'in e.style;if(e=null,t)return function(e){e=e||document,e.onselectstart=function(){return!1;};};if(i)return function(e){e=e||document.body,e.style.MozUserSelect='none';};else return $.noop;}),define('cobble/function/divide',['require','exports','module','./decimalLength','./float2Int'],function(require){'use strict';var e=require('./decimalLength'),t=require('./float2Int');return function(i,n){var o=Math.max(e(i),e(n));return i=t(i,o),n=t(n,o),i/n;};}),define('cobble/function/dragGlobal',['require','exports','module','../helper/Draggable','../util/instance','../util/dimension','./pin'],function(require){'use strict';{var e=require('../helper/Draggable'),t=require('../util/instance'),i=require('../util/dimension');require('./pin');}return function(n){return new e({element:n.element,container:t.body,draggingClass:n.draggingClass,handleSelector:n.handleSelector,cancelSelector:n.cancelSelector,rect:function(){var e=n.fixed,t=n.scrollable;return{x:e||t?0:i.getPageScrollLeft(),y:e||t?0:i.getPageScrollTop(),width:e||!t?i.getViewportWidth():i.getPageWidth(),height:e||!t?i.getViewportHeight():i.getPageHeight()};}});};}),define('cobble/function/enableSelection',['require','exports','module'],function(){'use strict';var e=$('<i></i>')[0],t='onselectstart'in e,i='MozUserSelect'in e.style;if(e=null,t)return function(e){e=e||document,e.onselectstart=null;};if(i)return function(e){e=e||document.body,e.style.MozUserSelect='';};else return $.noop;}),define('cobble/function/float2Int',['require','exports','module'],function(){'use strict';return function(e,t){var i,n=(''+e).split('.');if(t>=0);else t=0;if(1===n.length)i=e+new Array(t+1).join('0');else t=Math.max(0,t-n[1].length),i=n.join('')+new Array(t+1).join('0');return+i;};}),define('cobble/function/imageDimension',['require','exports','module'],function(){'use strict';var e=[];return function(t,i){var n=new Image(),o=e.push(n);n.onload=function(){var t=n.height;if(null!=t&&t>0)i(n.width,t),delete e[o-1],n=null;else setTimeout(n.onload,10);},n.src=t;};}),define('cobble/function/innerOffset',['require','exports','module','./toNumber'],function(require){'use strict';var e=require('./toNumber');return function(t){var i=t.offset(),n=t.css('border-left-width'),o=t.css('border-top-width');return{left:i.left+e(n,0,'int'),top:i.top+e(o,0,'int')};};}),define('cobble/function/isHidden',['require','exports','module'],function(){'use strict';return function(e){e.css('display');return'none'===e.css('display')||0==e.css('opacity')||'hidden'===e.css('visibility');};}),define('cobble/function/jquerify',['require','exports','module'],function(){'use strict';function e(e){return e.faker||e.element;}var t=$.prototype,i={on:function(){return t.on.apply(e(this),arguments),this;},off:function(){return t.off.apply(e(this),arguments),this;},emit:function(i,n){var o=this,r=e(o);if(r){if(!i[$.expando])i='string'===$.type(i)?$.Event(i):$.Event(null,i);i.cobble=o;var a=[i];if(n)a.push(n);var s=o[$.camelCase('on-'+i.type)];if($.isFunction(s)&&s.apply(o,a)===!1)i.preventDefault();if(!i.isPropagationStopped())t.trigger.apply(r,a);return i;}},before:function(t){e(this).before(t);},after:function(t){e(this).after(t);},appendTo:function(t){e(this).appendTo(t);},prependTo:function(t){e(this).prependTo(t);}};return function(e){$.each(i,function(t,i){if(null==e[t])e[t]=i;});};}),define('cobble/function/lifeCycle',['require','exports'],function(require,exports){'use strict';exports.init=function(e,t){var i=e.constructor,n='__cobble__'+i.prototype.type,o=t.element;if(o&&o.data(n))e=o.data(n);else if($.extend(e,i.defaultOptions,t),e.init(),o)o.data(n,e);return e;},exports.dispose=function(e){var t='__cobble__'+e.constructor.prototype.type,i=e.element;if(i)i.removeData(t);};}),define('cobble/function/offsetParent',['require','exports','module'],function(){'use strict';function e(e){return e.is('body')||'static'!==e.css('position');}return function(t){if(t.is('body'))return t;for(var i=t.parent();!e(i);)i=i.parent();return i;};}),define('cobble/function/outerOffset',['require','exports','module','./toNumber'],function(require){'use strict';var e=require('./toNumber');return function(t){var i=t.offset(),n=e(t.css('margin-left'),0,'int'),o=e(t.css('margin-top'),0,'int');return{left:i.left-n,top:i.top-o};};}),define('cobble/function/page',['require','exports','module','../util/instance'],function(require){'use strict';var e=require('../util/instance');return function(){if(e.body.prop('clientHeight')<e.html.prop('clientHeight'))return e.html;else return e.body;};}),define('cobble/function/pageHeight',['require','exports','module','./page'],function(require){'use strict';var e=require('./page');return function(){var t=e()[0];return Math.max(t.scrollHeight,t.clientHeight);};}),define('cobble/function/pageScrollLeft',['require','exports','module'],function(){'use strict';return function(){return Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);};}),define('cobble/function/pageScrollTop',['require','exports','module'],function(){'use strict';return function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop);};}),define('cobble/function/pageWidth',['require','exports','module','./page'],function(require){'use strict';var e=require('./page');return function(){var t=e()[0];return Math.max(t.scrollWidth,t.clientWidth);};}),define('cobble/function/parsePercent',['require','exports','module','./divide'],function(require){'use strict';var e=require('./divide'),t=/(-?\d+(\.\d+)?)%/;return function(i){if(t.test(i))return e(RegExp.$1,100);else return void 0;};}),define('cobble/function/pin',['require','exports','module','../util/instance','./parsePercent'],function(require){'use strict';function e(e){var t=o[e.x];if(null==t)t=e.x;if('string'===$.type(t)){var i=n(t);if(null!=i)t=i*(e.width||e.element.outerWidth());}return t;}function t(e){var t=o[e.y];if(null==t)t=e.y;if('string'===$.type(t)){var i=n(t);if(null!=i)t=i*(e.height||e.element.outerHeight());}return t;}var i=require('../util/instance'),n=require('./parsePercent'),o={left:0,top:0,center:'50%',middle:'50%',right:'100%',bottom:'100%'};return function(n){var o=n.element,r=n.attachment||{};if(!r.element)r.element=i.body;var a=r.element.offset(),s=a.left+e(r),c=a.top+t(r),u=s-e(n),l=c-t(n),f=n.offset;if(f){if('number'===$.type(f.x))u+=f.x;if('number'===$.type(f.y))l+=f.y;}var h={left:u,top:l},d=o.css('position');if('absolute'!==d&&'fixed'!==d)h.position='absolute';if(n.silence)return h;else o.css(h);};}),define('cobble/function/pinGlobal',['require','exports','module','./pin','../util/dimension','../function/viewport'],function(require){'use strict';var e=require('./pin'),t=require('../util/dimension'),i=require('../function/viewport');return function(n){var o={silence:!0,element:n.element,x:'50%'===n.x?'50%':0,y:'50%'===n.y?'50%':0,attachment:{element:i(),width:t.getViewportWidth(),height:t.getViewportHeight(),x:n.x,y:n.y}};if(!n.fixed)o.offset={x:t.getPageScrollLeft(),y:t.getPageScrollTop()};return e(o);};}),define('cobble/function/position',['require','exports','module','./offsetParent'],function(require){'use strict';var e=require('./offsetParent');return function(t){var i=e(t),n=t.css('position'),o=parseInt(t.css('left'),10),r=parseInt(t.css('top'),10),a=isNaN(o),s=isNaN(r);if(a||s)if(1===i.length){var c=t.offset(),u=i.offset();if(a)o=c.left-u.left-(parseInt(i.css('border-left-width'),10)||0);if(s)r=c.top-u.top-(parseInt(i.css('border-top-width'),10)||0);}else o=r=0;if(!n||'static'===n)n='absolute';return{position:n,left:o,top:r};};}),define('cobble/function/restrain',['require','exports','module'],function(){'use strict';return function(e,t,i){if(t>e)e=t;else if(e>i)e=i;return e;};}),define('cobble/function/split',['require','exports','module'],function(){'use strict';return function(e,t){var i=[];return $.each(e.split(t),function(e,t){if(t=$.trim(t))i.push(t);}),i;};}),define('cobble/function/toNumber',['require','exports','module'],function(){'use strict';var e={'int':parseInt,'float':parseFloat};return function(t,i,n){if('number'!==$.type(t)){var o=e[n];if(t=o?o(t,10):+t,isNaN(t))t=i;}return t;};}),define('cobble/function/viewport',['require','exports','module','../util/instance'],function(require){'use strict';var e=require('../util/instance');return function(){if(e.body.prop('clientHeight')>e.html.prop('clientHeight'))return e.html;else return e.body;};}),define('cobble/function/viewportHeight',['require','exports','module'],function(){'use strict';return function(){return window.innerHeight||document.documentElement.clientHeight;};}),define('cobble/function/viewportWidth',['require','exports','module'],function(){'use strict';return function(){return window.innerWidth||document.documentElement.clientWidth;};}),define('cobble/helper/Draggable',['require','exports','module','../function/page','../function/toNumber','../function/restrain','../function/position','../function/contains','../function/jquerify','../function/lifeCycle','../function/innerOffset','../function/outerOffset','../function/pageScrollLeft','../function/pageScrollTop','../function/enableSelection','../function/disableSelection','../util/instance','../util/mouse'],function(require){'use strict';function e(e){return u.init(this,e);}function t(e){var t=_(e),i=b(e);if(w.left!==t||w.top!==i){w.left=t,w.top=i;var n=e.data;if(1===++y){var o=n.draggingClass;if(o)n.element.addClass(o);n.emit('beforeDrag');}if(!n.silence)n.element.css(w);n.emit('drag',w);}}function i(e){m(),g.document.off(x);var t=e.data,i=t.draggingClass;if(i)t.element.removeClass(i);if(y>0)t.emit('afterDrag',w);y=_=b=null;}function n(e,t,i){var n=!1;if($.isArray(t))t=t.join(',');return e.find(t).each(function(){if(n=s(this,i))return!1;else return void 0;}),n;}var o=require('../function/page'),r=(require('../function/toNumber'),require('../function/restrain')),a=require('../function/position'),s=require('../function/contains'),c=require('../function/jquerify'),u=require('../function/lifeCycle'),l=require('../function/innerOffset'),f=require('../function/outerOffset'),h=require('../function/pageScrollLeft'),d=require('../function/pageScrollTop'),m=require('../function/enableSelection'),p=require('../function/disableSelection'),g=require('../util/instance'),v=require('../util/mouse');e.prototype={constructor:e,type:'Draggable',init:function(){var e=this,r=e.element;if(!e.container)e.container=o();r.css(a(r)),$.each(v,function(o,c){if(c.support)r.on(c.mousedown+x,function(u){var h=u.target,d=e.handleSelector,m=e.cancelSelector;if(!(d&&!n(r,d,h)||m&&n(r,m,h))){var v=S[o],$=f(r),T=v.absoluteX(u)-$.left,k=v.absoluteY(u)-$.top,q=e.container;if(s(q,r)){var H=l(q);T+=H.left,k+=H.top;}var O=a(r),W=O.position;w.left=O.left,w.top=O.top;var j=e.axis,P=e.getRectange(!0);_='y'===j?C.constant(w.left):C.change(v[W+'X'],T,P.x,P.x+P.width),b='x'===j?C.constant(w.top):C.change(v[W+'Y'],k,P.y,P.y+P.height),y=0,p(),g.document.on(c.mousemove+x,e,t).on(c.mouseup+x,e,i);}});});},getRectange:function(e){var t=this,i=t.rect;if($.isFunction(i))i=t.rect();if(e){var n=t.element,o=i.width-n.outerWidth(!0),r=i.height-n.outerHeight(!0);i.width=Math.max(0,o),i.height=Math.max(0,r);}return i;},setRectange:function(e){this.rect=e;},dispose:function(){var e=this;u.dispose(e),e.element.off(x),e.element=e.container=null;}},c(e.prototype),e.defaultOptions={rect:function(){var e=this,t=e.container,i={x:0,y:0,width:t.innerWidth(),height:t.innerHeight()};if(!s(t,e.element)){var n=l(t);i.x=n.left,i.y=n.top;}return i;}};var _,b,y,x='.cobble_helper_draggable',w={},C={constant:function(e){return function(){return e;};},change:function(e,t,i,n){return function(o){return r(e(o)-t,i,n);};}},S={};return $.each(v,function(e,t){if(t.support)S[e]={absoluteX:function(e){return t.clientX(e)+h();},absoluteY:function(e){return t.clientY(e)+d();},fixedX:function(e){return t.clientX(e);},fixedY:function(e){return t.clientY(e);}};}),e;}),define('cobble/helper/Popup',['require','exports','module','../function/split','../function/isHidden','../function/contains','../function/jquerify','../function/lifeCycle','../util/instance'],function(require){'use strict';function e(e){return S.init(this,e);}function t(e,t){$.each(e.showConfigList,function(i,n){n[t](e);});}function i(e,t){$.each(e.hideConfigList,function(i,n){n[t](e);});}function n(e,t){if(e)e.type=t;else e=t;return e;}function o(e){var t=e.currentTarget;return t&&'HTML'===t.tagName?null:t;}function r(e,t){return e.emit(n(t,'beforeShow'));}function a(e,n){return e.layer.data(W,o(n)),t(e,'off'),i(e,'on'),e.emit('afterShow');}function s(e,t){return e.emit(n(t,'beforeHide'));}function c(e){return e.layer.removeData(W),i(e,'off'),t(e,'on'),e.emit('afterHide');}function u(){return $.now();}function l(e){return'__'+e+'Handler__';}function f(e,t){return null==e[t];}function h(e,t){return e.layer.data(W)!==o(t);}function d(e,t,i){return!t||t(e,i);}function m(e,t){return t-e[O]>50;}function p(t,i){return function(n){var o=n.data,r=u(n);if(f(o,q)&&h(o,n)&&d(o,i,n))o[O]=r,v({popup:o,delay:o.show.delay,toggle:e.trigger.show[t].delay,timer:q,success:function(){var e=function(){o.open(n);},t=o[k];if(t)t.done(e);else e();}});};}function g(t,i){return function(n){var o=n.data,r=u(n);if(f(o,H)&&d(o,i,n)&&m(o,r))o[O]=r,o[k]=$.Deferred(),v({popup:o,delay:o.hide.delay,toggle:e.trigger.hide[t].delay,timer:H,success:function(){o.close(n),o[k].resolve();},fail:function(){o[k]=null;}});};}function v(e){var t=e.delay,i=e.success;if(t>0){var n=e.popup,o=e.timer,r=e.toggle||{},a=r.on||$.noop,s=r.off||$.noop,c=e.fail||$.noop,u=function(){clearTimeout(n[o]),s(n,l),n[o]=null;},l=function(e){var t=n[o];if(t)u();if(t&&e===O)i();else c();};a(n,l),n[o]=setTimeout(function(){l(O);},t);}else i();}function _(e){var t=this,i=t.type,n=t.handler,o=l(i);if(e[o]!==n)e.element.on(i,e.selector,e,n),e[o]=n;}function b(e){var t=this;if(!e.selector){var i=t.type;e.element.off(i,t.handler),e[l(i)]=null;}}var y=require('../function/split'),x=require('../function/isHidden'),w=require('../function/contains'),C=require('../function/jquerify'),S=require('../function/lifeCycle'),T=require('../util/instance');e.prototype={constructor:e,type:'Popup',init:function(){var n=this,o=n.showConfigList=[],r=n.hideConfigList=[],a=n.show.trigger,s=n.hide.trigger;if(a)$.each(y(a,','),function(t,i){var n=e.trigger.show[i];if(n)o.push(n);});if(s)$.each(y(n.hide.trigger,','),function(t,i){var n=e.trigger.hide[i];if(n)r.push(n);});if(n.hidden=x(n.layer))t(n,'on');else i(n,'on');},open:function(){var e=this,t=arguments[0];if(!t)e[O]=u();if(t=r(e,t),!t.isDefaultPrevented()){var i=e.layer,n=e.show.animation;if($.isFunction(n))n.call(e,i);else i.show();e.hidden=!1,a(e,t);}},close:function(){var e=this;if(!e.hidden){var t=arguments[0];if(!t)e[O]=u();if(t=s(e,t),!t.isDefaultPrevented()){var i=e.layer,n=e.hide.animation;if($.isFunction(n))n.call(e,i);else i.hide();e.hidden=!0,c(e);}}},dispose:function(){var e=this;S.dispose(e),e.close(),t(e,'off'),e.element=e.layer=null;}},C(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var k='__hidePromise__',q='__showTimer__',H='__hideTimer__',O='__lastTriggerTime__',W='__sourceElement__',j=function(e,t){if(!t)return!1;else return w(e.layer,t);};return e.trigger={show:{focus:{type:'focusin',handler:p('focus'),on:_,off:b},click:{type:'click',handler:p('click'),on:_,off:b},over:{type:'mouseenter',handler:p('over'),on:_,off:b,delay:{on:function(e,t){e.element.on('mouseleave',e.selector,t);},off:function(e,t){e.element.off('mouseleave',t);}}},context:{type:'contextmenu',handler:p('context'),on:_,off:b}},hide:{blur:{type:'focusout',handler:g('blur'),on:_,off:b},click:{type:'click',handler:function(){return g(this.type,function(e,t){return!j(e,t.target);});},on:function(e){var t=this;T.document.on(t.type,e,e.clickHandler=t.handler());},off:function(e){T.document.off(this.type,e.clickHandler);}},out:{type:'mouseleave',handler:g('out'),on:function(e){var t=this.type,i=this.handler;e.layer.on(t,e,i),e.element.on(t,e.selector,e,i);},off:function(e){var t=this.type,i=this.handler;e.element.off(t,i),e.layer.off(t,i);},delay:{on:function(e,t){e.element.on('mouseenter',e.selector,t),e.layer.on('mouseenter',t);},off:function(e,t){e.element.off('mouseenter',t),e.layer.off('mouseenter',t);}}},context:{type:'contextmenu',handler:function(){return g('context',function(e,t){return!j(e,t.target);});},on:function(e){var t=this;T.document.on(t.type,e,e.contextHandler=t.handler());},off:function(e){T.document.off(this.type,e.contextHandler);}}}},e;}),define('cobble/ui/ComboBox',['require','exports','module','../function/jquerify','../function/lifeCycle','../helper/Popup'],function(require){'use strict';function e(e){return i.init(this,e);}var t=require('../function/jquerify'),i=require('../function/lifeCycle'),n=require('../helper/Popup');e.prototype={constructor:e,type:'ComboBox',init:function(){var e=this,t=e.button,i=e.menu,r=e.element||t,a=e.openClass,s=e.show,c=e.hide,u=s.animation;if($.isFunction(u))s.animation=$.proxy(u,e);if(u=c.animation,$.isFunction(u))c.animation=$.proxy(u,e);if(e.popup=new n({element:t,layer:i,show:s,hide:c,onBeforeShow:function(t){e.emit(t);},onBeforeHide:function(t){e.emit(t);},onAfterShow:function(t){if(a)r.addClass(a);e.emit(t);},onAfterHide:function(t){if(a)r.removeClass(a);e.emit(t);}}),null==e.value){var l=i.find('.'+e.activeClass);if(1===l.length)e.value=l.data('value');}if(e.data)i.html(e.renderTemplate(e.data,e.template));if(null!=e.value)e.setValue(e.value,{force:!0,silence:!0});i.on('click'+o,'[data-value]',function(){e.setValue($(this).data('value')),e.close();});},getValue:function(){return this.value;},setValue:function(e,t){var i,n=this,o=n.menu,r=o.find('[data-value="'+e+'"]');if(1===r.length){if(i=r.data(),null==i.text)i.text=r.html();}else i={};if(t=t||{},t.force||e!=n.value){var a=n.activeClass;if(a)o.find('.'+a).removeClass(a);if(1===r.length){if(n.value=e,a)r.addClass(a);}else n.value=null;if(!t.silence)n.emit('change',i);}if($.isFunction(n.setText))n.setText(i.text||n.defaultText);},refresh:function(e){var t=this,i=t.value,n={};if(e){var o=e.data;if(o)t.menu.html(t.renderTemplate(o,t.template));if('value'in e)i=e.value,n.force=!0;}t.setValue(i,n);},open:function(){this.popup.open();},close:function(){this.popup.close();},dispose:function(){var e=this;i.dispose(e),e.menu.off(o),e.popup.dispose(),e.popup=e.element=e.button=e.menu=null;}},t(e.prototype),e.defaultOptions={show:{trigger:'click'},hide:{trigger:'click'}};var o='.cobble_ui_combobox';return e;}),define('cobble/ui/Dialog',['require','exports','module','../util/instance','../util/dimension','../function/jquerify','../function/lifeCycle','../function/offsetParent','../function/debounce','../function/pinGlobal','../function/dragGlobal'],function(require){'use strict';function e(e){return o.init(this,e);}var t=require('../util/instance'),i=require('../util/dimension'),n=require('../function/jquerify'),o=require('../function/lifeCycle'),r=require('../function/offsetParent'),a=require('../function/debounce'),s=require('../function/pinGlobal'),c=require('../function/dragGlobal');e.prototype={constructor:e,type:'Dialog',init:function(){var e=this,i=e.element||(e.element=$(e.template)),n=[],o=e.skinClass;if(o)n.push(o);var a=e.draggableClass;if(e.draggable&&a)n.push(a);if(n.length>0)i.addClass(n.join(' '));var s=e.removeOnEmpty,c=e.title;if(c)i.find(e.titleSelector).html(c);else if(s)i.find(e.headerSelector).remove();var l=e.content,f=i.find(e.bodySelector);if(l)f.html(l);else if(s)f.remove();var h=e.closeSelector,d=$.proxy(e.hide,e);if(h)i.on('click'+u,h,d);var m={};if(e.width)m.width=e.width;var p=e.fixed?'fixed':'absolute';if(i.css('position')!==p)m.position=p;if(!r(i).is('body'))t.body.append(i);if(e.modal){var g=e.mask||(e.mask=$(e.maskTemplate));if(i.before(g),e.hideOnClickMask)g.on('click'+u,d);var v='zIndex',_=e[v];if(!$.isNumeric(_))if(_=g.css(v),!$.isNumeric(_))_='auto';var b={overflow:'hidden'};b[v]=_,g.css(b),m[v]=_;}if(i.css(m),!e.hidden)e.hidden=!0,e.show();},show:function(){var e=this;if(e.hidden!==!1){var i=e.emit('beforeShow');if(!i.isDefaultPrevented()){var n=e.element,o=e.scrollable;if(e.draggable)e.drager=c({element:n,handleSelector:e.draggableHandleSelector,cancelSelector:e.draggableCancelSelector,draggingClass:e.draggingClass,fixed:e.fixed,scrollable:o});if(e.refresh(),e.showAnimation(),e.mask)e.showMaskAnimation();e.hidden=!1,t.window.resize(e.resizer=a(function(){e.refresh(!0);},50)),e.emit('afterShow');}}},hide:function(){var e=this;if(e.hidden!==!0){var i=e.emit('beforeHide');if(!i.isDefaultPrevented()){if(e.resizer)t.window.off('resize',e.resizer),e.resizer=null;if(e.drager)e.drager.dispose(),e.drager=null;if(e.hideAnimation(),e.mask)e.hideMaskAnimation();if(e.hidden=!0,e.emit('afterHide'),e.disposeOnHide)e.dispose();}}},refresh:function(){var e=this,t=arguments[0];if(!t||e.positionOnResize){var n=e.element,o=s({element:n,x:e.x,y:e.y,fixed:e.fixed});if(t)e.resizeAnimation(o);else n.css(o);}var r=e.mask;if(r)r.css({width:i.getPageWidth(),height:i.getPageHeight()});},dispose:function(){var e=this;if(o.dispose(e),!e.hidden)e.disposeOnHide=!1,e.hide();var t=e.element,i=e.mask;if(t.off(u),i)i.off(u);if(e.removeOnDispose)if(t.remove(),i)i.remove();e.element=e.mask=null;}},n(e.prototype),e.defaultOptions={x:'50%',y:'50%',modal:!0,fixed:!0,hidden:!1,draggable:!0,scrollable:!0,removeOnEmpty:!0,disposeOnHide:!0,removeOnDispose:!0,hideOnClickMask:!1,positionOnResize:!0,draggableClass:'draggable',draggableHandleSelector:'.dialog-header',draggableCancelSelector:['.dialog-header h1','.dialog-close'],headerSelector:'.dialog-header',titleSelector:'.dialog-header h1',closeSelector:'.dialog-close',bodySelector:'.dialog-body',template:'<div class="dialog"><i class="dialog-close">&times;</i><div class="dialog-header"><h1></h1></div><div class="dialog-body"></div></div>',maskTemplate:'<div class="dialog-mask"></div>',showAnimation:function(){this.element.show();},hideAnimation:function(){this.element.hide();},showMaskAnimation:function(){this.mask.show();},hideMaskAnimation:function(){this.mask.hide();},resizeAnimation:function(e){this.element.css(e);}};{var u='.cobble_ui_dialog';t.html.css('overflow'),t.body.css('overflow');}return e;}),define('cobble/util/browser',['require','exports','module'],function(){'use strict';function e(e){var a,s=t(e)||n.exec(e)||o.exec(e)||i(e)||r.exec(e)||[];if(/Android/i.test(e))a='android';else if(/iPhone/i.test(e)||/iPad/i.test(e)||/iTouch/i.test(e))a='ios';else if(/Windows/i.test(e))a='windows';else if(/Macintosh/i.test(e))a='mac';else if(/Linux/i.test(e))a='linux';return{name:s[1]||'',version:s[2]||'0',os:a||''};}function t(e){var t,i=s.exec(e);if(i)t=i[1];else if(i=c.exec(e))t=parseInt(i[1],10)+4+'.0';if(t)return['','ie',t];else return void 0;}function i(e){var t=a.exec(e);if(t)return['','safari',t[1]];else return void 0;}var n=/(chrome)[ \/]([\w.]+)/,o=/(firefox)[ \/]([\w.]+)/,r=/(opera)(?:.*version)?[ \/]([\w.]+)/,a=/version[ \/]([\w.]+) safari/,s=/msie ([\w.]+)/,c=/trident[ \/]([\w.]+)/,u=e(navigator.userAgent.toLowerCase());if(u.name)u[u.name]=!0;return u;}),define('cobble/util/cookie',['require','exports','module'],function(require,exports){'use strict';function e(e){if(0===e.indexOf('"'))e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');var t={};try{e=decodeURIComponent(e.replace(/\+/g,' ')),$.each(e.split(';'),function(e,i){var n=i.split('='),o=$.trim(n[0]),r=$.trim(n[1]);if(o)t[o]=r;});}catch(i){}return t;}function t(e,t,n){var o=n.expires;if($.isNumeric(o)){var r=o;o=new Date(),o.setTime(o.getTime()+r*i);}document.cookie=[encodeURIComponent(e),'=',encodeURIComponent(t),o?';expires='+o.toUTCString():'',n.path?';path='+n.path:'',n.domain?';domain='+n.domain:'',n.secure?';secure':''].join('');}var i=3600000;exports.get=function(t){var i=e(document.cookie);return'string'===$.type(t)?i[t]:i;},exports.set=function(e,i,n){if($.isPlainObject(e))n=i,i=null;if(n=$.extend({},exports.defaultOptions,n),null===i)$.each(e,function(e,i){t(e,i,n);});else t(e,i,n);},exports.remove=function(e,i){if(null!=e)i=i||{},i.expires=-1,t(e,'',$.extend({},exports.defaultOptions,i));},exports.defaultOptions={path:'/'};}),define('cobble/util/dimension',['require','exports','module','../function/pageScrollTop','../function/pageScrollLeft','../function/pageWidth','../function/pageHeight','../function/viewportWidth','../function/viewportHeight'],function(require,exports){'use strict';var e=require('../function/pageScrollTop'),t=require('../function/pageScrollLeft'),i=require('../function/pageWidth'),n=require('../function/pageHeight'),o=require('../function/viewportWidth'),r=require('../function/viewportHeight');exports.getPageScrollTop=e,exports.getPageScrollLeft=t,exports.getPageWidth=i,exports.getPageHeight=n,exports.getViewportWidth=o,exports.getViewportHeight=r;}),define('cobble/util/instance',['require','exports','module'],function(require,exports){exports.window=$(window),exports.document=$(document),exports.html=$(document.documentElement),exports.body=$(document.body);}),define('cobble/util/mouse',['require','exports','module'],function(){'use strict';function e(e){return e.originalEvent.changedTouches[0];}var t=document.createElement('div'),i={support:'ontouchend'in t,click:'touchstart',mousedown:'touchstart',mousemove:'touchmove',mouseup:'touchend',pageX:function(t){return e(t).pageX;},pageY:function(t){return e(t).pageY;},clientX:function(t){return e(t).clientX;},clientY:function(t){return e(t).clientY;}},n={support:'onclick'in t,click:'click',mousedown:'mousedown',mousemove:'mousemove',mouseup:'mouseup',pageX:function(e){return e.pageX;},pageY:function(e){return e.pageY;},clientX:function(e){return e.clientX;},clientY:function(e){return e.clientY;}};return t=null,{touch:i,mouse:n};}),define('common/component/ImageDialog_992ca63b0f',['require','cobble/ui/Dialog','../function/compressImage_1539d29a96','cobble/function/imageDimension','cobble/function/viewportHeight','../function/scale_330792fa50'],function(require){'use strict';function e(t){$.extend(this,e.defaultOptions,t),this.init();}var t=require('cobble/ui/Dialog'),i=require('../function/compressImage_1539d29a96'),n=require('cobble/function/imageDimension'),o=require('cobble/function/viewportHeight'),r=require('../function/scale_330792fa50');return e.prototype={init:function(){var e=this,i=e.dialog=new t({skinClass:'image-dialog',removeOnEmpty:!1,hideOnClickMask:!0,hidden:!0}),n=i.element,r=n.find('.dialog-header').outerHeight(),a=e.imageHeight=e.imageHeight?e.imageHeight:o()-r-20,s=e.imageWidth=e.imageWidth?e.imageWidth:4/3*a;n.width(s);var c=n.find('.dialog-body');c.height(a);var u='<i class="icon icon-chevron-left"></i><i class="icon icon-chevron-right"></i>';c.after(u),n.on('click','.icon-chevron-left',function(){e.setImage(e.index-1);}).on('click','.icon-chevron-right',function(){e.setImage(e.index+1);}),e.setImage(e.index);},setImage:function(e){var t=this,o=t.data[e],a=t.dialog,s=a.element;if(s.find(a.titleSelector).html(o.title),o.noCompress)var c=o.url;else var c=i({url:o.url,width:t.imageWidth,height:t.imageHeight,noCrop:!0});var u=s.find(a.bodySelector);o=$('<img src="'+c+'" />'),u.html(''),u.append(o),n(c,function(e,i){var n=r({width:e,height:i},{width:t.imageWidth,height:t.imageHeight});i*=n,o.css({width:e*n,height:i,position:'relative',top:(t.imageHeight-i)/2}),a.show();}),t.index=e;var l=s.find('.icon-chevron-left'),f=s.find('.icon-chevron-right');if(l.show(),f.show(),0===e)l.hide();if(e===t.data.length-1)f.hide();}},e.defaultOptions={},e;}),define('common/component/Rotatable_2030c1ef8f',['require','exports','cobble/util/browser'],function(require){function e(e){$.extend(this,e),this.init();}for(var t,n,o=require('cobble/util/browser'),r=document.getElementsByTagName('head')[0].style,a='transformProperty WebkitTransform OTransform msTransform MozTransform'.split(' '),s=0,c=a.length;c>s;s++)if(void 0!==r[a[s]])t=a[s];if(t)if(n=t.replace(/[tT]ransform/,'TransformOrigin'),'T'==n[0])n[0]='t';var u=1==o.ie&&'8.0'==o.version,l={};if(l.PhotoEffect=function(){if(t)return function(e,t){e.Wilq32={PhotoEffect:this},this._img=this._rootObj=this._eventObj=e,this._handleRotation(t);};else return function(e,t){if(this._img=e,this._onLoadDelegate=[t],this._rootObj=document.createElement('span'),this._rootObj.style.display='inline-block',this._rootObj.Wilq32={PhotoEffect:this},e.parentNode.insertBefore(this._rootObj,e),e.complete)this._Loader();else{var i=this;jQuery(this._img).bind('load',function(){i._Loader();});}};}(),l.PhotoEffect.prototype={_setupParameters:function(e){if(this._parameters=this._parameters||{},'number'!=typeof this._angle)this._angle=0;if('number'==typeof e.angle)this._angle=e.angle;if(this._parameters.animateTo='number'==typeof e.animateTo?e.animateTo:this._angle,this._parameters.step=e.step||this._parameters.step||null,this._parameters.easing=e.easing||this._parameters.easing||this._defaultEasing,this._parameters.duration=e.duration||this._parameters.duration||1000,this._parameters.callback=e.callback||this._parameters.callback||this._emptyFunction,this._parameters.center=e.center||this._parameters.center||['50%','50%'],'string'==typeof this._parameters.center[0])this._rotationCenterX=parseInt(this._parameters.center[0],10)/100*this._imgWidth*this._aspectW;else this._rotationCenterX=this._parameters.center[0];if('string'==typeof this._parameters.center[1])this._rotationCenterY=parseInt(this._parameters.center[1],10)/100*this._imgHeight*this._aspectH;else this._rotationCenterY=this._parameters.center[1];if(e.bind&&e.bind!=this._parameters.bind)this._BindEvents(e.bind);},_emptyFunction:function(){},_defaultEasing:function(e,t,i,n,o){return-n*((t=t/o-1)*t*t*t-1)+i;},_handleRotation:function(e,i){if(!t&&!this._img.complete&&!i)return void this._onLoadDelegate.push(e);if(this._setupParameters(e),this._angle==this._parameters.animateTo)this._rotate(this._angle);else this._animateStart();},_BindEvents:function(e){if(e&&this._eventObj){if(this._parameters.bind){var t=this._parameters.bind;for(var i in t)if(t.hasOwnProperty(i))jQuery(this._eventObj).unbind(i,t[i]);}this._parameters.bind=e;for(var i in e)if(e.hasOwnProperty(i))jQuery(this._eventObj).bind(i,e[i]);}},_Loader:function(){if(u)return function(){var e=this._img.width,t=this._img.height;this._imgWidth=e,this._imgHeight=t,this._img.parentNode.removeChild(this._img),this._vimage=this.createVMLNode('image'),this._vimage.src=this._img.src,this._vimage.style.height=t+'px',this._vimage.style.width=e+'px',this._vimage.style.position='absolute',this._vimage.style.top='0px',this._vimage.style.left='0px',this._aspectW=this._aspectH=1,this._container=this.createVMLNode('group'),this._container.style.width=e,this._container.style.height=t,this._container.style.position='absolute',this._container.style.top='0px',this._container.style.left='0px',this._container.setAttribute('coordsize',e-1+','+(t-1)),this._container.appendChild(this._vimage),this._rootObj.appendChild(this._container),this._rootObj.style.position='relative',this._rootObj.style.width=e+'px',this._rootObj.style.height=t+'px',this._rootObj.setAttribute('id',this._img.getAttribute('id')),this._rootObj.className=this._img.className,this._eventObj=this._rootObj;for(var i;i=this._onLoadDelegate.shift();)this._handleRotation(i,!0);};else return function(){this._rootObj.setAttribute('id',this._img.getAttribute('id')),this._rootObj.className=this._img.className,this._imgWidth=this._img.naturalWidth,this._imgHeight=this._img.naturalHeight;var e=Math.sqrt(this._imgHeight*this._imgHeight+this._imgWidth*this._imgWidth);this._width=3*e,this._height=3*e,this._aspectW=this._img.offsetWidth/this._img.naturalWidth,this._aspectH=this._img.offsetHeight/this._img.naturalHeight,this._img.parentNode.removeChild(this._img),this._canvas=document.createElement('canvas'),this._canvas.setAttribute('width',this._width),this._canvas.style.position='relative',this._canvas.style.left=-this._img.height*this._aspectW+'px',this._canvas.style.top=-this._img.width*this._aspectH+'px',this._canvas.Wilq32=this._rootObj.Wilq32,this._rootObj.appendChild(this._canvas),this._rootObj.style.width=this._img.width*this._aspectW+'px',this._rootObj.style.height=this._img.height*this._aspectH+'px',this._eventObj=this._canvas,this._cnv=this._canvas.getContext('2d');for(var t;t=this._onLoadDelegate.shift();)this._handleRotation(t,!0);};}(),_animateStart:function(){if(this._timer)clearTimeout(this._timer);this._animateStartTime=+new Date(),this._animateStartAngle=this._angle,this._animate();},_animate:function(){var e=+new Date(),t=e-this._animateStartTime>this._parameters.duration;if(t&&!this._parameters.animatedGif)clearTimeout(this._timer);else{if(this._canvas||this._vimage||this._img){var i=this._parameters.easing(0,e-this._animateStartTime,this._animateStartAngle,this._parameters.animateTo-this._animateStartAngle,this._parameters.duration);this._rotate(~~(10*i)/10);}if(this._parameters.step)this._parameters.step(this._angle);var n=this;this._timer=setTimeout(function(){n._animate.call(n);},10);}if(this._parameters.callback&&t)this._angle=this._parameters.animateTo,this._rotate(this._angle),this._parameters.callback.call(this._rootObj);},_rotate:function(){var e=Math.PI/180;if(u)return function(e){this._angle=e,this._container.style.rotation=e%360+'deg',this._vimage.style.top=-(this._rotationCenterY-this._imgHeight/2)+'px',this._vimage.style.left=-(this._rotationCenterX-this._imgWidth/2)+'px',this._container.style.top=this._rotationCenterY-this._imgHeight/2+'px',this._container.style.left=this._rotationCenterX-this._imgWidth/2+'px';};else if(t)return function(e){this._angle=e,this._img.style[t]='rotate('+e%360+'deg)',this._img.style[n]=this._parameters.center.join(' ');};else return function(t){this._angle=t,t=t%360*e,this._canvas.width=this._width,this._canvas.height=this._height,this._cnv.translate(this._imgWidth*this._aspectW,this._imgHeight*this._aspectH),this._cnv.translate(this._rotationCenterX,this._rotationCenterY),this._cnv.rotate(t),this._cnv.translate(-this._rotationCenterX,-this._rotationCenterY),this._cnv.scale(this._aspectW,this._aspectH),this._cnv.drawImage(this._img,0,0);};}()},u)l.PhotoEffect.prototype.createVMLNode=function(){document.createStyleSheet().addRule('.rvml','behavior:url(#default#VML)');try{return!document.namespaces.rvml&&document.namespaces.add('rvml','urn:schemas-microsoft-com:vml'),function(e){return document.createElement('<rvml:'+e+' class="rvml">');};}catch(e){return function(e){return document.createElement('<'+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">');};}}();return e.prototype={constructor:e,init:function(){},rotate:function(e){if('undefined'!=typeof e)this.element.each(function(){if('number'==typeof e)e={angle:e};var t=[];if(!this.Wilq32||!this.Wilq32.PhotoEffect){var i=$.extend(!0,{},e),n=new l.PhotoEffect(this,i)._rootObj;t.push($(n));}else this.Wilq32.PhotoEffect._handleRotation(e);});},getRotateAngle:function(){var e=[];return this.element.each(function(){if(this.Wilq32&&this.Wilq32.PhotoEffect)e[i]=this.Wilq32.PhotoEffect._angle;}),e;},stopRotate:function(){this.element.each(function(){if(this.Wilq32&&this.Wilq32.PhotoEffect)clearTimeout(this.Wilq32.PhotoEffect._timer);});}},e;}),define('common/function/compressImage_1539d29a96',function(){function e(e,i,n,o,r){var a=0.05;if(o/r/(n/ i)>1+2*a)return'@1e_'+i+'w_1c_0i_1o_90Q_1x.'+e+'%7C0-'+a*i*r/o+'-'+i+'-'+n+'a.'+e.toLowerCase();else return t(e,i,n);}function t(e,t,i,n){return'@'+(n?0:1)+'e_'+t+'w_'+i+'h_1c_0i_1o_90Q_1x.'+e.toLowerCase();}return function(i){var n=i.url,o=n.split('.').pop();if('gif'===o)o='jpg';var r=i.width,a=i.height,s=i.rawWidth,c=i.rawHeight;if(r=Math.floor(r),a=Math.floor(a),null!=s&&null!=c)return s=Math.floor(s),c=Math.floor(c),n+e(o,r,a,s,c);else return n+t(o,r,a,i.noCrop);};}),define('common/function/scale_330792fa50',function(){'use strict';return function(e,t){var i=e.width,n=e.height,o=t.width/ i;if(i=t.width,n*=o,n>t.height)o=t.height/n,n=t.height,i*=o;return i/e.width;};}),define('orgCourse/classDetail/comment_98ddd680e7',['require','exports','common/component/Rotatable_2030c1ef8f','common/component/ImageDialog_992ca63b0f','common/store_a1a35b3dfc','cobble/form/Select','common/service_9c322508d3','cobble/util/cookie'],function(require,exports){'use strict';function e(){var e={teacher_number:o.get('teacherNum'),user_id:o.get('userId')||'',track_id:a.get('__track_id__'),comment_type:'1',comment_tag:o.get('commentTag_name')||'',comment_tag_num:o.get('commentTag_count')||'',dsp:'1',city_id:a.get('CITY_ID'),source:'3',type:'comment',page:o.get('page')};WAT.send('http://click.genshuixue.com/gs.gif',e);}function t(e){return r.getOrgClassCourseAjax({number:o.get('courseNum'),page:o.get('page'),pageSize:10,faceType:o.get('face')}).done(function(t){if(0===t.code){var i=t.data,n=i.tpl;s.find('.tab-nav').html(n.comment_nav),s.find('.nav-content').html(n.comment_list),s.find('.overview').html(n.comment_overview||'');}if(e)location.hash='#course-comment';});}var i=require('common/component/Rotatable_2030c1ef8f'),n=require('common/component/ImageDialog_992ca63b0f'),o=require('common/store_a1a35b3dfc'),r=(require('cobble/form/Select'),require('common/service_9c322508d3')),a=require('cobble/util/cookie'),s=$('#course-comment'),c={},u=1;exports.init=function(){o.set('page',1),o.set('comment',0),t(),s.on('click','[data-page]',function(i){var n=$(i.currentTarget);return o.set('page',n.data('page')),e(),t(!0),!1;}).on('click','.nav-item',function(t){var i=$(t.currentTarget);o.set('commentTag',i.data('value')),o.set('commentTag_name',i.data('name')),o.set('commentTag_count',i.data('num')),o.set('page',1),e();}).on('click','[data-face]',function(e){var i=$(e.currentTarget);return o.set('face',i.data('face')),o.set('page',1),t(!0),!1;}).on('click','.photo-item',function(){var e=$(this),t=e.parent().parent();t.find('.photo-item').removeClass('active'),e.addClass('active');var n=(e.data('vertical'),e.data('vheight'),e.data('horizontal')),o=e.data('hheight'),r=e.data('name'),a=t.find('.photo-wrapper'),l=a.find('.floater'),f=a.find('.rotate-img'),h=t.find('.photo-name');f.attr('src',n),a.css({width:400,height:300}),l.css({'margin-bottom':'-'+Math.floor(o/2)+'px'}),h.text(r),t.find('.comment-photo-player').show();s.find('.photo-wrapper').find('img');if(!a.data('rotateindex'))c[u]=new i({element:a.find('.rotate-img'),callback:function(){}}),a.data('rotateindex',u),u++;else{var d=a.data('rotateindex');c[d].rotate({animateTo:0,duration:1});}a.data('rotateangle',0);}).on('click','.packup',function(){var e=$(this),t=e.parent().parent().parent();t.find('.comment-photo-player').hide(),t.find('.photo-item').removeClass('active');}).on('click','.sourse',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-item'),o=t.find('.active'),r=i.index(o),a=i.map(function(e,t){return{url:$(t).data('image'),title:$(t).data('name')};});new n({data:a,index:r});}).on('click','.left',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-wrapper'),n=i.data('rotateindex'),o=i.data('rotateangle'),r=o-90;c[n].rotate({animateTo:r,duration:1}),i.data('rotateangle',r);}).on('click','.right',function(){var e=$(this),t=e.parent().parent().parent(),i=t.find('.photo-wrapper'),n=i.data('rotateindex'),o=i.data('rotateangle'),r=o+90;c[n].rotate({animateTo:r,duration:1}),i.data('rotateangle',r);}).on('click','.photo-wrapper',function(){var e=$(this);e.parent().find('.packup').click();});};});