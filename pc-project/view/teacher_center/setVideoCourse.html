{{ *

@file 视频课管理
@author jixiaohui

* }}
{{ extends file="common/center/base.html" }}

{{ block name="data" }}

    {{ $smarty.block.parent }}

    {{ $script_path = "teacherCenter/setVideoCourse" }}

    {{ **视频上传统计** }}
    {{ $script_data.report = $tpl_data.report }}
    {{ **视频课模式 status为1新增 2更新未发布 3更新已发布** }}
    {{ $script_data.status = $tpl_data.status }}

    {{ if isset($tpl_data.edit_info) }}
        {{ $script_data.edit_info = $tpl_data.edit_info }}
    {{ /if }}
    {{ if isset($tpl_data.edit_video) }}
        {{ $script_data.edit_video = $tpl_data.edit_video }}
    {{ /if }}

    {{ if $tpl_data.status == 1 }}
        {{ $video_mode = '' }}
    {{ else }}
        {{ $script_data.taglist = $tpl_data.label_ids }}
        {{ $script_data.category = $tpl_data.subject_id }}
        {{ $script_data.language = $tpl_data.language }}
        {{ $script_data.portrait = $tpl_data.portrait }}
        {{ $script_data.portraitCopy = $tpl_data.portrait }}
        {{ $script_data.number = $tpl_data.number }}
        {{ $script_data.price = $tpl_data.price }}
        {{ if $tpl_data.status == 3 }}
            {{ $video_mode = 'update-publish-mode' }}
        {{ else }}
            {{ $video_mode = 'update-unpublish-mode' }}
        {{ /if }}
    {{ /if }}

{{ /block }}

{{ block name="title" prepend }}
视频课管理 - {{ if $tpl_data.status == 1 }}发布视频课{{ else }}课程编辑{{ /if }}
{{ /block }}

{{ block name="style" }}
<link rel="stylesheet" href="{{ $static_origin }}/src/css/teacherCenter/setVideoCourse.less">
{{ /block }}

{{ block name="main" }}
{{ strip }}

    {{ include file="teacher_center/common/sidebar.html" active="course" }}
    {{ include file="common/variable/videoDivide.html" scope=parent }}

    <div id="content" class="card">
        <div class="card-header">
            <h2>
                视频课管理
                {{ if $tpl_data.status == 1 }}
                    <span> &gt; 发布视频课<i>（带*为必填项）</i></span>
                {{ else }}
                    <span> &gt; 课程编辑<i>（带*为必填项）</i></span>
                {{ /if }}
            </h2>
        </div>
        <div class="card-body">
            {{ $section_first_failed = false }}
            {{ if !empty($tpl_data.verify_faild_fields) }}
                {{ foreach $tpl_data.verify_faild_fields as $key=>$item }}
                    {{ if $key == 'brief' }}
                        {{ $brief_failed = $item }}
                    {{ else if $key == 'portrait' }}
                        {{ $portrait_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ else if $key == 'title' }}
                        {{ $title_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ else if $key == 'price' }}
                        {{ $price_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ else if $key == 'expire_time' }}
                        {{ $expire_time_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ else if $key == 'introduce' }}
                        {{ $introduce_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ else if $key == 'subject_id' }}
                        {{ $subject_id_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ else if $key == 'language' }}
                        {{ $language_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ else if $key == 'label_ids' }}
                        {{ $label_ids_failed = $item }}
                        {{ $section_first_failed = true }}
                    {{ /if }}
                {{ /foreach }}
            {{ /if }}
            <div class="section {{ if $video_mode }}no-edit{{ /if }}">
                <h3>
                    第1步：设置课程封面、简介及价格
                    {{ if $section_first_failed }}
                        <span class="wrong-title">
                            经问仔细心检测，以下标记<i class="icon icon-info-circle"></i> 部分审核不通过 <i class="icon icon-info-circle"></i>查看原因，修改后再发布
                        </span>
                    {{ /if }}
                    <a class="video-info-edit">编辑</a>
                </h3>
                {{ **视频课模式 status为1新增 2更新未发布 3更新已发布** }}
                {{ if $tpl_data.status == 1 }}
                    <div class="box video-info">

                        <div class="info-box form">
                            <ul>
                                <li class="video-course-cover">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程封面：</span>
                                    </div>
                                    <div class="front-cover-box">
                                        <div class="front-cover">
                                            <i class="photo"></i>
                                            <span>点击添加课程封面</span>
                                        </div>
                                        <img class="front-cover-img">
                                        <div class="cover-info">
                                            <i class="point">*</i>
                                            <span class="txt">图片大小不超过5M</span>
                                            <a class="change-front-cover">更改封面</a>
                                        </div>
                                    </div>
                                </li>


                                <li class="video-course-title">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程标题：</span>
                                    </div>
                                    <div class="info form-group">
                                        <textarea class="form-text course-title" type="text" name="course_title"></textarea>
                                        <span class="error"></span>
                                        <span class="form-hint">
                                        还可以输入<strong>20</strong>个字符
                                        </span>
                                        <p></p>
                                    </div>
                                </li>
                                <li class="video-course-price">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程价格：</span>
                                    </div>
                                    <div class="info form-group">
                                        <input class="form-text course-price" type="money" name="course_price" min="0" max="999999" pattern="^[1-9]\d*|0$"  required>
                                        <span class="error"></span>
                                        <span class="unit">元</span>
                                        <label for="free-course">
                                            <input type="radio" id="free-course" checked="checked">这是免费课
                                        </label>
                                        <p>0</p>
                                    </div>
                                </li>
                                <li class="video-course-time">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>观看期限：</span>
                                    </div>
                                    <div class="info form-group">
                                        <input class="form-text course-time" type="int" name="course_time"  pattern="^[0-9]*[1-9][0-9]*$"  min="1" max="999999"  required disabled>
                                        <span class="error"></span>
                                        <span class="unit">天</span>
                                        <label for="free-time">
                                            <input type="radio" id="free-time" disabled="true">该视频课永久有效
                                        </label>
                                        <p>0</p>
                                    </div>
                                </li>
                                <li class="video-course-summary">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程简介：</span>
                                    </div>
                                    <div class="info form-group">
                                        <textarea type="text" class="form-text course-summary" name="course_summary"></textarea>
                                        <span class="error"></span>
                                        <span class="form-hint">
                                        还可以输入<strong>200</strong>个字符
                                        </span>
                                        <p></p>
                                    </div>
                                </li>
                                <li class="video-course-category">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程分类：</span>
                                    </div>
                                    <div class="info">
                                        <div class="dropdown category1">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        <div class="dropdown category2">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        <div class="dropdown category3">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        <p></p>
                                    </div>
                                </li>
                                <li class="video-course-language">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程语言：</span>
                                    </div>
                                    <div class="info">
                                        <div class="dropdown language">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                                <li data-value="1">中文_普通话</li>
                                                <li data-value="2">中文_方言</li>
                                                <li data-value="3">英语</li>
                                                <li data-value="4">日语</li>
                                                <li data-value="5">法语</li>
                                                <li data-value="6">韩语</li>
                                                <li data-value="7">德语</li>
                                                <li data-value="8">西班牙语</li>
                                                <li data-value="9">俄语</li>
                                                <li data-value="10">意大利语</li>
                                                <li data-value="11">葡萄牙语</li>
                                            </ul>
                                        </div>
                                        <p></p>
                                    </div>
                                </li>
                                <li class="video-course-tags">
                                    <div class="title">
                                        <i class="point" style="color:transparent;">*</i>
                                        <span>课程标签：</span>
                                    </div>
                                    <div class="info">
                                        <input class="form-text course-tag" type="text">
                                        <span class="form-hint">
                                        每个标签最多<strong>8</strong>个字，用空格分隔（不能包含标点符号，且最多输入<strong>8</strong>个标签哦）
                                        </span>
                                        <ul class="video-tag-list">
                                        </ul>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div class="action-box">
                            <button class="btn btn-default save-course">
                                保存课程信息
                            </button>
                            <button class="btn btn-default not-save-course">
                                不保存
                            </button>
                        </div>
                    </div>
                {{ else if $tpl_data.status == 3 }}
                    <div class="box video-info">

                        <div class="info-box form">
                            <ul>
                                <li class="video-course-cover {{ if !empty($title_failed) }}edit-title{{ /if }}">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程封面：</span>
                                    </div>
                                    <div class="front-cover-box {{ if !empty($portrait_failed) }}edit-portrait{{ /if }}">
                                        <div class="front-cover">
                                            <i class="photo"></i>
                                            <span>点击添加课程封面</span>
                                        </div>
                                        {{ include file="common/variable/photo.html" url=$tpl_data.portrait raw_width=300 raw_height=200 width=180 height=120 }}
                                        <img src="{{ $photo }}" class="front-cover-img">
                                        <div class="cover-info">
                                            <i class="point">*</i>
                                            <span class="txt">图片大小不超过5M</span>
                                            <a class="change-front-cover">更改封面</a>
                                        </div>
                                    </div>
                                    {{ if !empty($portrait_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $portrait_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ /if }}
                                </li>
                                <li class="video-course-title {{ if !empty($title_failed) }}edit-title{{ /if }}">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程标题：</span>
                                    </div>
                                    <div class="info">
                                        <textarea class="form-text course-title" type="text">{{ $tpl_data.title }}</textarea>
                                        <span class="form-hint">
                                        还可以输入<strong>20</strong>个字符
                                        </span>
                                        <p>{{ $tpl_data.title }}</p>
                                    </div>
                                    {{ if !empty($title_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $title_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-price">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程价格：</span>
                                    </div>
                                    <div class="info form-group">

                                        <div>
                                            <input class="form-text course-price" type="money" {{ if $tpl_data.price != 0 }}value="{{ $tpl_data.price }}" {{ /if }} name="course_price"  min="0" max="999999"  pattern="^[1-9]\d*|0$"  required>
                                            <span class="error"></span>
                                            <span class="unit">元</span>
                                            <label for="free-course">
                                                <input type="radio" id="free-course" {{ if $tpl_data.price == 0 }}checked="checked"{{ /if }}>这是免费课
                                            </label>
                                        </div>
                                        <p>{{ if $tpl_data.price != 0 }}<span class="num" data-price="{{ $tpl_data.price }}"><em>￥</em>{{ $tpl_data.price }}</span>{{ if isset($tpl_data.price_ios) && $tpl_data.price_ios != "" }}<em class="num-ios" data-price="10">（苹果设备上售价￥{{ $tpl_data.price_ios }}）</em>{{ /if }}{{ else }}免费课{{ /if }}</p>
                                    </div>
                                    {{ if !empty($price_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $price_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-time">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>观看期限：</span>
                                    </div>
                                    <div class="info form-group">
                                        <input class="form-text course-time" type="int" name="course_time" {{ if $tpl_data.expire_time != 0 }}value="{{ $tpl_data.expire_time }}"{{ /if }}  pattern="^[0-9]*[1-9][0-9]*$"  min="1" max="999999"  required>
                                        <span class="error"></span>
                                        <span class="unit">天</span>
                                        <label for="free-time">
                                            <input type="radio" id="free-time" {{ if $tpl_data.price != 0 && $tpl_data.expire_time == 0 }} checked="checked"{{ /if }}>该视频课永久有效
                                        </label>
                                        <p>{{ if $tpl_data.expire_time != 0 }}<span class="num">{{ $tpl_data.expire_time }}<i>天</i></span>{{ else }}该视频课永久有效{{ /if }}</p>
                                    </div>
                                    {{ if !empty($expire_time_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $expire_time_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-summary">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程简介：</span>
                                    </div>
                                    <div class="info form-group">
                                        <textarea type="text" class="form-text course-summary" name="course_summary" required>{{ $tpl_data.introduce }}</textarea>
                                        <span class="error"></span>
                                        <span class="form-hint">
                                        还可以输入<strong>200</strong>个字符
                                        </span>
                                        <p>{{ $tpl_data.introduce }}</p>
                                    </div>
                                    {{ if !empty($introduce_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $introduce_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-category">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程分类：</span>
                                    </div>
                                    <div class="info">
                                        <div class="dropdown category1">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        <div class="dropdown category2">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        <div class="dropdown category3">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        {{ $subject_list = explode(',', $tpl_data.subject_id) }}
                                        <p data-cid="{{ $subject_list[0]|cat:','|cat:$subject_list[1]|cat:','|cat:$subject_list[2] }}">{{ $subject_list[3] }}/{{ $subject_list[4] }}/{{ $subject_list[5] }}</p>
                                    </div>
                                    {{ if !empty($subject_id_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $subject_id_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                {{ include file="common/variable/videoLanguage.html" scope=parent }}
                                <li class="video-course-language">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程语言：</span>
                                    </div>
                                    <div class="info">
                                        <div class="dropdown language">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>中文_普通话</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                                <li data-value="1">中文_普通话</li>
                                                <li data-value="2">中文_方言</li>
                                                <li data-value="3">英语</li>
                                                <li data-value="4">日语</li>
                                                <li data-value="5">法语</li>
                                                <li data-value="6">韩语</li>
                                                <li data-value="7">德语</li>
                                                <li data-value="8">西班牙语</li>
                                                <li data-value="9">俄语</li>
                                                <li data-value="10">意大利语</li>
                                                <li data-value="11">葡萄牙语</li>
                                            </ul>
                                        </div>
                                        <p data-lid="{{ $tpl_data.language }}">{{ $video_language[$tpl_data.language] }}</p>
                                    </div>
                                    {{ if !empty($language_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $language_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-tags">
                                    <div class="title">
                                        <i class="point" style="color:transparent;">*</i>
                                        <span>课程标签：</span>
                                    </div>
                                    <div class="info">
                                        <input class="form-text course-tag" type="text">
                                        <span class="form-hint">
                                        每个标签最多<strong>8</strong>个字，用空格分隔（不能包含标点符号，且最多输入<strong>8</strong>个标签哦）
                                        </span>
                                        <ul class="video-tag-list">
                                            {{ if $tpl_data.label_ids }}
                                                {{ $label_list = explode(',', $tpl_data.label_ids) }}
                                                {{ foreach $label_list as $val }}
                                                    <li class="tag-item">{{ $val }}</li>
                                                {{ /foreach }}
                                            {{ /if }}
                                        </ul>
                                    </div>
                                    {{ if !empty($label_ids_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $label_ids_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                            </ul>
                        </div>
                        <div class="action-box">
                            <button class="btn btn-default save-course">
                                保存课程信息
                            </button>
                            <button class="btn btn-default not-save-course">
                                不保存
                            </button>
                        </div>
                    </div>
                {{ else if $tpl_data.status == 2 }}
                    <div class="box video-info">

                        <div class="info-box form">
                            <ul>
                                <li class="video-course-cover {{ if !empty($title_failed) }}edit-title{{ /if }}">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程封面：</span>
                                    </div>
                                    <div class="front-cover-box">
                                        <div class="front-cover">
                                            <i class="photo"></i>
                                            <span>点击添加课程封面</span>
                                        </div>
                                        {{ include file="common/variable/photo.html" url=$tpl_data.portrait raw_width=300 raw_height=200 width=180 height=120 }}
                                        <img src="{{ $photo }}" class="front-cover-img">
                                        <div class="cover-info">
                                            <i class="point hidden">*</i>
                                            <span class="txt hidden">图片大小不超过5M</span>
                                            <a class="change-front-cover">更改封面</a>
                                        </div>
                                    </div>
                                    {{ if !empty($portrait_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $portrait_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>

                                <li class="video-course-title">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程标题：</span>
                                    </div>
                                    <div class="info form-group">
                                        <textarea class="form-text course-title" type="text" name="course_title" required>{{ $tpl_data.title }}</textarea>
                                        <span class="error"></span>
                                        <span class="form-hint">
                                        还可以输入<strong>20</strong>个字符
                                        </span>
                                        <p>{{ $tpl_data.title }}</p>
                                    </div>
                                    {{ if !empty($title_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $title_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-price">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程价格：</span>
                                    </div>
                                    <div class="info form-group">
                                        <div>
                                            <input class="form-text course-price" type="money" {{ if $tpl_data.price != 0 }}value="{{ $tpl_data.price }}" {{ /if }} name="course_price"  min="0" max="999999" pattern="^[1-9]\d*|0$" required>
                                            <span class="error"></span>
                                            <span class="unit">元</span>
                                            <label for="free-course">
                                                <input type="radio" id="free-course" {{ if $tpl_data.price == 0 }}checked="checked"{{ /if }}>这是免费课
                                            </label>
                                        </div>
                                        <p>{{ if $tpl_data.price != 0 }}<span class="num" data-price="{{ $tpl_data.price }}"><em>￥</em>{{ $tpl_data.price }}</span>{{ if isset($tpl_data.price_ios) && $tpl_data.price_ios != "" }}<em class="num-ios" data-price="10">（苹果设备上售价￥{{ $tpl_data.price_ios }}）</em>{{ /if }}{{ else }}免费课{{ /if }}</p>
                                    </div>
                                    {{ if !empty($price_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $price_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-time">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>观看期限：</span>
                                    </div>
                                    <div class="info form-group">
                                        <input class="form-text course-time" type="int" name="course_time" {{ if $tpl_data.expire_time != 0 }}value="{{ $tpl_data.expire_time }}"{{ /if }}  pattern="^[0-9]*[1-9][0-9]*$"  min="1" max="999999"  required>
                                        <span class="error"></span>
                                        <span class="unit">天</span>
                                        <label for="free-time">
                                            <input type="radio" id="free-time" {{ if $tpl_data.price != 0 && $tpl_data.expire_time == 0 }} checked="checked"{{ /if }}>该视频课永久有效
                                        </label>
                                        <p>{{ if $tpl_data.expire_time != 0 }}<span class="num">{{ $tpl_data.expire_time }}<i>天</i></span>{{ else }}该视频课永久有效{{ /if }}</p>
                                    </div>
                                    {{ if !empty($expire_time_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $expire_time_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-summary">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程简介：</span>
                                    </div>
                                    <div class="info form-group">
                                        <textarea type="text" class="form-text course-summary" name="course_summary" required>{{ $tpl_data.introduce }}</textarea>
                                        <span class="error"></span>
                                        <span class="form-hint">
                                        还可以输入<strong>200</strong>个字符
                                        </span>
                                        <p>{{ $tpl_data.introduce }}</p>
                                    </div>
                                    {{ if !empty($introduce_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $introduce_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-category">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程分类：</span>
                                    </div>
                                    <div class="info">
                                        <div class="dropdown category1">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        <div class="dropdown category2">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        <div class="dropdown category3">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                            </ul>
                                        </div>
                                        {{ $subject_list = explode(',', $tpl_data.subject_id) }}
                                        <p data-cid="{{ $subject_list[0]|cat:','|cat:$subject_list[1]|cat:','|cat:$subject_list[2] }}">{{ $subject_list[3] }}/{{ $subject_list[4] }}/{{ $subject_list[5] }}</p>
                                    </div>
                                    {{ if !empty($subject_id_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $subject_id_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                {{ include file="common/variable/videoLanguage.html" scope=parent }}
                                <li class="video-course-language">
                                    <div class="title">
                                        <i class="point">*</i>
                                        <span>课程语言：</span>
                                    </div>
                                    <div class="info">
                                        <div class="dropdown language">
                                            <span class="btn-default">
                                                <i class="caret"></i>
                                                <span>请选择</span>
                                            </span>
                                            <ul class="dropdown-menu">
                                                <li data-value="1">中文_普通话</li>
                                                <li data-value="2">中文_方言</li>
                                                <li data-value="3">英语</li>
                                                <li data-value="4">日语</li>
                                                <li data-value="5">法语</li>
                                                <li data-value="6">韩语</li>
                                                <li data-value="7">德语</li>
                                                <li data-value="8">西班牙语</li>
                                                <li data-value="9">俄语</li>
                                                <li data-value="10">意大利语</li>
                                                <li data-value="11">葡萄牙语</li>
                                            </ul>
                                        </div>
                                        <p data-lid="{{ $tpl_data.language }}">{{ $video_language[$tpl_data.language] }}</p>
                                    </div>
                                    {{ if !empty($language_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $language_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    <div class="error-tip">
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                                <li class="video-course-tags">
                                    <div class="title">
                                        <i class="point" style="color:transparent;">*</i>
                                        <span>课程标签：</span>
                                    </div>
                                    <div class="info">
                                        <input class="form-text course-tag" type="text">
                                        <span class="form-hint">
                                        每个标签最多<strong>8</strong>个字，用空格分隔（不能包含标点符号，且最多输入<strong>8</strong>个标签哦）
                                        </span>
                                        <ul class="video-tag-list">
                                            {{ if $tpl_data.label_ids }}
                                                {{ $label_list = explode(',', $tpl_data.label_ids) }}
                                                {{ foreach $label_list as $val }}
                                                    <li class="tag-item">{{ $val }}</li>
                                                {{ /foreach }}
                                            {{ /if }}
                                        </ul>
                                    </div>
                                      {{ if !empty($label_ids_failed) }}
                                        {{ $txt = '' }}
                                        {{ foreach $label_ids_failed as $v }}
                                            {{ if $v@first }}
                                                {{ $txt = $v }}
                                            {{ else }}
                                                {{ $txt = $txt|cat:';'|cat:$v }}
                                            {{ /if }}
                                        {{ /foreach }}
                                    <div class="error-tip">
                                        <i class="icon text-error icon-info-circle" data-width="20em"></i>
                                        <span class="text-error"> {{ $txt }}</span>
                                    </div>
                                    {{ else }}
                                        <i class="icon"></i>
                                    {{ /if }}
                                </li>
                            </ul>
                        </div>
                        <div class="action-box">
                            <button class="btn btn-default save-course">
                                保存课程信息
                            </button>
                            <button class="btn btn-default not-save-course">
                                不保存
                            </button>
                        </div>
                    </div>
                {{ /if }}
            </div>

            <div class="section {{ if $video_mode }}no-edit{{ /if }}">
                <h3>
                    第2步：视频上传
                    {{ $video_status = 0 }}
                    {{ if !empty($tpl_data.video_list) }}
                        {{ foreach $tpl_data.video_list as $v }}
                            {{ if $v.video_status == 2 || $v.video_status == 4 }}
                                {{ $video_status = $v.video_status }}
                            {{ /if }}
                        {{ /foreach }}
                    {{ /if }}
                    {{ if $video_status == 0 }}
                        <span>
                            上传中断时，再次选择同一文件可以从中断处续传
                        </span>
                    {{ /if }}
                    {{ if $video_status == 2 }}
                        <span class="wrong-title">
                            经问仔细心检测，以下标记<i class="icon icon-info-circle"></i>的课节未转码成功，请替换
                        </span>
                    {{ /if }}
                    {{ if $video_status == 4 }}
                        <span class="wrong-title">经问仔细心检测，以下标记<i class="icon icon-info-circle"></i>的部分审核不通过，请点击<i class="icon icon-info-circle"></i>查看原因，修改后再发布</span>
                    {{ /if }}
                    <a class="video-upload-edit">编辑</a>
                </h3>
                <div class="box video-upload" data-status="{{ $video_status }}">
                    <ul>
                        {{ if !empty($tpl_data.video_list) }}
                            {{ foreach $tpl_data.video_list as $val }}
                            <li data-sectionid="{{ $val.id }}"  data-videoid="{{ $val.video_id }}"
                                {{ if !empty($val.file_name) }} data-filename="{{ $val.file_name }}" {{ /if }}
                                {{ **视频标题审核有问题,或者内容审核有问题 或者无法播放** }}
                                {{ if !empty($val.verify_msg) }}
                                    {{ if !empty($val.verify_msg.title) }} data-terror="1" {{ /if }}
                                    {{ if !empty($val.verify_msg.content) }} data-cerror="1" {{ /if }}
                                {{ /if }}
                                {{ if $val.video_status == 2 }} data-cerror="1" {{ /if }}

                                {{ **已发布视频课节不能修改,删除,更改,全部隐藏掉** }}
                                {{ if $tpl_data.status == 3 }}
                                    data-publish="1"
                                {{ /if }}
                                data-type="{{ $val.type }}"
                                {{ if $val@index % 2 == 1 }}
                                    class="right-side"
                                {{ /if }}
                            >
                                {{ **课节是否可删除** }}
                                <div class="close" {{ if empty($val.section_can_del) }}style="display:none;"{{ /if }}></div>
                                {{ if $tpl_data.price != 0 }}
                                    {{ if $val.type == 3 }}
                                    <div class="lesson lesson-try">
                                    {{ else }}
                                    <div class="lesson lesson-cost">
                                    {{ /if }}
                                {{ else }}
                                    <div class="lesson">
                                {{ /if }}
                                    <div>
                                        <span class="num">{{ $val@index+1 }}</span><span class="txt">课节</span>
                                    </div>
                                </div>

                                <div class="info">
                                    <div class="section-title">
                                        <span>{{ $val.title }}</span>
                                        {{ if $val.video_status == 4 || $val.video_status == 2 }}
                                            {{ $txt = '' }}
                                            {{ $title_txt = '' }}
                                            {{ $content_txt = '' }}
                                            {{ if !empty($val.verify_msg) }}
                                                {{ if !empty($val.verify_msg.title) }}
                                                    {{ foreach $val.verify_msg.title as $v }}
                                                        {{ if $v@first }}
                                                            {{ $title_txt = $v }}
                                                        {{ else }}
                                                            {{ $title_txt = $title_txt|cat:';'|cat:$v }}
                                                        {{ /if }}
                                                    {{ /foreach }}
                                                {{ /if }}
                                                {{ if !empty($val.verify_msg.content) }}
                                                    {{ foreach $val.verify_msg.content as $v }}
                                                        {{ if $v@first }}
                                                            {{ $content_txt = $v }}
                                                        {{ else }}
                                                            {{ $content_txt = $content_txt|cat:';'|cat:$v }}
                                                        {{ /if }}
                                                    {{ /foreach }}
                                                {{ /if }}
                                                {{ if !empty($title_txt) }}
                                                    {{ $txt = '课节标题：'|cat:$title_txt }}
                                                {{ /if }}
                                                {{ if !empty($content_txt) }}
                                                    {{ if !empty($txt) }}
                                                        {{ $txt = $txt|cat:'  视频内容：'|cat:$content_txt }}
                                                    {{ else }}
                                                        {{ $txt = '视频内容：'|cat:$content_txt }}
                                                    {{ /if }}
                                                {{ /if }}
                                            {{ /if }}
                                            <i class="icon icon-info-circle" {{ if $video_status == 4 && $txt }}data-title="{{ $txt }}" data-width="20em"{{ /if }}></i>
                                        {{ /if }}
                                    </div>
                                    <!--<span class="time">45分钟</span>-->
                                    {{ if $tpl_data.price != 0 }}
                                        {{ if $val.type == 3 }}
                                            <span class="status1">试听课</span>
                                        {{ else }}
                                            <span></span>
                                        {{ /if }}
                                    {{ else }}
                                        <span class="status2">免费课</span>
                                    {{ /if }}
                                    {{ **是否可编辑** }}
                                    <button class="btn btn-default change-title"{{ if empty($val.can_edit) }} style="display:none;"{{ /if }}>更改</button>
                                </div>

                                <div class="video-progress">
                                    <span class="title">
                                        {{ if !empty($val.file_name) }}
                                            {{ $val.file_name|cn_truncate:22 }}
                                        {{ /if }}
                                    </span>
                                    {{ **视频是否可删除** }}
                                    {{ if isset($tpl_data.is_cloud_playback) && $tpl_data.is_cloud_playback }}
                                    {{ else }}
                                    <a class="del"{{ if empty($val.video_can_del) }} style="display:none;"{{ /if }}>删除</a>
                                    {{ /if }}
                                </div>

                                <div class="action">
                                    {{ if $tpl_data.price != 0 }}
                                        {{ if $val.type == 3 }}
                                            <label for="cost-course{{ $val@index+1 }}">
                                                <input name="video-course-radio{{ $val@index+1 }}" type="radio" id="cost-course{{ $val@index+1 }}"
                                                {{ **可编辑状态** }}
                                                {{ if empty($val.can_change) }}
                                                    disabled
                                                {{ /if }}>付费
                                            </label>
                                            <label for="try-listen{{ $val@index+1 }}">
                                                <input name="video-course-radio{{ $val@index+1 }}" type="radio" id="try-listen{{ $val@index+1 }}" checked="checked"
                                                {{ **可编辑状态** }}
                                                {{ if empty($val.can_change) }}
                                                    disabled
                                                {{ /if }}>试听
                                            </label>
                                            <span class="free" style="display:none;">免费</span>
                                        {{ else }}
                                            <label for="cost-course{{ $val@index+1 }}">
                                                <input name="video-course-radio{{ $val@index+1 }}" type="radio" id="cost-course{{ $val@index+1 }}" checked="checked"
                                                {{ **可编辑状态** }}
                                                {{ if empty($val.can_change) }}
                                                    disabled
                                                {{ /if }}>付费
                                            </label>
                                            <label for="try-listen{{ $val@index+1 }}">
                                                <input name="video-course-radio{{ $val@index+1 }}" type="radio" id="try-listen{{ $val@index+1 }}"
                                                {{ **可编辑状态** }}
                                                {{ if empty($val.can_change) }}
                                                    disabled
                                                {{ /if }}>试听
                                            </label>
                                            <span class="free" style="display:none;">免费</span>
                                        {{ /if }}
                                    {{ else }}
                                        <label for="cost-course{{ $val@index+1 }}" style="display:none;">
                                            <input name="video-course-radio{{ $val@index+1 }}" type="radio" id="cost-course{{ $val@index+1 }}" checked="checked">付费
                                        </label>
                                        <label for="try-listen{{ $val@index+1 }}" style="display:none;">
                                            <input name="video-course-radio{{ $val@index+1 }}" type="radio" id="try-listen{{ $val@index+1 }}">试听
                                        </label>
                                        <span class="free">免费</span>
                                    {{ /if }}
                                </div>
                            </li>
                            {{ /foreach }}
                        {{ /if }}

                        {{ if isset($tpl_data.is_cloud_playback) && $tpl_data.is_cloud_playback }}
                            <li class="add-section {{ if !empty($tpl_data.video_list) && count($tpl_data.video_list) % 2 == 1 }}
                                        right-side
                                    {{ /if }}">
                                <div class="book"></div>
                                <span class="add-lesson">
                                    <i class="icon icon-plus"></i>
                                    添加新课节
                                </span>
                                <span class="hint text-error">
                                    直播回放创建的视频课，请到直播回放处添加新课节
                                </span>
                            </li>
                        {{ else }}
                            <li class="add-lesson-video add-section {{ if !empty($tpl_data.video_list) && count($tpl_data.video_list) % 2 == 1 }}
                                        right-side
                                    {{ /if }}">
                                <div class="book"></div>
                                <span class="add-lesson">
                                    <i class="icon icon-plus"></i>
                                    添加新课节
                                </span>
                            </li>
                        {{ /if }}
                    </ul>
                    <div class="action-box">
                        <button class="btn btn-default save-lesson">
                            保存课节
                        </button>
                    </div>
                </div>
            </div>

            <div class="section {{ if $video_mode }}no-edit{{ /if }}">
                <h3>
                    第3步：课程详情
                    <a class="video-content-edit">编辑</a>
                </h3>
                <div class="content-tips">请不要在内容中留电话、QQ、和网址哦，仅支持5M以内的jpg、png、jpeg格式图片，最大宽度不要超过760像素</div>
                {{ if !empty($brief_failed) }}
                    {{ $txt = '' }}
                    {{ foreach $brief_failed as $v }}
                        {{ if $v@first }}
                            {{ $txt = $v }}
                        {{ else }}
                            {{ $txt = $txt|cat:';'|cat:$v }}
                        {{ /if }}
                    {{ /foreach }}
                    <div class="wrong-reason">课程详情审核不通过，理由如下：{{ $txt }}</div>
                {{ /if }}
                <div class="box video-content">
                    {{ if $video_mode }}
                        <textarea class="editor" style="display:none;">{{ $tpl_data.brief }}</textarea>
                        <div class="content">{{ $tpl_data.brief }}</div>
                    {{ else }}
                        <textarea class="editor"></textarea>
                        <div class="content"></div>
                    {{ /if }}

                    <div class="action-box">
                        <button class="btn btn-default save-detail">
                            保存详情
                        </button>
                        <button class="btn btn-default not-save-detail">
                            不保存
                        </button>
                    </div>
                </div>
                {{ include file="common/component/ueditor.html" }}
            </div>

            <div class="video-action-box">
                <button class="btn btn-default publish-course">
                    立即发布课程
                </button>
                <button class="btn btn-default pre-publish-course">
                    保存至待发布列表
                </button>
            </div>
        </div>
    </div>

{{ /strip }}
{{ /block }}

