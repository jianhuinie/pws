{{ *

@file 老师个人中心 - 图片列表，翻页
@author wangyujie

* }}

{{ strip }}

<ul class="photo-list">

    {{ foreach $tpl_data.photo_list_tpl.object_list as $key=>$item }}

    <li data-photo='{{ json_encode($item, 77) }}'
    {{ if isset($key) }}
        {{ if $key == 4 || $key == 8 }} class="clearfix" {{ /if }}
    {{ /if }}
    >

        {{ include file="common/variable/photo.html" url=$item.url raw_width=$item.width raw_height=$item.height width=180 height=134 }}

        {{ include file="common/component/imageThumbnail.html" url=$item.url title=$item.title crop_url=$photo editable=true }}

        {{ if isset($item.verify_status) && $item.verify_status == 2 }}
            <div class="message message-error">
                <i class="icon icon-info-circle"></i>
                {{ foreach $item.reasons as $reason }}
                    {{ $reason }}；
                {{ /foreach }}
            </div>
        {{ /if }}

    </li>

    {{ /foreach }}

</ul>

{{ $page=$tpl_data.photo_list_tpl.pager.page }}
{{ $count = $tpl_data.photo_list_tpl.pager.total }}
{{ $page_size = $tpl_data.photo_list_tpl.pager.page_size }}
{{ $page_count = ($count / $page_size)|ceil }}
{{ $show_count = 4 }}

{{ if $page_count > 1 }}
<div class="pager-block">

    <div class="pager">

        {{ if $page > 1 }}
        <a data-page="{{ $page-1 }}" >
            <i class="icon icon-chevron-left"></i> 上一页
        </a>
        {{ /if }}

        {{ if $page_count <= $show_count + 1 }}
            {{ $start = 1 }}
            {{ $end = $page_count }}
        {{ elseif $page_count <= $page + $show_count  }}
            {{ $end = $page_count }}
            {{ $start = $page_count - $show_count }}
        {{ elseif $page <= ($show_count/2) }}
            {{ $start = 1 }}
            {{ $end = 1 + $show_count }}
        {{ else }}
            {{ $start = $page - $show_count/2  }}
            {{ $end = $page + $show_count/2 }}
        {{ /if }}

        {{ if $start > 2 }}
        <a data-page="1">1</a>
        <b class="ellipsis">...</b>
        {{ /if }}


        {{ for $item=$start to $end }}

        {{ $replace_to = "page="|cat:$item }}

        {{ if $item != $page }}
        <a data-page="{{ $item }}">{{ $item }}</a>
        {{ else }}
        <a class="active">{{ $item }}</a>
        {{ /if }}
        {{ /for }}

        {{ if $end < $page_count }}
        <b class="ellipsis">...</b>
        <a data-page="{{ $page_count }}">{{ $page_count }}</a>
        {{ /if }}

        {{ if $page < $page_count }}
        <a data-page="{{ $page+1 }}">
            下一页 <i class="icon icon-chevron-right"></i>
        </a>
        {{ /if }}

    </div>
</div>
{{ /if }}




{{ /strip }}