{{ *

@file 视频课详情页 - 课程信息
@author jixiaohui

* }}

{{ strip }}

<div id="video-profile" class="card">

    <div class="imgshow">
        {{ include file="common/variable/photo.html" url=$tpl_data.portrait raw_width=350 raw_height=200 width=350 height=200 }}
        <img src="{{ $photo }}">
    </div>

    <div class="baseinfo">

        <div class="action">

            {{ $share_text = "#跟谁学# 分享一门精致视频课程给你哦~"|cat:$tpl_data.name }}
            {{ $share_text = $share_text|cat: "，还在等什么？找好老师，上跟谁学，快来开启寻师之旅吧！" }}

            {{ $share_data = [] }}
            {{ $share_data.url = $root_http|cat: '/video_course/getcourseshowdetail?number='|cat: $tpl_data.number }}
            {{ $share_data.title = $share_text }}
            {{ $share_data.content = ' ' }}
            {{ $share_data.img = $tpl_data.portrait }}

            {{ $is_self_share = isset($tpl_data.self_share_info) && $tpl_data.self_share_info }}

            {{ if $is_self_share }}
            <span class="social-share">
                <span class="share-wrapper" data-share='{{ json_encode($share_data, 77) }}' data-query='{"sf": 1}'>
                    <i class="icon icon-share"></i>
                    分享
                </span>
                <small>
                    {{ $tpl_data.self_share_info }}
                </small>
            </span>
            {{ /if }}

            <ul>
                <li id="favor" data-coursenum="{{ $tpl_data.number }}" data-haslogin="{{ isset($user_data.user_name) }}">
                    <i class="icon icon-favor"></i>
                    <span>收藏</span>
                </li>
                <li class="popularity">
                    （<span>0</span>人气）
                </li>
                {{ if !$is_self_share }}
                <li class="social-share">
                    <span class="share-wrapper" data-share='{{ json_encode($share_data, 77) }}'>
                        <i class="icon icon-share"></i>
                        分享
                    </span>
                </li>
                {{ /if }}
                <li class="correct">
                    <i class="icon icon-warning"></i>
                    纠错
                </li>
            </ul>
        </div>

        <ul class="info">
            <li class="video-title">
                {{ $title = $tpl_data.name|cn_truncate:20 }}
                <span class="txt" {{ if $title != $tpl_data.name }}data-title="{{ $tpl_data.name }}" data-width="20em"{{ /if }}>
                    {{ $title }}
                </span>
                <i class="video-tag"></i>
                <span class="num">视频课编号：{{ $tpl_data.number }}</span>
            </li>

            <li class="teacher">
                老师：
                <a href="{{ $tpl_data.teacher_url }}" target="_blank">{{ $tpl_data.teacher_name }}</a>
            </li>

            <li class="section">
                课节数：
                <span>
                    {{ $tpl_data.course_items_count }}
                </span>
            </li>

            <li>
                {{ $subject_list = explode(',', $tpl_data.subject_id) }}
                <div class="category">
                    类别：
                    <span>{{ $subject_list[3] }}/{{ $subject_list[4] }}/{{ $subject_list[5] }}</span>
                </div>
                {{ include file="common/variable/videoLanguage.html" scope=parent }}
                <div class="language">
                    语言：
                    <span>{{ $video_language[$tpl_data.language] }}</span>
                </div>
            </li>

            <li class="learning">
                {{ if $tpl_data.price == 0 }}
                    {{ $tpl_data.payers_count }}人在学
                {{ else }}
                    {{ $tpl_data.payers_count }}人购买
                {{ /if }}
            </li>
            {{ if $tpl_data.is_staging == 1 }}
                <li class="can-stage">
                    <span class="stage-desc">{{ $tpl_data.staging.desc }}</span>
                    <span class="stage-pay">分期付款></span>
                </li>
            {{ /if }}

            {{ $show_zhekou_tips = false }}
            {{ if !empty($tpl_data.discount) && $tpl_data.discount }}

                {{ if $tpl_data.discount.type == 1 }}
                {{ * 限额折扣 活动中提醒 * }}
                    {{ $show_zhekou_tips = true }}
                    {{ $remain_amount = $tpl_data.discount.remain_amount }}
                    {{ $class = "price-tip-end" }}
                    {{ $price = $tpl_data.discount.discount_price }}
                    {{ $price_no = $tpl_data.discount.pre_price }}
                {{ else if $tpl_data.discount.type == 2 }}
                    {{ $cur_time = $smarty.now }}
                    {{ $start_time = strtotime($tpl_data.discount.start_time) }}
                    {{ $end_time = strtotime($tpl_data.discount.end_time) }}

                    {{ if ($start_time - $cur_time) < (24*60*60) && ($start_time - $cur_time > 0) }}
                        {{ * 活动开始前24小时提醒 * }}
                        {{ $show_zhekou_tips = true }}
                        {{ $zhekou_descript = "限时折扣｜距抢购开始 " }}
                        {{ $class = "price-tip-begin" }}
                        {{ $time = ($start_time - $cur_time) }}
                        {{ $price = $tpl_data.discount.pre_price }}
                        {{ $price_no = $tpl_data.discount.discount_price }}
                    {{ else if ($start_time < $cur_time) && ($cur_time < $end_time) }}
                        {{ * 活动进行中的提醒 * }}
                        {{ $show_zhekou_tips = true }}
                        {{ $zhekou_descript = "限时折扣｜距抢购结束 " }}
                        {{ $class = "price-tip-end" }}
                        {{ $time = ($end_time - $cur_time) }}
                        {{ $price = $tpl_data.discount.discount_price }}
                        {{ $price_no = $tpl_data.discount.pre_price }}
                    {{ /if }}
                {{ /if }}
            {{ /if }}

            <li class="button-box">
                {{ if $tpl_data.price == 0 || $tpl_data.can_study }}
                    <button class="btn btn-default start">
                        开始学习
                    </button>
                    {{ if $tpl_data.price == 0 }}
                        <button class="btn btn-default join">
                            加入我的视频课
                        </button>
                    {{ /if }}

                    <!--button class="btn btn-primary reserve-listen">
                        预约咨询
                    </button-->
                {{ else }}
                    <button class="btn btn-default buy">
                        {{ if $show_zhekou_tips }}
                            <span class="price-now">{{ $price }}</span>元
                            <span class="price-pre">{{ $price_no }}元</span>
                        {{ else }}
                            <span class="price-now">{{ $tpl_data.price }}</span>元
                        {{ /if }}
                         &nbsp;|&nbsp;购买课程
                    </button>

                    {{ if $counter > 0  }}
                        <button class="btn btn-default audition">
                            <i class="icon icon-camera"></i>试听
                        </button>
                    {{ /if }}

                    <!--button class="btn btn-primary reserve-listen">
                        预约咨询
                    </button-->
                    {{ if $show_zhekou_tips && $tpl_data.discount.type == 1 }}
                        <div class="zhekou-info {{ $class }}">
                            限额折扣｜剩余{{ $remain_amount }}个优惠名额
                        </div>
                    {{ else if $show_zhekou_tips && !empty($time) && $tpl_data.discount.type == 2 }}
                        <div class="zhekou-info {{ $class }}">
                            {{ $zhekou_descript }}
                            <span class="limit-discount {{ $class }}" data-cur="{{ $cur_time }}" data-start="{{ $start_time }}" data-end="{{ $end_time }}">
                                <span class="time">
                                    {{ include file='common/component/countDown.html' time=$time }}
                                </span>
                            </span>
                        </div>
                    {{ /if }}
                {{ /if }}
                {{ if isset($tpl_data.cashback) && $tpl_data.cashback != 0 }}
                    <span class="cps-scholarship">
                        返奖学金：
                        <strong>￥</strong>
                        {{ $tpl_data.cashback }}
                    </span>
                {{ /if }}
            </li>

            {{ if $tpl_data.price }}
                <li>
                    服务：
                    <span>
                        <i class="watch"></i>
                        {{ if $tpl_data.expire_time }}
                            {{ $tpl_data.expire_time }}天随时看
                        {{ else }}
                            随时看
                        {{ /if }}
                    </span>
                </li>
            {{ /if }}
        </ul>
    </div>

</div>
{{ /strip }}